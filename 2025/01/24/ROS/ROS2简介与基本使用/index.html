<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>ROS2简介与基本使用 | 易锦风的博客</title><meta name="author" content="formeasy"><meta name="copyright" content="formeasy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ROS2简介与基本使用"><meta property="og:type" content="article"><meta property="og:title" content="ROS2简介与基本使用"><meta property="og:url" content="http://www.formeasy.cc/2025/01/24/ROS/ROS2%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/index.html"><meta property="og:site_name" content="易锦风的博客"><meta property="og:description" content="ROS2简介与基本使用"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.formeasy.cc/2025/01/24/ROS/ROS2%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/3ca4d9399b3e53e675dbfd863d98611c.png"><meta property="article:published_time" content="2025-01-24T02:57:48.000Z"><meta property="article:modified_time" content="2025-04-25T01:27:40.075Z"><meta property="article:author" content="formeasy"><meta property="article:tag" content="ROS"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://www.formeasy.cc/2025/01/24/ROS/ROS2%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/3ca4d9399b3e53e675dbfd863d98611c.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.formeasy.cc/2025/01/24/ROS/ROS2%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{var e={set:(e,t,a)=>{a&&(a=Date.now()+864e5*a,localStorage.setItem(e,JSON.stringify({value:t,expiry:a})))},get:e=>{var t=localStorage.getItem(e);if(t){var{value:t,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return t;localStorage.removeItem(e)}}},t=(window.btf={saveToLocal:e,getScript:(o,n={})=>new Promise((e,t)=>{const a=document.createElement("script");a.src=o,a.async=!0,Object.entries(n).forEach(([e,t])=>a.setAttribute(e,t)),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),getCSS:(o,n)=>new Promise((e,t)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),addGlobalFn:(e,t,a=!1,o=window)=>{var n;e.startsWith("pjax")||((n=o.globalFn||{})[e]=n[e]||{},n[e][a||Object.keys(n[e]).length]=t,o.globalFn=n)}},()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")}),a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")},o=(btf.activateDarkMode=t,btf.activateLightMode=a,e.get("theme")),t=("dark"===o?t():"light"===o&&a(),e.get("aside-status"));void 0!==t&&document.documentElement.classList.toggle("hide-aside","hide"===t);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"未找到符合您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1,highlightFullpage:!1,highlightMacStyle:!0},copy:{success:"复制成功",error:"复制失败",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"ROS2简介与基本使用",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="易锦风的博客" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">199</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/2025/01/24/ROS/ROS2简介与基本使用/3ca4d9399b3e53e675dbfd863d98611c.png)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon.png" alt="Logo"><span class="site-name">易锦风的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">ROS2简介与基本使用</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ROS2简介与基本使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-01-24T02:57:48.000Z" title="发表于 2025-01-24 10:57:48">2025-01-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-25T01:27:40.075Z" title="更新于 2025-04-25 09:27:40">2025-04-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="1-ros2-介绍与安装"><a class="markdownIt-Anchor" href="#1-ros2-介绍与安装"></a> 1. ROS2 介绍与安装</h2><h3 id="11-ros2-的历史"><a class="markdownIt-Anchor" href="#11-ros2-的历史"></a> 1.1 ROS2 的历史</h3><ul><li>ROS（Robot Operating System，机器人操作系统），但 ROS 本身并不是一个操作系统，而是可以安装在现在已有的操作系统上（Linux、Windows、Mac）的软件库和工具集</li><li>ROS 出生于 2007 年，ROS 的出现解决了机器人各个组件之间的通信问题，同时基于 ROS 完善的通信机制，越来越多的优秀的机器人算法集成到了 ROS 中来</li><li>现在的 ROS 功能已经变得非常的丰富和强大。但随着对 ROS 功能上要求越来越多，<strong>一些原始的架构和设计不能够满足目前的使用需求，这也是 ROS2 出现的原因</strong></li></ul><h4 id="111-ros-的作用"><a class="markdownIt-Anchor" href="#111-ros-的作用"></a> 1.1.1 ROS 的作用</h4><ul><li>做一个机器人需要涉及到多个部分，而且这些部分之间还要进行通信，如果想要整个机器人可以跑起来，那么必须要有一个东西将下面的几个部分合理的连接到一起，这个东西就是 ROS<ul><li>感知部分：激光雷达、深度相机、IMU、里程计、碰撞感知、建图</li><li>决策部分：路径规划（navigation）算法、定位算法</li><li>控制部分：轮子驱动</li></ul></li></ul><h4 id="112-为什么需要-ros2"><a class="markdownIt-Anchor" href="#112-为什么需要-ros2"></a> 1.1.2 为什么需要 ROS2</h4><ul><li>2007 年 ROS 开发人员设计和制作 ROS 时，当时只想着简化机器人的开发，并没有想到过今天那么多的功能需求，比如<strong>商业化要求的稳定性、生命周期管理、多机协同、数据加密</strong>等</li><li>ROS 发展的后几年里，机器人对 ROS 的功能要求越来越多，ROS 开发人员只能在原有的 ROS 上修修补补。随着 ROS 不断的添加新功能，<strong>ROS 变得越来越臃肿</strong>，祖传代码也越来越多。ROS 开发人员发现在原有的 ROS 架构上修修补补十分消耗头发，于是 ROS 官方重新设计制作了 ROS2</li></ul><h4 id="113-ros2-版本对照表"><a class="markdownIt-Anchor" href="#113-ros2-版本对照表"></a> 1.1.3 ROS2 版本对照表</h4><ul><li>ROS2 是在 ROS 的基础上设计开发的第二代机器人操作系统，可简化机器人开发任务，加速机器人落地的软件库和工具集<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="3ca4d9399b3e53e675dbfd863d98611c.png" alt="在这里插入图片描述"></li></ul><h3 id="12-ros-和-ros2-对比"><a class="markdownIt-Anchor" href="#12-ros-和-ros2-对比"></a> 1.2 ROS 和 ROS2 对比</h3><h4 id="121-ros-存在的问题"><a class="markdownIt-Anchor" href="#121-ros-存在的问题"></a> 1.2.1 ROS 存在的问题</h4><ul><li>ROS 的设计目标是简化机器人的开发，ROS 为此设计了一整套通信机制（话题、服务、参数、动作）<ul><li>通过这些通信机制，ROS 实现了将机器人的各个组件给的连接起来，在设计这套通信机制的时候就设计了一个叫做 ROS Master 的东西，所有节点（可以理解为某一个组件，比如：激光雷达）的通信建立必须经过这个主节点</li><li><strong>一旦 ROS Master 主节点挂掉后，就会造成整个系统通信的异常</strong>，ROS 的不稳定这个问题，如果是想基于 ROS 做商业化机器人（比如无人驾驶汽车），就会造成非常严重的后果</li><li><strong>ROS 还存在以下问题</strong>：1、通信基于 TCP 实现，实时性差、系统开销大；2、对 Python3 支持不友好，需要重新编译；3、消息机制不兼容；4、没有加密机制、安全性不高<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="018c84e7bcde71ed77d1a2311b2c64b8.png" alt="在这里插入图片描述"></li></ul></li></ul><blockquote><p><strong>网络传输可靠性对比</strong></p><ul><li>ROS1 是基于 TCP/IP 构建的，TCP/IP 很难在无线通信中传输数据，因为中断可能会导致回退、重传和延迟<br>ROS2 中的 DDS 使用 UDP 传送数据，不会尝试重新传输数据，相反，DDS 决定在不可靠的条件下何时以及如何重新传输，DDS 引入了服务质量 (QoS) 来公开这些设置，以优化可用带宽和延迟</li></ul></blockquote><h4 id="122-ros-与-ros2-架构对比"><a class="markdownIt-Anchor" href="#122-ros-与-ros2-架构对比"></a> 1.2.2 ROS 与 ROS2 架构对比</h4><ul><li><strong>OS 层</strong><ul><li>ROS：只支持 linux 平台</li><li>ROS2：支持 windows、mac 甚至是嵌入式 RTOS 平台</li></ul></li><li><strong>中间件层</strong>（中间件就是介于某两个或者多个节点中间的组件，提供多个节点间通信用的）<ul><li><strong>去中心化 master</strong>：ROS 和 ROS2 中间件不同之处在于，ROS2 取消了 master 节点，去中心化后，各个节点之间可以通过 DDS 的节点相互发现，各个节点都是平等的，且可以 1 对 1、1 对 n、n 对 n 进行互相通信</li><li><strong>不造通信的轮子</strong>：通信直接更换为 DDS 进行实现，采用 DDS 通信，使得 ROS2 的实时性、可靠性和连续性上都有了增强</li></ul></li><li><strong>应用层</strong><ul><li>Python2 到 Python3 的支持</li><li>编译系统的改进（catkin 到 ament）</li><li>C++ 标准更新到 C++11</li><li>可以使用相同 API 的进程间和进程内通信<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="b92654ca47eb9b4ce91a4abe61ef3617.png" alt="在这里插入图片描述"></li></ul></li></ul><blockquote><p><strong>什么是 DDS？</strong></p><ul><li>DDS（Data Distribution Service，数据分发服务），是 OMG（Object Management Group，对象管理组织）发布的<strong>分布式通信规范/协议</strong>，采用订阅发布模型，<strong>以中间件的形式提供通信服务</strong>，并提供 QoS（Quality of Service）策略，保障数据实时、高效、灵活的分发</li><li>DDS 协议大致流程是多对多的单向数据交互，<strong>通信模型为分布式结构，没有中心节点</strong>，同一个数据空间任何两个节点之间都能直接通信，DDS 采用<strong>以数据为中心的发布-订阅模型</strong> DCPS（Data-Centric Publish-Subscribe）</li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/tomato-haha/p/17696510.html">分布式实时通信-DDS 概述</a><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="d1004d707e588b1d3228d2e81da2d3a2.png" alt="在这里插入图片描述"></li></ul></blockquote><h3 id="13-安装-ros2"><a class="markdownIt-Anchor" href="#13-安装-ros2"></a> 1.3 安装 ROS2</h3><ul><li><p><strong>一键安装 ROS2</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wget</span> http://fishros.com/install <span class="literal">-O</span> fishros &amp;&amp; . fishros</span><br></pre></td></tr></table></figure></li><li><p><strong>卸载</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt remove ros<span class="literal">-galactic-</span>*</span><br><span class="line">sudo apt autoremove</span><br></pre></td></tr></table></figure></li><li><p><strong>安装位置查询</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/ros/galactic(根据安装版本替换)/</span><br><span class="line"><span class="built_in">ls</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="14-ros2-初体验"><a class="markdownIt-Anchor" href="#14-ros2-初体验"></a> 1.4 ROS2 初体验</h3><ul><li><p><strong>启动乌龟模拟器节点</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 run turtlesim turtlesim_node</span><br></pre></td></tr></table></figure></li><li><p><strong>启动乌龟遥控器节点</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 run turtlesim turtle_teleop_key</span><br></pre></td></tr></table></figure></li></ul><h3 id="15-ros2-系统架构"><a class="markdownIt-Anchor" href="#15-ros2-系统架构"></a> 1.5 ROS2 系统架构</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="0b2e79245f30c44a666dcbb01c285bbe.png" alt="在这里插入图片描述"></p><h4 id="151-操作系统层"><a class="markdownIt-Anchor" href="#151-操作系统层"></a> 1.5.1 操作系统层</h4><ul><li>ROS2 本身就是基于 Linux、Windows 或者 macOS 系统建立的，驱动计算机硬件、底层网络通信等实现都是交由操作系统来实现的</li></ul><h4 id="152-dds实现层"><a class="markdownIt-Anchor" href="#152-dds实现层"></a> 1.5.2 DDS实现层</h4><ul><li>DDS实 现层其实就是对不同常见的 DDS 接口进行再次的封装，让其保持统一性，为 DDS 抽象层提供统一的 API</li></ul><h4 id="153-抽象-dds-层rmw"><a class="markdownIt-Anchor" href="#153-抽象-dds-层rmw"></a> 1.5.3 抽象 DDS 层（RMW）</h4><ul><li>这一层将 DDS 实现层进一步的封装，使得 DDS 更容易使用：原因在于 DDS 需要大量的设置和配置（分区，主题名称，发现模式，消息创建,…），这些设置都是在 ROS2 的抽象层中完成的</li></ul><h4 id="154-ros2-客户端库rcl"><a class="markdownIt-Anchor" href="#154-ros2-客户端库rcl"></a> 1.5.4 ROS2 客户端库（RCL）</h4><ul><li>RCL（ROS Client Library，ROS 客户端库），其实就是 ROS 的一种 API，提供了对 ROS 话题、服务、参数、Action 等接口，不同语言对应不同 RCL，但基本功能都是相同的<ul><li>Python 语言提供了 rclpy 来操作 ROS2 的节点话题服务等</li><li>C++ 则使用 rclcpp 提供 API 操作 ROS2 的节点话题和服务等<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="ef066483bf4bbe4bb4360fe545c61a79.png" alt="在这里插入图片描述"></li></ul></li></ul><blockquote><p><strong>GUI 和 CLI</strong></p><ul><li>GUI（Graphical User Interface，图形用户界面），Windows 是就是可视化的，通过鼠标点击按钮等图形化交互完成任务</li><li>CLI（Command-Line Interface，命令行界面），终端（黑框框）就是命令行界面</li></ul></blockquote><blockquote><p><strong>什么是 API？</strong></p><ul><li>API（ Application Programming Interface，应用程序编程接口），<strong>比如你写了一个库，里面有很多函数</strong>，如果别人要使用这个库，但并不知道每个函数内部是怎么实现的。使用的人<strong>需要看你的文档或者注释</strong>才知道这个函数的入口参数和返回值或者这个函数是用来做什么的。<strong>对于使用者来说来说，你的这些函数就是 API</strong></li><li>API 在不同语言中的表现形式不同，在 C/C++ 表现为头文件，在 Python 中表现为 Python 文件</li></ul></blockquote><h4 id="155-应用层"><a class="markdownIt-Anchor" href="#155-应用层"></a> 1.5.5 应用层</h4><ul><li>应用层就是写代码以及 ROS2 开发的各种常用的机器人相关开发工具所在的层</li></ul><h3 id="16-中间件-dds-架构"><a class="markdownIt-Anchor" href="#16-中间件-dds-架构"></a> 1.6 中间件 DDS 架构</h3><h4 id="161-什么是中间件"><a class="markdownIt-Anchor" href="#161-什么是中间件"></a> 1.6.1 什么是中间件</h4><ul><li><strong>中间件就是介于某两个或者多个节点中间的组件，就是提供多个节点中间通信用的</strong><ul><li>中间件是一种独立的系统软件或服务程序，分布式应用软件借助这种软件在不同的技术之间共享资源</li><li>中间件位于客户机/服务器的操作系统之上，管理计算机资源和网络通讯，是连接两个独立应用程序或独立系统的软件</li></ul></li><li>ROS1 的中间件是 ROS 组织自己基于 TCP/UDP 机制建立的</li><li>ROS2 采用了第三方的 DDS 作为中间件，将DDS服务接口进行了一层抽象，保证了上层应用层调用接口的统一性。基于 DDS 的互相发现协议，ROS2 终于干掉了 ROS1 中的 Master 节点</li></ul><h4 id="162-dds-和-ros2-架构"><a class="markdownIt-Anchor" href="#162-dds-和-ros2-架构"></a> 1.6.2 DDS 和 ROS2 架构</h4><ul><li>ROS2 为每家 DDS 供应商都开发了对应的 DDS_Interface 即 DDS 接口层，然后通过 DDS Abstract 抽象层来统一 DDS 的 API<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="47fc2b857fd45ae85f4d08e094a0a438.png" alt="在这里插入图片描述"></li></ul><h4 id="163-dds-通信模型"><a class="markdownIt-Anchor" href="#163-dds-通信模型"></a> 1.6.3 DDS 通信模型</h4><ul><li><p>DDS 通信模型：可以定义话题的数据结构（类似于 ROS2 中的接口类型）</p><ul><li>Pos：一个编号 id 的车的位置 x,y</li><li>DDS 的参与者（Participant）通过发布和订阅主题数据进行通信<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="c3dca278065385ecb683d39fc7edb3cd.png" alt="在这里插入图片描述"></li></ul></li><li><p>DDS 的应用层通过 DDS 进行数据订阅发布，DDS 通过传输层进行数据的收发<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="757b83c23b44886d96463dae6516131c.png" alt="在这里插入图片描述"></p></li></ul><h4 id="164-dds-优缺点"><a class="markdownIt-Anchor" href="#164-dds-优缺点"></a> 1.6.4 DDS 优缺点</h4><ul><li><strong>优势</strong><ul><li><strong>发布/订阅模型</strong><ul><li>简单解耦，可以轻松实现系统解耦</li></ul></li><li><strong>性能</strong><ul><li>在发布/订阅模式中，与请求/回复模式相比，延迟更低，吞吐量更高</li></ul></li><li><strong>远程参与者的自动发现</strong><ul><li>此机制是 DDS 的主要功能之一。通信是匿名的、解耦的，开发者不必担心远程参与者的本地化</li></ul></li><li><strong>丰富的 Qos 参数集</strong><ul><li>允许调整通信的各个方面：可靠性、持久性、冗余、寿命、传输设置、资源</li></ul></li><li><strong>实时发布/订阅协议 (RTPS)</strong><ul><li>该协议几乎可以通过任何传输实现，允许在 UDP、TCP、共享内存和用户传输中使用 DDS，并实现不同 DDS 实现之间的真正互操作性</li></ul></li></ul></li><li><strong>劣势</strong><ul><li>API 复杂，DDS 的灵活性是以复杂性为代价的</li><li>系统开销相对较大</li><li>社区支持问题，ROS2 近两年来使用 DDS 后社区表现还是不错的</li></ul></li></ul><blockquote><p><strong>使用 DDS 的理由</strong></p><ul><li>DDS 已经应用在军事、潜艇各个领域，稳定性、实时性经过实际检验</li><li>使用 DDS 需要维护的代码要少得多，可以让 ROS2 开发人员腾出手专注机器人开发</li><li>DDS 有定义好的行为和规范并且有完善的文档</li><li>DDS 提供了推荐的用例和软件 API，有较好的语言支持</li></ul></blockquote><h2 id="2-ros2-第一个节点"><a class="markdownIt-Anchor" href="#2-ros2-第一个节点"></a> 2. ROS2 第一个节点</h2><h3 id="21-使用-cmakelisttxt-编译-ros2-的节点"><a class="markdownIt-Anchor" href="#21-使用-cmakelisttxt-编译-ros2-的节点"></a> 2.1 使用 CMakeList.txt 编译 ROS2 的节点</h3><h4 id="211-动态链接库"><a class="markdownIt-Anchor" href="#211-动态链接库"></a> 2.1.1 动态链接库</h4><ul><li>程序编译一般需要经<strong>预处理、编译、汇编和链接</strong>几个步骤<ul><li>在实际应用中，有些公共代码需要反复使用，就把这些代码编译成为“库”文件</li><li><strong>静态库</strong>：在链接步骤中，链接器将从库文件取得所需的代码，复制到生成的可执行文件中，这种库称为静态（链接）库，其特点是可执行文件中包含了库代码的一份完整拷贝，缺点是被多次使用就会多份冗余拷贝</li><li><strong>动态库</strong>：还有一种库，就是程序在开始运行后调用库函数时才被载入，这种库独立于现有的程序，其本身不可执行，但包含着程序需要调用的一些函数，这种库称为动态（链接）库（Dynamic Link Library）</li><li>在 widows 平台下，静态链接库是 .lib 文件，动态库文件是 .dll 文件。在 linux 平台下，静态链接库是 .a 文件，动态链接库是 .so 文件<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="f70d37186e6315ec4eb031cfea8e72ef.png" alt="在这里插入图片描述"></li></ul></li></ul><h4 id="212-编译-ros2-的-c-节点"><a class="markdownIt-Anchor" href="#212-编译-ros2-的-c-节点"></a> 2.1.2 编译 ROS2 的 C++ 节点</h4><ul><li><p><strong>创建工作空间并编写节点</strong></p><ul><li>打开终端，创建 d2lros2/chapt2/basic 工作空间目录并用 VSCode 打开</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="literal">-p</span> d2lros2/chapt2/basic</span><br><span class="line">code d2lros2</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 basic 目录下创建 first_ros2_node.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 调用 rclcpp 的初始化函数</span></span><br><span class="line">    rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello World!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用 rclcpp 的循环运行创建的 first_node 节点</span></span><br><span class="line">    rclcpp::<span class="built_in">spin</span>(std::<span class="built_in">make_shared</span>&lt;rclcpp::Node&gt;(<span class="string">&quot;first_node&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 basic 目录下创建 CMakeList.txt</span></span><br><span class="line">cmake_minimum_required(VERSION 3.16)</span><br><span class="line">project(first_node)</span><br><span class="line"></span><br><span class="line">find_package(rclcpp REQUIRED)</span><br><span class="line">add_executable(first_node first_ros2_node.cpp)</span><br><span class="line">target_link_libraries(first_node rclcpp::rclcpp)</span><br></pre></td></tr></table></figure></li><li><p><strong>编译与运行</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/d2lros2/chapt2/basic</span><br><span class="line">mkdir build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line">./first_node</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello World!</span><br></pre></td></tr></table></figure></li></ul><h3 id="22-cmake-依赖查找流程"><a class="markdownIt-Anchor" href="#22-cmake-依赖查找流程"></a> 2.2 CMake 依赖查找流程</h3><ul><li><p>find_package 查找路径对应的环境变量如下</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;package&gt;_DIR</span><br><span class="line">CMAKE_PREFIX_PATH</span><br><span class="line">CMAKE_FRAMEWORK_PATH</span><br><span class="line">CMAKE_APPBUNDLE_PATH</span><br><span class="line">PATH</span><br></pre></td></tr></table></figure></li><li><p>打开终端，输入指令 echo $PATH</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">/opt/ros/galactic/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br></pre></td></tr></table></figure></li><li><p>PATH 中的路径如果以 bin 或 sbin 结尾，则自动回退到上一级目录，接着检查这些目录下的</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;prefix&gt;/(lib/&lt;arch&gt;|lib|share)/cmake/&lt;name&gt;*/ (U)</span><br><span class="line">&lt;prefix&gt;/(lib/&lt;arch&gt;|lib|share)/&lt;name&gt;*/ (U)</span><br><span class="line">&lt;prefix&gt;/(lib/&lt;arch&gt;|lib|share)/&lt;name&gt;*/(cmake|CMake)/ (U)</span><br></pre></td></tr></table></figure><ul><li>cmake 找到这些目录后，会开始依次找 <strong><package>Config.cmake</package></strong>或 <strong>Find<package>.cmake</package></strong>文件，找到后即可执行该文件并生成相关链接信息</li><li>打开 /opt/ros/humble/share/rclcpp/cmake 会发现 rclcppConfig.cmake 就在其中</li></ul></li></ul><h3 id="23-ros2-节点介绍"><a class="markdownIt-Anchor" href="#23-ros2-节点介绍"></a> 2.3 ROS2 节点介绍</h3><ul><li><p>ROS2 中每一个节点也是只负责一个单独的模块化的功能（比如一个节点负责控制车轮转动、一个节点负责从激光雷达获取数据、一个节点负责处理激光雷达的数据、一个节点负责定位等等）</p></li><li><p><strong>ROS2 一共有四种通信方式实现节点之间的交互</strong></p><ul><li>话题 - topics</li><li>服务 - services</li><li>动作 - Action</li><li>参数 - parameters<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="475d0478f8c1f255b637322831846016.gif" alt="在这里插入图片描述"></li></ul></li><li><p><strong>ROS2 节点常用指令</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动功能包下的节点，格式：ros2 run &lt;package_name&gt; &lt;executable_name&gt;</span></span><br><span class="line">ros2 run turtlesim turtlesim_node</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看节点列表</span></span><br><span class="line">ros2 node list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看节点信息</span></span><br><span class="line">ros2 node info &lt;node_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重映射节点名称</span></span><br><span class="line">ros2 run turtlesim turtlesim_node <span class="literal">--ros-args</span> <span class="literal">--remap</span> __node:=my_turtle</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行节点时设置参数</span></span><br><span class="line">ros2 run example_parameters_rclcpp parameters_basic <span class="literal">--ros-args</span> <span class="literal">-p</span> rcl_log_level:=<span class="number">10</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="24-ros2-工作空间和功能包"><a class="markdownIt-Anchor" href="#24-ros2-工作空间和功能包"></a> 2.4 ROS2 工作空间和功能包</h3><blockquote><p>一个工作空间下可以有多个功能包，一个功能包可以有多个节点存在</p></blockquote><ul><li><p><strong>工作空间</strong>是包含若干个功能包的目录，一开始大家把工作空间理解成一个文件夹就行了。这个文件夹包含下有 src，所以一般新建一个工作空间的操作就像下面一样</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/d2lros2/chapt2/</span><br><span class="line">mkdir <span class="literal">-p</span> chapt2_ws/src</span><br></pre></td></tr></table></figure></li><li><p><strong>功能包</strong>可以理解为存放节点的地方，<strong>ROS2 中功能包根据编译方式的不同分为三种类型</strong></p><ul><li>ament_python，适用于 python 程序</li><li>cmake，适用于 C++</li><li>ament_cmake，适用于 C++ 程序，是 cmake 的增强版</li></ul></li><li><p><strong>功能包获取的两种方式</strong></p><ul><li><strong>1. 安装获取</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-&lt;version&gt;<span class="literal">-package_name</span></span><br></pre></td></tr></table></figure><ul><li><strong>2. 手动编译获取</strong><ul><li>需要下载源码然后进行编译生成相关文件</li><li>一般能安装的功能包都是作者编译好程序将可执行文件上传到仓库中，然后才能够通过 apt 进行安装，如果作者还没来得及测试上传，或者忘记了测试上传，就会找不到对应的包，这时候就需要手动编译安装了</li><li><strong>手动编译之后，需要手动 source 工作空间的 install 目录</strong></li></ul></li></ul></li><li><p><strong>与功能包相关的指令 ros2 pkg</strong></p><ul><li><strong>创建功能包</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg create &lt;package<span class="literal">-name</span>&gt; <span class="literal">--build-type</span> &#123;cmake,ament_cmake,ament_python&#125; <span class="literal">--dependencies</span> &lt;依赖名字&gt;</span><br></pre></td></tr></table></figure><ul><li><strong>列出可执行文件</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg executables <span class="comment"># 列出所有</span></span><br><span class="line">ros2 pkg executables turtlesim <span class="comment"># 列出 turtlesim 功能包的所有可执行文件</span></span><br></pre></td></tr></table></figure><ul><li><strong>列出所有的包</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 pkg list</span><br></pre></td></tr></table></figure><ul><li><strong>输出某个包所在路径的前缀</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ros2 pkg prefix &lt;package-name&gt;</span></span><br><span class="line">ros2 pkg prefix turtlesim</span><br></pre></td></tr></table></figure><ul><li><strong>列出包的清单描述文件</strong></li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每个功能包都有一个标配的 manifest.xml 文件，用于记录这个包的名字、构建工具、编译信息、拥有者和作用等信息</span></span><br><span class="line"><span class="comment"># 通过这个信息，就可以自动为该功能包安装依赖，构建时确定编译顺序等</span></span><br><span class="line">ros2 pkg xml turtlesim</span><br></pre></td></tr></table></figure></li></ul><h3 id="25-ros2-构建工具之-colcon"><a class="markdownIt-Anchor" href="#25-ros2-构建工具之-colcon"></a> 2.5 ROS2 构建工具之 colcon</h3><ul><li><p><strong>什么是 colcon</strong></p><ul><li>colcon 其实是一个功能包构建工具，用来编译代码的，ROS2 默认是没有安装 colcon 的，<strong>colcon 相当于 ROS1 中的 catkin 工具</strong></li></ul></li><li><p><strong>安装 colcon</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt<span class="literal">-get</span> install python3<span class="literal">-colcon-common-extensions</span></span><br></pre></td></tr></table></figure></li><li><p><strong>编译测试</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/d2lros2/chapt2/</span><br><span class="line">mkdir colcon_test_ws &amp;&amp; <span class="built_in">cd</span> colcon_test_ws</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ros2/examples src/examples <span class="literal">-b</span> galactic</span><br><span class="line">colcon build</span><br></pre></td></tr></table></figure></li></ul><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="606fa851dca7ce7babffb6210c0e6702.png" alt="在这里插入图片描述"></p><blockquote><p>构建完成后，在 src 同级目录应该会看到 build、install 和 log 目录</p><ul><li>build 目录存储的是中间文件，对于每个包，将创建一个子文件夹，在其中调用例如CMake</li><li>install 目录是每个软件包将安装到的位置，默认情况下，每个包都将安装到单独的子目录中</li><li>log 目录包含有关每个 colcon 调用的各种日志信息</li></ul></blockquote><ul><li><p><strong>运行测试</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 运行一个订者节点</span></span><br><span class="line"><span class="built_in">cd</span> ~/d2lros2/chapt2/colcon_test_ws</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run examples_rclcpp_minimal_subscriber subscriber_member_function</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开一个新的终端，先source，再运行一个发行者节点</span></span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run examples_rclcpp_minimal_publisher publisher_member_function</span><br></pre></td></tr></table></figure></li><li><p><strong>总结</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只编译一个包</span></span><br><span class="line">colcon build <span class="literal">--packages-select</span> YOUR_PKG_NAME</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不编译测试单元</span></span><br><span class="line">colcon build <span class="literal">--packages-select</span> YOUR_PKG_NAME <span class="literal">--cmake-args</span> <span class="literal">-DBUILD_TESTING</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行编译的包的测试</span></span><br><span class="line">colcon test</span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许通过更改 src 下的部分文件来改变 install</span></span><br><span class="line">colcon build <span class="literal">--symlink-install</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="26-使用-rclcpp-编写节点"><a class="markdownIt-Anchor" href="#26-使用-rclcpp-编写节点"></a> 2.6 使用 RCLCPP 编写节点</h3><ul><li><p><strong>创建工作空间</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/d2lros2/chapt2/</span><br><span class="line">mkdir <span class="literal">-p</span> chapt2_ws/src/</span><br></pre></td></tr></table></figure></li><li><p><strong>创建 example_cpp 功能包</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> chapt2_ws/src</span><br><span class="line"><span class="comment"># pkg create 是创建包的意思</span></span><br><span class="line"><span class="comment"># --build-type 用来指定该包的编译类型，一共有三个可选项 ament_python、ament_cmake、cmake</span></span><br><span class="line"><span class="comment"># --dependencies 指的是这个功能包的依赖，这里是 ros2 的 C++ 客户端接口 rclcpp</span></span><br><span class="line">ros2 pkg create example_cpp <span class="literal">--build-type</span> ament_cmake <span class="literal">--dependencies</span> rclcpp</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tree <span class="comment"># 查看 src 下的目录结构</span></span><br><span class="line">.</span><br><span class="line">└── example_cpp</span><br><span class="line">     ├── CMakeLists.txt</span><br><span class="line">	 ├── include</span><br><span class="line">	 │ └── example_cpp</span><br><span class="line">	 ├── package.xml</span><br><span class="line">	 └── src</span><br><span class="line">	 </span><br><span class="line"><span class="number">4</span> directories, <span class="number">2</span> files</span><br></pre></td></tr></table></figure></li><li><p><strong>创建节点</strong></p><ul><li>在 example_cpp/src 下创建一个 node_01.cpp 文件</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* 初始化rclcpp */</span></span><br><span class="line">    rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line">    <span class="comment">/*产生一个node_01的节点*/</span> <span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;rclcpp::Node&gt;(<span class="string">&quot;node_01&quot;</span>);</span><br><span class="line">    <span class="comment">// 打印一句自我介绍 RCLCPP_INFO(node-&gt;get_logger(), &quot;node_01节点已经启动.&quot;);</span></span><br><span class="line">    <span class="comment">/* 运行节点，并检测退出信号 Ctrl+C*/</span></span><br><span class="line">    rclcpp::<span class="built_in">spin</span>(node);</span><br><span class="line">    <span class="comment">/* 停止运行 */</span></span><br><span class="line">    rclcpp::<span class="built_in">shutdown</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>修改 CMakeLists.txt</strong></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 CMakeLists.txt 末尾添加下述代码</span></span><br><span class="line"></span><br><span class="line">add_executable(node_01 src/node_01.cpp)</span><br><span class="line">ament_target_dependencies(node_01 rclcpp)</span><br><span class="line"></span><br><span class="line">install(TARGETS</span><br><span class="line">  node_01</span><br><span class="line">  DESTINATION lib/$&#123;PROJECT_NAME&#125; </span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p><strong>编译运行</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/d2lros2/chapt2/chapt2_ws</span><br><span class="line">colcon build</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source install/setup.bash</span><br><span class="line">ros2 run example_cpp node_01</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">INFO</span>] [<span class="number">1711876723.907901312</span>] [<span class="type">node_01</span>]: node_01 <span class="built_in">start</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ros2 node list  <span class="comment"># 当节点运行起来后，查看现有的节点</span></span><br><span class="line">/node_01</span><br></pre></td></tr></table></figure></li></ul><h3 id="27-面向对象编程思想"><a class="markdownIt-Anchor" href="#27-面向对象编程思想"></a> 2.7 面向对象编程思想</h3><blockquote><p><strong>计算机编程三种编程思想</strong></p><ul><li>面向过程编程思想。缩写：POP</li><li>面向对象编程思想。缩写：OOP</li><li>函数式思想。缩写：FP</li></ul></blockquote><h4 id="271-三种编程思想对比"><a class="markdownIt-Anchor" href="#271-三种编程思想对比"></a> 2.7.1 三种编程思想对比</h4><blockquote><p>用三种思想把大象装进冰箱</p></blockquote><ul><li><strong>面向过程的思想</strong><ul><li>把大象塞进去</li><li>关上冰箱门</li></ul></li><li><strong>面向对象的思想</strong><ul><li>把冰箱理解为一个对象，就可以研究你家冰箱由哪些部分（指令装置等）组成，冰箱能干什么（制冷、调温等）？对象的行为其实是对其属性的操作：<strong>对象 = 属性 + 行为</strong></li><li><strong>采用 OOP 的方法把大象装进冰箱</strong><ul><li>调用：冰箱-&gt;打开门(行为)</li><li>调用：冰箱-&gt;装东西(行为)</li><li>调用：冰箱-&gt;关闭门(行为)</li></ul></li></ul></li><li><strong>函数式编程</strong><ul><li>定义关进（冰箱，大象）函数</li><li>实现函数：关门(放入(开门(冰箱)，大象))</li></ul></li></ul><h4 id="272-面向对象编程"><a class="markdownIt-Anchor" href="#272-面向对象编程"></a> 2.7.2 面向对象编程</h4><ul><li><strong>类与对象（抽象与具体）</strong><ul><li>通过调用<strong>容声（具体冰箱品牌）冰箱</strong>的开门、装东西和关门三个行为来把大象装进冰箱，这时可以把<strong>容声冰箱</strong>（具体的）称之为一个对象，而<strong>冰箱</strong>（抽象的）就称为一个类</li><li>在 ROS2 中的 DDS 是有很多厂家的，ROS2 为了匹配不同厂家的 DDS，就设计除了 DDS 抽象层，而每一个具体的 DDS 厂家，可以称之为一个 DDS 的对象，是具体的</li></ul></li><li><strong>封装、继承与多态</strong></li></ul><h3 id="28-使用面向对象方式编写-ros2-节点"><a class="markdownIt-Anchor" href="#28-使用面向对象方式编写-ros2-节点"></a> 2.8 使用面向对象方式编写 ROS2 节点</h3><ul><li><p>在 d2lros2/chapt2/chapt2_ws/src/example_cpp/src 下新建 node_02.cpp</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rclcpp/rclcpp.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个类节点，名字叫做Node03,继承自Node.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node03</span> : <span class="keyword">public</span> rclcpp::Node &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 构造函数,有一个参数为节点名称</span></span><br><span class="line">	<span class="built_in">Node03</span>(std::string name) : <span class="built_in">Node</span>(name) &#123;</span><br><span class="line">	    <span class="comment">// 打印一句</span></span><br><span class="line">		<span class="built_in">RCLCPP_INFO</span>(<span class="keyword">this</span>-&gt;<span class="built_in">get_logger</span>(), <span class="string">&quot;大家好，我是%s.&quot;</span>,name.<span class="built_in">c_str</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    rclcpp::<span class="built_in">init</span>(argc, argv);</span><br><span class="line">    <span class="comment">/*产生一个node_03的节点*/</span></span><br><span class="line">    <span class="keyword">auto</span> node = std::<span class="built_in">make_shared</span>&lt;Node03&gt;(<span class="string">&quot;node_03&quot;</span>);</span><br><span class="line">    <span class="comment">/* 运行节点，并检测退出信号*/</span></span><br><span class="line">    rclcpp::<span class="built_in">spin</span>(node);</span><br><span class="line">    rclcpp::<span class="built_in">shutdown</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>修改 CMakeLists.txt</strong></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 CMakeLists.txt 末尾添加下述代码</span></span><br><span class="line"></span><br><span class="line">add_executable(node_02 src/node_02.cpp)</span><br><span class="line">ament_target_dependencies(node_02 rclcpp)</span><br><span class="line"></span><br><span class="line">install(TARGETS</span><br><span class="line">  node_02</span><br><span class="line">  DESTINATION lib/$&#123;PROJECT_NAME&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p><strong>编译运行</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">colcon build <span class="literal">--packages-select</span> example_cpp</span><br><span class="line">source install/setup.bash</span><br><span class="line">ros2 run example_cpp node_02</span><br></pre></td></tr></table></figure></li></ul><h3 id="29-colcon-使用进阶"><a class="markdownIt-Anchor" href="#29-colcon-使用进阶"></a> 2.9 colcon 使用进阶</h3><h4 id="291-构建系统与构建工具"><a class="markdownIt-Anchor" href="#291-构建系统与构建工具"></a> 2.9.1 构建系统与构建工具</h4><ul><li><p>两者的区分点在于针对的对象不同，构建系统之针对一个单独的包进行构建，而构建工具重点在于按照依赖关系依次调用构建系统完成一系列功能包的构建</p><ul><li>ROS 中用到的构建系统：CMake、ament_cmake、catkin、Python setuptools</li><li>ROS 中用到的构建工具：colcon、catkin_make、catkin_make_isolated、catkin_tools</li></ul><blockquote><p><strong>colcon 作为构建工具，通过调用 CMake、Python setuptools 等构建系统完成构建</strong></p></blockquote></li><li><p><strong>常见构建系统</strong></p><ul><li><strong>CMake</strong>：是一个跨平台构建系统生成器。项目使用独立于平台的文件指定其生成过程。用户通过使用 CMake 为其平台上的本机工具生成构建系统来构建项目</li><li><strong>Python setuptools</strong>：Python 包的打包常用工具。Python 包使用文件来描述依赖项，以及如何构建和安装内容。在 ROS2 中，功能包可以是“普通” Python 包，而在 ROS1 中，任何 Python 功能都是从 CMake 文件触发 <a target="_blank" rel="noopener" href="http://setup.py">setup.py</a> 进行打包</li><li><strong>catkin</strong>：基于 CMake，并提供了一组方便的函数，使编写 CMake 包更容易。它自动生成 CMake 配置文件以及 pkg 配置文件。它还提供了注册不同类型测试的函数</li></ul></li><li><p><strong>常见构建工具</strong></p><ul><li><strong>catkin_make</strong>：该工具仅调用 CMake 一次，并使用 CMake 的函数在单个上下文中处理所有包。虽然这是一种有效的方法，因为所有包中的所有目标都可以并行化，但它具有明显的缺点：由于所有函数名称、目标和测试都共享一个命名空间，并且规模更大，这很容易导致冲突</li><li><strong>colcon</strong>：colcon 是一个命令行工具，用于改进构建，测试和使用多个软件包的工作流程。它自动化了流程，处理了订购并设置了使用软件包的环境</li><li><strong>ament_tools</strong>：由用于构建 ROS2 包的独立 Python3 包提供。它是为引导 ROS2 项目而开发的，因此仅针对 Python3，并且可以在 Linux，MacOS 和 Windows 上运行</li></ul></li></ul><h4 id="292-colcon-构建进阶之-build-参数解析"><a class="markdownIt-Anchor" href="#292-colcon-构建进阶之-build-参数解析"></a> 2.9.2 colcon 构建进阶之 build 参数解析</h4><ul><li><p><strong>构建指令</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">--packages-select</span>，仅生成单个包（或选定的包）</span><br><span class="line"><span class="literal">--packages-up-to</span>，构建选定的包，包括其依赖项</span><br><span class="line"><span class="literal">--packages-above</span>，整个工作区，然后对其中一个包进行了更改。此指令将重构此包以及（递归地）依赖于此包的所有包</span><br></pre></td></tr></table></figure></li><li><p><strong>指定构建后安装的目录</strong></p><ul><li>可以通过 --build-base 参数和 --install-base，指定构建目录和安装目录</li></ul></li><li><p><strong>合并构建目录</strong></p><ul><li>–merge-install，作为所有软件包的安装前缀，而不是安装基中的软件包特定子目录 --install-base</li><li>如果没有此选项，每个包都将提供自己的环境变量路径，从而导致非常长的环境变量值</li><li>使用此选项时，添加到环境变量的大多数路径将相同，从而导致环境变量值更短</li></ul></li><li><p><strong>符号链接安装</strong></p><ul><li>启用 --symlink-install 后将不会把文件拷贝到 install 目录，而是通过创建符号链接的方式</li></ul></li><li><p><strong>错误时继续安装</strong></p><ul><li>启用 --continue-on-error，当发生错误的时候继续进行编译</li></ul></li><li><p><strong>CMake 参数</strong></p><ul><li>–cmake-args，将任意参数传递给 CMake。与其他选项匹配的参数必须以空格为前缀</li></ul></li><li><p><strong>控制构建线程</strong></p><ul><li><p>–executor EXECUTOR</p><ul><li>用于处理所有作业的执行程序。默认值是根据所有可用执行程序扩展的优先级选择的。要查看完整列表，请调用 colcon extensions colcon_core.executor --verbose</li><li>sequential [colcon-core]：一次处理一个包</li><li>parallel [colcon-parallel-executor]：处理多个作业平行</li></ul></li><li><p>–parallel-workers NUMBER</p><ul><li>要并行处理的最大作业数。默认值为 os.cpu_count() 给出的逻辑 CPU 内核数</li></ul></li></ul></li><li><p><strong>开启构建日志</strong></p><ul><li>使用 --log-level 可以设置日志级别，比如 --log-level info</li></ul></li></ul><h3 id="210-ros2-节点发现与多机通信"><a class="markdownIt-Anchor" href="#210-ros2-节点发现与多机通信"></a> 2.10 ROS2 节点发现与多机通信</h3><ul><li><strong>ROS2 用于通讯的默认中间件是 DDS，在 DDS 中，不同逻辑网络共享物理网络的主要机制称为域 (Domain) ID</strong><ul><li>同一域上的 ROS2 节点可以自由地相互发现并发送消息，而不同域上的 ROS2 节点则不能</li><li>所有 ROS2 节点默认使用域 ID 为 0</li><li>为避免在同一网络上运行 ROS2 的不同计算机组之间互相干扰，应为每组设置不同的域 ID</li></ul></li><li><strong>选择域 ID（短版本）</strong><ul><li>只需选择一个介于 0 和 101 之间的安全的域 ID (包括 0 和 101)</li></ul></li><li><strong>选择域 ID（长版本）</strong><ul><li>DDS 使用域 ID 计算将用于发现和通讯的 UDP 端口，网络中 UDP 端口是无符号 16 位整型，因此可以分配的最大端口号是 65535</li></ul></li><li><strong>特定平台的约束：</strong><ul><li>为了实现最大的兼容性，在选择域账号时应遵循一些特定于平台的附加约束。特别是，最好避免在操作系统的临时端口范围中分配域 ID，避免 ROS2 节点使用的端口与计算机上的其他网络服务之间可能的冲突</li></ul></li><li><strong>参与者约束</strong><ul><li>对于计算机上运行的每个 ROS2 进程，将创建一个 DDS “participant”。由于每个 DDS 参与者占用计算机上的两个端口，因此在一台计算机上运行 120 个以上的 ROS2 进程可能会溢出到其他域 ID 或临时端口</li></ul></li><li><strong>域ID到UDP端口号计算器</strong><ul><li><a target="_blank" rel="noopener" href="http://dev.ros2.fishros.com/doc/Concepts/About-Domain-ID.html#domain-id-to-udp-port-calculator">http://dev.ros2.fishros.com/doc/Concepts/About-Domain-ID.html#domain-id-to-udp-port-calculator</a></li></ul></li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc">formeasy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc/2025/01/24/ROS/ROS2%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">http://www.formeasy.cc/2025/01/24/ROS/ROS2简介与基本使用/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://www.formeasy.cc" target="_blank">易锦风的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ROS/">ROS</a></div><div class="post-share"><div class="social-share" data-image="/2025/01/24/ROS/ROS2%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/3ca4d9399b3e53e675dbfd863d98611c.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/01/24/kubernetes/K8s%E7%9A%84%E8%B5%84%E6%BA%90%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/" title="K8s的资源组件介绍"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/01/24/kubernetes/K8s%E7%9A%84%E8%B5%84%E6%BA%90%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/2b44838f9ab8efe32c10e73cb7435198.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">K8s的资源组件介绍</div></div><div class="info-2"><div class="info-item-1">引言 这篇重点介绍K8s的资源组件和相关配置使用。 1. Node &amp; Pod Node: 是 Pod 真正运行的主机，可以是物理机，也可以是虚拟机。为了管理 Pod，每个 Node 节点上至少要运行 container runtime（比如 docker, rkt, containerd）、kubelet 和 kube-proxy 服务。 Pod: 是一组紧密关联的容器集合（也可以是单个容器），它们共享 IPC（进程间通信） ， Network namespace 和 文件存储（需挂载到容器），是 Kubernetes 调度的基本单位。 Node和Pod的关系如下图所示： 上图中的Node中共有4个Pod，分别为： 2. Namespaces 是对一组资源和对象的抽象集合，相当于给k8s系统内部的对象划分一些命名空间。常见的 pods, services, replication controllers 和 deployments 等都是属于某一个 namespace 的（默认是...</div></div></div></a><a class="pagination-related" href="/2025/01/23/C/c++%E4%B9%8B%E7%BB%84%E5%90%88%E3%80%81%E7%BB%A7%E6%89%BF%E3%80%81%E8%81%9A%E5%90%88%E5%8F%8A%E4%BE%9D%E8%B5%96/" title="c++之组合、继承、聚合及依赖"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">c++之组合、继承、聚合及依赖</div></div><div class="info-2"><div class="info-item-1">在学习c++的过程中相信大家对这几个概念都不陌生。 c++中一些常用的设计模式都是由这几种特性组合而成。本文再从整体对这个概念或者特性进行简要的介绍。 组合 c++中类之间的一种关系叫做&quot;has-a&quot;的关系。这种关系表示的是一个类中包含另一类的对象，体现了“有一个”的关系。这个被包含的类一般以实例对象的形式存在，而非指针对象的形式存在。请看下面的示例: 12345678910111213141516171819class Engine&#123;	public: void start() &#123; cout&lt;&lt;&quot;引擎启动&quot;&lt;&lt;endl; &#125;&#125;class car&#123;private:	Engine engine; //这里以实例的形式存在，而非指针，在类关系中是组合的关系public:	void startCar()	&#123; engine.start(); //启动引擎	&#125;&#125; ...</div></div></div></a></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">formeasy</div><div class="author-info-description">专注互联网和软件技术</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">199</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/formeasy"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/formeasy" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:formeasy@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">用学习，面对遭遇的变化；用斗志，面对每天的挫折；用坚持，面对失去的动力!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-ros2-%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-number">1.</span> <span class="toc-text">1. ROS2 介绍与安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-ros2-%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 ROS2 的历史</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#111-ros-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 ROS 的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#112-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-ros2"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 为什么需要 ROS2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#113-ros2-%E7%89%88%E6%9C%AC%E5%AF%B9%E7%85%A7%E8%A1%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 ROS2 版本对照表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-ros-%E5%92%8C-ros2-%E5%AF%B9%E6%AF%94"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 ROS 和 ROS2 对比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#121-ros-%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 ROS 存在的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#122-ros-%E4%B8%8E-ros2-%E6%9E%B6%E6%9E%84%E5%AF%B9%E6%AF%94"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 ROS 与 ROS2 架构对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E5%AE%89%E8%A3%85-ros2"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 安装 ROS2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-ros2-%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 ROS2 初体验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-ros2-%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 ROS2 系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#151-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%B1%82"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.5.1 操作系统层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#152-dds%E5%AE%9E%E7%8E%B0%E5%B1%82"><span class="toc-number">1.5.2.</span> <span class="toc-text">1.5.2 DDS实现层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#153-%E6%8A%BD%E8%B1%A1-dds-%E5%B1%82rmw"><span class="toc-number">1.5.3.</span> <span class="toc-text">1.5.3 抽象 DDS 层（RMW）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#154-ros2-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%93rcl"><span class="toc-number">1.5.4.</span> <span class="toc-text">1.5.4 ROS2 客户端库（RCL）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#155-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">1.5.5.</span> <span class="toc-text">1.5.5 应用层</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-%E4%B8%AD%E9%97%B4%E4%BB%B6-dds-%E6%9E%B6%E6%9E%84"><span class="toc-number">1.6.</span> <span class="toc-text">1.6 中间件 DDS 架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#161-%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.6.1.</span> <span class="toc-text">1.6.1 什么是中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#162-dds-%E5%92%8C-ros2-%E6%9E%B6%E6%9E%84"><span class="toc-number">1.6.2.</span> <span class="toc-text">1.6.2 DDS 和 ROS2 架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#163-dds-%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.6.3.</span> <span class="toc-text">1.6.3 DDS 通信模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#164-dds-%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.6.4.</span> <span class="toc-text">1.6.4 DDS 优缺点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-ros2-%E7%AC%AC%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9"><span class="toc-number">2.</span> <span class="toc-text">2. ROS2 第一个节点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E4%BD%BF%E7%94%A8-cmakelisttxt-%E7%BC%96%E8%AF%91-ros2-%E7%9A%84%E8%8A%82%E7%82%B9"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 使用 CMakeList.txt 编译 ROS2 的节点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#211-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 动态链接库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#212-%E7%BC%96%E8%AF%91-ros2-%E7%9A%84-c-%E8%8A%82%E7%82%B9"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 编译 ROS2 的 C++ 节点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-cmake-%E4%BE%9D%E8%B5%96%E6%9F%A5%E6%89%BE%E6%B5%81%E7%A8%8B"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 CMake 依赖查找流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-ros2-%E8%8A%82%E7%82%B9%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 ROS2 节点介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-ros2-%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E5%92%8C%E5%8A%9F%E8%83%BD%E5%8C%85"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 ROS2 工作空间和功能包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-ros2-%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%B9%8B-colcon"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 ROS2 构建工具之 colcon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-%E4%BD%BF%E7%94%A8-rclcpp-%E7%BC%96%E5%86%99%E8%8A%82%E7%82%B9"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 使用 RCLCPP 编写节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3"><span class="toc-number">2.7.</span> <span class="toc-text">2.7 面向对象编程思想</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#271-%E4%B8%89%E7%A7%8D%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3%E5%AF%B9%E6%AF%94"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.7.1 三种编程思想对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#272-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.7.2 面向对象编程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-%E4%BD%BF%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%96%B9%E5%BC%8F%E7%BC%96%E5%86%99-ros2-%E8%8A%82%E7%82%B9"><span class="toc-number">2.8.</span> <span class="toc-text">2.8 使用面向对象方式编写 ROS2 节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-colcon-%E4%BD%BF%E7%94%A8%E8%BF%9B%E9%98%B6"><span class="toc-number">2.9.</span> <span class="toc-text">2.9 colcon 使用进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#291-%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F%E4%B8%8E%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="toc-number">2.9.1.</span> <span class="toc-text">2.9.1 构建系统与构建工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#292-colcon-%E6%9E%84%E5%BB%BA%E8%BF%9B%E9%98%B6%E4%B9%8B-build-%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="toc-number">2.9.2.</span> <span class="toc-text">2.9.2 colcon 构建进阶之 build 参数解析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#210-ros2-%E8%8A%82%E7%82%B9%E5%8F%91%E7%8E%B0%E4%B8%8E%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1"><span class="toc-number">2.10.</span> <span class="toc-text">2.10 ROS2 节点发现与多机通信</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/27/Springboot/Spring%20Boot%203%20%E6%95%B4%E5%90%88%20MyBatis-Plus%20%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B/" title="Spring Boot 3 整合 MyBatis-Plus 完整示例"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Spring Boot 3 整合 MyBatis-Plus 完整示例"></a><div class="content"><a class="title" href="/2025/08/27/Springboot/Spring%20Boot%203%20%E6%95%B4%E5%90%88%20MyBatis-Plus%20%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B/" title="Spring Boot 3 整合 MyBatis-Plus 完整示例">Spring Boot 3 整合 MyBatis-Plus 完整示例</a><time datetime="2025-08-27T09:06:33.000Z" title="发表于 2025-08-27 17:06:33">2025-08-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/27/Springboot/SpringBoot%E6%95%B4%E5%90%88Spring%20Security%E5%AE%9E%E7%8E%B0%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/" title="SpringBoot整合Spring Security实现认证与授权"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/08/27/Springboot/SpringBoot%E6%95%B4%E5%90%88Spring%20Security%E5%AE%9E%E7%8E%B0%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/gqnkyc66e4gn2_9e13ac55ee084f79bb67aa80cffde80a.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="SpringBoot整合Spring Security实现认证与授权"></a><div class="content"><a class="title" href="/2025/08/27/Springboot/SpringBoot%E6%95%B4%E5%90%88Spring%20Security%E5%AE%9E%E7%8E%B0%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/" title="SpringBoot整合Spring Security实现认证与授权">SpringBoot整合Spring Security实现认证与授权</a><time datetime="2025-08-27T05:38:56.000Z" title="发表于 2025-08-27 13:38:56">2025-08-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/26/Springboot/Spring%20Boot%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(%E6%A1%88%E4%BE%8B%E7%AF%87)/" title="Spring Boot入门指南(案例篇)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/08/26/Springboot/Spring%20Boot%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(%E6%A1%88%E4%BE%8B%E7%AF%87)/baaa5c67e3754abe83e0bbb2f2e14c58.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Spring Boot入门指南(案例篇)"></a><div class="content"><a class="title" href="/2025/08/26/Springboot/Spring%20Boot%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97(%E6%A1%88%E4%BE%8B%E7%AF%87)/" title="Spring Boot入门指南(案例篇)">Spring Boot入门指南(案例篇)</a><time datetime="2025-08-26T05:33:37.000Z" title="发表于 2025-08-26 13:33:37">2025-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/25/Springboot/IntelliJ%20IDEA-Gradle-SpringBoot%E6%90%AD%E5%BB%BA/" title="IntelliJ IDEA-Gradle-SpringBoot搭建"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/08/25/Springboot/IntelliJ%20IDEA-Gradle-SpringBoot%E6%90%AD%E5%BB%BA/bf20a8e746a740ac3d0d29d4bc6d8d3f.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="IntelliJ IDEA-Gradle-SpringBoot搭建"></a><div class="content"><a class="title" href="/2025/08/25/Springboot/IntelliJ%20IDEA-Gradle-SpringBoot%E6%90%AD%E5%BB%BA/" title="IntelliJ IDEA-Gradle-SpringBoot搭建">IntelliJ IDEA-Gradle-SpringBoot搭建</a><time datetime="2025-08-25T06:53:06.000Z" title="发表于 2025-08-25 14:53:06">2025-08-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/25/Springboot/Gradle%20%E5%AE%89%E8%A3%85%E5%92%8C%E4%B8%8B%E8%BD%BD/" title="Gradle 安装和下载"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/08/25/Springboot/Gradle%20%E5%AE%89%E8%A3%85%E5%92%8C%E4%B8%8B%E8%BD%BD/4fcfe740e4704d31b12c9cd7ca46c0d9.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Gradle 安装和下载"></a><div class="content"><a class="title" href="/2025/08/25/Springboot/Gradle%20%E5%AE%89%E8%A3%85%E5%92%8C%E4%B8%8B%E8%BD%BD/" title="Gradle 安装和下载">Gradle 安装和下载</a><time datetime="2025-08-25T06:27:17.000Z" title="发表于 2025-08-25 14:27:17">2025-08-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By formeasy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(async()=>{window.katex_js_css||(window.katex_js_css=!0,await btf.getCSS("https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"),await btf.getScript("https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js")),document.querySelectorAll("#article-container .katex").forEach(t=>t.classList.add("katex-show"))})()</script><script>(()=>{var e=()=>{var e;0!==(e=document.querySelectorAll("pre > code.mermaid")).length&&e.forEach(e=>{var t=document.createElement("pre"),n=(t.className="mermaid-src",t.hidden=!0,t.textContent=e.textContent,document.createElement("div"));n.className="mermaid-wrap",n.appendChild(t),e.parentNode.replaceWith(n)});const t=document.querySelectorAll("#article-container .mermaid-wrap");0!==t.length&&(e=()=>{{var e=t;window.loadMermaid=!0;const a="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";e.forEach((e,t)=>{const n=e.firstElementChild;e=`%%{init:{ 'theme':'${a}'}}%%
`+n.textContent,t=mermaid.render("mermaid-"+t,e);const d=e=>{n.insertAdjacentHTML("afterend",e)};"string"==typeof t?d(t):t.then(({svg:e})=>d(e))})}},btf.addGlobalFn("themeChange",e,"mermaid"),window.loadMermaid?e():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(e))};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{const a=GLOBAL_CONFIG_SITE.isShuoshuo,s=null,n=t=>"dark"===t?"dark":"light";var t=(t=document,e)=>{e=a?{"data-mapping":"specific","data-term":e}:{"data-mapping":(s,"pathname")},e=(t=>{const a=document.createElement("script");return Object.entries(t).forEach(([t,e])=>{a.setAttribute(t,e)}),a})({src:"https://giscus.app/client.js","data-repo":"formeasy/blog","data-repo-id":"R_kgDOJ2sA5A","data-category-id":"DIC_kwDOJ2sA5M4CktKh","data-theme":n(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0,...s,...e});t.querySelector("#giscus-wrap").appendChild(e),a&&(window.shuoshuoComment.destroyGiscus=()=>{t.children.length&&(t.innerHTML="",t.classList.add("no-comment"))})};btf.addGlobalFn("themeChange",t=>{var e=document.querySelector("#giscus-wrap iframe");e&&(t={giscus:{setConfig:{theme:n(t)}}},e.contentWindow.postMessage(t,"https://giscus.app"))},"giscus"),a?window.shuoshuoComment={loadComment:t}:t()})()</script></div><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="请输入搜索关键字" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>