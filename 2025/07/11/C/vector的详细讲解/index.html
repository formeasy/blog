<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>vector的详细讲解 | 易锦风的博客</title><meta name="author" content="formeasy"><meta name="copyright" content="formeasy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="vector的详细讲解"><meta property="og:type" content="article"><meta property="og:title" content="vector的详细讲解"><meta property="og:url" content="http://www.formeasy.cc/2025/07/11/C/vector%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%A7%A3/index.html"><meta property="og:site_name" content="易锦风的博客"><meta property="og:description" content="vector的详细讲解"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.formeasy.cc/2025/07/11/C/vector%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%A7%A3/53d1d2e536204e609dc694bcb054ce9c.png"><meta property="article:published_time" content="2025-07-11T01:07:09.000Z"><meta property="article:modified_time" content="2025-07-11T01:59:17.840Z"><meta property="article:author" content="formeasy"><meta property="article:tag" content="C"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://www.formeasy.cc/2025/07/11/C/vector%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%A7%A3/53d1d2e536204e609dc694bcb054ce9c.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.formeasy.cc/2025/07/11/C/vector%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%A7%A3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{var e={set:(e,t,a)=>{a&&(a=Date.now()+864e5*a,localStorage.setItem(e,JSON.stringify({value:t,expiry:a})))},get:e=>{var t=localStorage.getItem(e);if(t){var{value:t,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return t;localStorage.removeItem(e)}}},t=(window.btf={saveToLocal:e,getScript:(o,n={})=>new Promise((e,t)=>{const a=document.createElement("script");a.src=o,a.async=!0,Object.entries(n).forEach(([e,t])=>a.setAttribute(e,t)),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),getCSS:(o,n)=>new Promise((e,t)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),addGlobalFn:(e,t,a=!1,o=window)=>{var n;e.startsWith("pjax")||((n=o.globalFn||{})[e]=n[e]||{},n[e][a||Object.keys(n[e]).length]=t,o.globalFn=n)}},()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")}),a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")},o=(btf.activateDarkMode=t,btf.activateLightMode=a,e.get("theme")),t=("dark"===o?t():"light"===o&&a(),e.get("aside-status"));void 0!==t&&document.documentElement.classList.toggle("hide-aside","hide"===t);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"未找到符合您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1,highlightFullpage:!1,highlightMacStyle:!0},copy:{success:"复制成功",error:"复制失败",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"vector的详细讲解",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="易锦风的博客" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">247</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 资源链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/2025/07/11/C/vector的详细讲解/53d1d2e536204e609dc694bcb054ce9c.png)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon.png" alt="Logo"><span class="site-name">易锦风的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">vector的详细讲解</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 资源链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">vector的详细讲解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-11T01:07:09.000Z" title="发表于 2025-07-11 09:07:09">2025-07-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-11T01:59:17.840Z" title="更新于 2025-07-11 09:59:17">2025-07-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>30分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="1vector的介绍及使用"><a class="markdownIt-Anchor" href="#1vector的介绍及使用"></a> <strong>1.vector的介绍及使用</strong></h2><h3 id="11-vector的介绍"><a class="markdownIt-Anchor" href="#11-vector的介绍"></a> <strong>1.1 vector的介绍</strong></h3><p>1. vector 是表示可变大小数组的序列容器。</p><p>2. 就像数组一样， vector 也采用的连续存储空间来存储元素。也就是意味着可以采用下标对 vector 的元素 进行访问，和数组一样高效。但是又不像数组，它的大小是可以动态改变的，而且它的大小会被容器自 动处理。</p><p>3. 本质讲， vector 使用动态分配数组来存储它的元素。当新元素插入时候，这个数组需要被重新分配大小 为了增加存储空间。其做法是，分配一个新的数组，然后将全部元素移到这个数组。就时间而言，这是 一个相对代价高的任务，因为每当一个新的元素加入到容器的时候，vector 并不会每次都重新分配大 小。</p><p>4. vector 分配空间策略： vector 会分配一些额外的空间以适应可能的增长，因为存储空间比实际需要的存 储空间更大。不同的库采用不同的策略权衡空间的使用和重新分配。但是无论如何，重新分配都应该是 对数增长的间隔大小，以至于在末尾插入一个元素的时候是在常数时间的复杂度完成的。</p><p>5. 因此， vector 占用了更多的存储空间，为了获得管理存储空间的能力，并且以一种有效的方式动态增 长。</p><p>6. 与其它动态序列容器相比（ deque, list and forward_list ），vector 在访问元素的时候更加高效，在末 尾添加和删除元素相对高效。对于其它不在末尾的删除和插入操作，效率更低。比起list 和 forward_list 统一的迭代器和引用更好。</p><p>使用 STL 的三个境界：能用，明理，能扩展 ，那么下面学习 vector，我们也是按照这个方法去学习</p><p>当然也可以借助文档来学习 <a target="_blank" rel="noopener" href="http://www.cplusplus.com/reference/vector/vector/" title=" http://www.cplusplus.com/reference/vector/vector/">http://www.cplusplus.com/reference/vector/vector/</a></p><h3 id="12-vector的使用"><a class="markdownIt-Anchor" href="#12-vector的使用"></a> <strong>1.2 vector的使用</strong></h3><p>vector 学习时一定要学会查看文档，vector在实际中非常的重要，在实际中我们熟悉常</p><p>见的接口就可以，下面列出了 <strong>哪些接口是要重点掌握的</strong> 。</p><h4 id="121-vector的定义"><a class="markdownIt-Anchor" href="#121-vector的定义"></a> <strong>1.2.1 vector的定义</strong></h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="53d1d2e536204e609dc694bcb054ce9c.png" alt=""></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//    vector的构造</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">TestVector1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// constructors used in the same order as described above:</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; first;                                <span class="comment">// empty vector of ints</span></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">second</span><span class="params">(<span class="number">4</span>, <span class="number">100</span>)</span></span>;                       <span class="comment">// four ints with value 100</span></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">third</span><span class="params">(second.begin(), second.end())</span></span>;  <span class="comment">// iterating through second</span></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fourth</span><span class="params">(third)</span></span>;                       <span class="comment">// a copy of third</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 下面涉及迭代器初始化的部分，我们学习完迭代器再来看这部分</span></span><br><span class="line">	<span class="comment">// the iterator constructor can also be used to construct from arrays:</span></span><br><span class="line">	<span class="type">int</span> myints[] = &#123; <span class="number">16</span>,<span class="number">2</span>,<span class="number">77</span>,<span class="number">29</span> &#125;;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fifth</span><span class="params">(myints, myints + <span class="keyword">sizeof</span>(myints) / <span class="keyword">sizeof</span>(<span class="type">int</span>))</span></span>;</span><br><span class="line"> </span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of fifth are:&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (vector&lt;<span class="type">int</span>&gt;::iterator it = fifth.<span class="built_in">begin</span>(); it != fifth.<span class="built_in">end</span>(); ++it)</span><br><span class="line">		cout &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; *it;</span><br><span class="line">	cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="122-vector-iterator的使用"><a class="markdownIt-Anchor" href="#122-vector-iterator的使用"></a> <strong>1.2.2 vector iterator的使用</strong></h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="cdd7d0cf9f5246c38678b39e9f6b49ac.png" alt=""></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//  vector的迭代器</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PrintVector</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// const对象使用const迭代器进行遍历打印</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::const_iterator it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVector2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 使用push_back插入4个数据</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 使用迭代器进行遍历打印</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::iterator it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 使用迭代器进行修改</span></span><br><span class="line">	it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		*it *= <span class="number">2</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 使用反向迭代器进行遍历再打印</span></span><br><span class="line">	<span class="comment">// vector&lt;int&gt;::reverse_iterator rit = v.rbegin();</span></span><br><span class="line">	<span class="keyword">auto</span> rit = v.<span class="built_in">rbegin</span>();</span><br><span class="line">	<span class="keyword">while</span> (rit != v.<span class="built_in">rend</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *rit &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++rit;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="built_in">PrintVector</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="123-vector-空间增长问题"><a class="markdownIt-Anchor" href="#123-vector-空间增长问题"></a> <strong>1.2.3 vector 空间增长问题</strong></h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="5886f5ee106f481f9754db7d66eb2a51.png" alt=""></p><p>capacity 的代码在 vs 和 g++ 下分别运行会发现， <strong>vs</strong> <strong>下</strong> <strong>capacity</strong> <strong>是按</strong> <strong>1.5</strong> <strong>倍增长的，</strong> <strong>g++</strong> <strong>是按</strong> <strong>2</strong> <strong>倍增长的</strong> 。 这个问题经常会考察，不要固化的认为，vector 增容都是 2 倍，具体增长多少是根据具体的需求定义 的。vs 是 PJ 版本 STL ， g++ 是 SGI 版本 STL 。</p><p>reserve 只负责开辟空间，如果确定知道需要用多少空间， reserve 可以缓解 vector 增容的代价缺陷问 题。 resize在开空间的同时还会进行初始化，影响 size 。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试vector的默认扩容机制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVectorExpand</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">size_t</span> sz;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">	sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;making v grow:\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		v.<span class="built_in">push_back</span>(i);</span><br><span class="line">		<span class="keyword">if</span> (sz != v.<span class="built_in">capacity</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;capacity changed: &quot;</span> &lt;&lt; sz &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//vs：运行结果：vs下使用的STL基本是按照1.5倍方式扩容</span></span><br><span class="line"><span class="comment">//making foo grow :</span></span><br><span class="line"><span class="comment">//capacity changed : 1</span></span><br><span class="line"><span class="comment">//capacity changed : 2</span></span><br><span class="line"><span class="comment">//capacity changed : 3</span></span><br><span class="line"><span class="comment">//capacity changed : 4</span></span><br><span class="line"><span class="comment">//capacity changed : 6</span></span><br><span class="line"><span class="comment">//capacity changed : 9</span></span><br><span class="line"><span class="comment">//capacity changed : 13</span></span><br><span class="line"><span class="comment">//capacity changed : 19</span></span><br><span class="line"><span class="comment">//capacity changed : 28</span></span><br><span class="line"><span class="comment">//capacity changed : 42</span></span><br><span class="line"><span class="comment">//capacity changed : 63</span></span><br><span class="line"><span class="comment">//capacity changed : 94</span></span><br><span class="line"><span class="comment">//capacity changed : 141</span></span><br><span class="line"><span class="comment">//g++运行结果：linux下使用的STL基本是按照2倍方式扩容</span></span><br><span class="line"><span class="comment">//making foo grow :</span></span><br><span class="line"><span class="comment">//capacity changed : 1</span></span><br><span class="line"><span class="comment">//capacity changed : 2</span></span><br><span class="line"><span class="comment">//capacity changed : 4</span></span><br><span class="line"><span class="comment">//capacity changed : 8</span></span><br><span class="line"><span class="comment">//capacity changed : 16</span></span><br><span class="line"><span class="comment">//capacity changed : 32</span></span><br><span class="line"><span class="comment">//capacity changed : 64</span></span><br><span class="line"><span class="comment">//capacity changed : 128</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果已经确定vector中要存储元素大概个数，可以提前将空间设置足够</span></span><br><span class="line"><span class="comment">// 就可以避免边插入边扩容导致效率低下的问题了</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVectorExpandOP</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">	<span class="type">size_t</span> sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">	v.<span class="built_in">reserve</span>(<span class="number">100</span>); <span class="comment">// 提前将容量设置好，可以避免一遍插入一遍扩容</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;making bar grow:\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		v.<span class="built_in">push_back</span>(i);</span><br><span class="line">		<span class="keyword">if</span> (sz != v.<span class="built_in">capacity</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;capacity changed: &quot;</span> &lt;&lt; sz &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接口演示：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//  vector的resize 和 reserve</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// reisze(size_t n, const T&amp; data = T())</span></span><br><span class="line"><span class="comment">// 将有效元素个数设置为n个，如果时增多时，增多的元素使用data进行填充</span></span><br><span class="line"><span class="comment">// 注意：resize在增多元素个数时可能会扩容</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVector3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// set some initial content:</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">		v.<span class="built_in">push_back</span>(i);</span><br><span class="line"> </span><br><span class="line">	v.<span class="built_in">resize</span>(<span class="number">5</span>);</span><br><span class="line">	v.<span class="built_in">resize</span>(<span class="number">8</span>, <span class="number">100</span>);</span><br><span class="line">	v.<span class="built_in">resize</span>(<span class="number">12</span>);</span><br><span class="line"> </span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;v contains:&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); i++)</span><br><span class="line">		cout &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; v[i];</span><br><span class="line">	cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 测试vector的默认扩容机制</span></span><br><span class="line"><span class="comment">// vs：按照1.5倍方式扩容</span></span><br><span class="line"><span class="comment">// linux：按照2倍方式扩容</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVectorExpand</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">size_t</span> sz;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">	sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;making v grow:\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i) </span><br><span class="line">	&#123;</span><br><span class="line">		v.<span class="built_in">push_back</span>(i);</span><br><span class="line">		<span class="keyword">if</span> (sz != v.<span class="built_in">capacity</span>()) </span><br><span class="line">		&#123;</span><br><span class="line">			sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;capacity changed: &quot;</span> &lt;&lt; sz &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 往vecotr中插入元素时，如果大概已经知道要存放多少个元素</span></span><br><span class="line"><span class="comment">// 可以通过reserve方法提前将容量设置好，避免边插入边扩容效率低</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVectorExpandOP</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">	<span class="type">size_t</span> sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">	v.<span class="built_in">reserve</span>(<span class="number">100</span>);   <span class="comment">// 提前将容量设置好，可以避免一遍插入一遍扩容</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;making bar grow:\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i) </span><br><span class="line">	&#123;</span><br><span class="line">		v.<span class="built_in">push_back</span>(i);</span><br><span class="line">		<span class="keyword">if</span> (sz != v.<span class="built_in">capacity</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			sz = v.<span class="built_in">capacity</span>();</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;capacity changed: &quot;</span> &lt;&lt; sz &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="124-vector-增删查改"><a class="markdownIt-Anchor" href="#124-vector-增删查改"></a> <strong>1.2.4 vector</strong> <strong>增删查改</strong></h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="075eccb41c304871be40a529732f5e66.png" alt=""></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//  vector的增删改查</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// 尾插和尾删：push_back/pop_back</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVector4</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>()) </span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	v.<span class="built_in">pop_back</span>();</span><br><span class="line">	v.<span class="built_in">pop_back</span>();</span><br><span class="line"> </span><br><span class="line">	it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>()) </span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 任意位置插入：insert和erase，以及查找find</span></span><br><span class="line"><span class="comment">// 注意find不是vector自身提供的方法，是STL提供的算法</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVector5</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 使用列表方式初始化，C++11新语法</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 在指定位置前插入值为val的元素，比如：3之前插入30,如果没有则不插入</span></span><br><span class="line">	<span class="comment">// 1. 先使用find查找3所在位置</span></span><br><span class="line">	<span class="comment">// 注意：vector没有提供find方法，如果要查找只能使用STL提供的全局find</span></span><br><span class="line">	<span class="keyword">auto</span> pos = <span class="built_in">find</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">3</span>);</span><br><span class="line">	<span class="keyword">if</span> (pos != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 2. 在pos位置之前插入30</span></span><br><span class="line">		v.<span class="built_in">insert</span>(pos, <span class="number">30</span>);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::iterator it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>()) </span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	pos = <span class="built_in">find</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">3</span>);</span><br><span class="line">	<span class="comment">// 删除pos位置的数据</span></span><br><span class="line">	v.<span class="built_in">erase</span>(pos);</span><br><span class="line"> </span><br><span class="line">	it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// operator[]+index 和 C++11中vector的新式for+auto的遍历</span></span><br><span class="line"><span class="comment">// vector使用这两种遍历方式是比较便捷的。</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestVector6</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 通过[]读写第0个位置。</span></span><br><span class="line">	v[<span class="number">0</span>] = <span class="number">10</span>;</span><br><span class="line">	cout &lt;&lt; v[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 1. 使用for+[]小标方式遍历</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); ++i)</span><br><span class="line">		cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; swapv;</span><br><span class="line">	swapv.<span class="built_in">swap</span>(v);</span><br><span class="line"> </span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;v data:&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); ++i)</span><br><span class="line">		cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 2. 使用迭代器遍历</span></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;swapv data:&quot;</span>;</span><br><span class="line">	<span class="keyword">auto</span> it = swapv.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != swapv.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 3. 使用范围for遍历</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : v)</span><br><span class="line">		cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="125-vector-迭代器失效问题-重点"><a class="markdownIt-Anchor" href="#125-vector-迭代器失效问题-重点"></a> <strong>1.2.5 vector</strong> <strong>迭代器失效问题。（重点）</strong></h4><p><strong>迭代器的主要作用就是让算法能够不用关心底层数据结构，其底层实际就是一个指针，或者是对指针进行了</strong> <strong>封装</strong> ，比如： <strong>vector</strong> <strong>的迭代器就是原生态指针</strong> <strong>T*</strong> 。因此 <strong>迭代器失效，实际就是迭代器底层对应指针所指向的</strong> <strong>空间被销毁了，而使用一块已经被释放的空间</strong> ，造成的后果是程序崩溃 ( 即 <strong>如果继续使用已经失效的迭代器，</strong> <strong>程序可能会崩溃</strong> ) 。 对于vector 可能会导致其迭代器失效的操作有：</p><p>1. <strong>会引起其底层空间改变的操作，都有可能是迭代器失效</strong> ，比如： resize 、 reserve 、 insert 、 assign 、 push_back等</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span> &#125;;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 将有效元素个数增加到100个，多出的位置使用8填充，操作期间底层会扩容</span></span><br><span class="line">	<span class="comment">// v.resize(100, 8);</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">// reserve的作用就是改变扩容大小但不改变有效元素个数，操作期间可能会引起底层容量改变</span></span><br><span class="line">	<span class="comment">// v.reserve(100);</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 插入元素期间，可能会引起扩容，而导致原空间被释放</span></span><br><span class="line">	<span class="comment">// v.insert(v.begin(), 0);</span></span><br><span class="line">	<span class="comment">// v.push_back(8);</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 给vector重新赋值，可能会引起底层容量改变</span></span><br><span class="line">	v.<span class="built_in">assign</span>(<span class="number">100</span>, <span class="number">8</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	出错原因：以上操作，都有可能会导致vector扩容，也就是说vector底层原理旧空间被释放掉，</span></span><br><span class="line"><span class="comment">   而在打印时，it还使用的是释放之间的旧空间，在对it迭代器操作时，实际操作的是一块已经被释放的</span></span><br><span class="line"><span class="comment">   空间，而引起代码运行时崩溃。</span></span><br><span class="line"><span class="comment">	解决方式：在以上操作完成之后，如果想要继续通过迭代器操作vector中的元素，只需给it重新</span></span><br><span class="line"><span class="comment">   赋值即可。</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2. 指定位置元素的删除操作 - <strong>-erase</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> a[] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(a, a + <span class="keyword">sizeof</span>(a) / <span class="keyword">sizeof</span>(<span class="type">int</span>))</span></span>;</span><br><span class="line">	<span class="comment">// 使用find查找3所在位置的iterator</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::iterator pos = <span class="built_in">find</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">3</span>);</span><br><span class="line">	<span class="comment">// 删除pos位置的数据，导致pos迭代器失效。</span></span><br><span class="line">	v.<span class="built_in">erase</span>(pos);</span><br><span class="line">	cout &lt;&lt; *pos &lt;&lt; endl; <span class="comment">// 此处会导致非法访问</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>erase 删除 pos 位置元素后， pos 位置之后的元素会往前搬移，没有导致底层空间的改变，理论上讲迭代 器不应该会失效，但是：如果pos 刚好是最后一个元素，删完之后 pos 刚好是 end 的位置，而 end 位置是 没有元素的，那么pos 就失效了。因此删除 vector 中任意位置上元素时， vs 就认为该位置迭代器失效 了。</p><p>以下代码的功能是删除 vector 中所有的偶数，请问那个代码是正确的，为什么？</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> a[] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(a, a + <span class="keyword">sizeof</span>(a) / <span class="keyword">sizeof</span>(<span class="type">int</span>))</span></span>;</span><br><span class="line">	<span class="comment">// 使用find查找3所在位置的iterator</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::iterator pos = <span class="built_in">find</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">3</span>);</span><br><span class="line">	<span class="comment">// 删除pos位置的数据，导致pos迭代器失效。</span></span><br><span class="line">	v.<span class="built_in">erase</span>(pos);</span><br><span class="line">	cout &lt;&lt; *pos &lt;&lt; endl; <span class="comment">// 此处会导致非法访问</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">			v.<span class="built_in">erase</span>(it);</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">			it = v.<span class="built_in">erase</span>(it);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3. 注意： Linux 下， g++ 编译器对迭代器失效的检测并不是非常严格，处理也没有 vs 下极端。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">			v.<span class="built_in">erase</span>(it);</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">			it = v.<span class="built_in">erase</span>(it);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">// 1. 扩容之后，迭代器已经失效了，程序虽然可以运行，但是运行结果已经不对了</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); ++i)</span><br><span class="line">		cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;扩容之前，vector的容量为: &quot;</span> &lt;&lt; v.<span class="built_in">capacity</span>() &lt;&lt; endl;</span><br><span class="line">	<span class="comment">// 通过reserve将底层空间设置为100，目的是为了让vector的迭代器失效 </span></span><br><span class="line">	v.<span class="built_in">reserve</span>(<span class="number">100</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;扩容之后，vector的容量为: &quot;</span> &lt;&lt; v.<span class="built_in">capacity</span>() &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 经过上述reserve之后，it迭代器肯定会失效，在vs下程序就直接崩溃了，但是linux下不会</span></span><br><span class="line">	<span class="comment">// 虽然可能运行，但是输出的结果是不对的</span></span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">程序输出：</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line">扩容之前，vector的容量为: <span class="number">5</span></span><br><span class="line">扩容之后，vector的容量为 : <span class="number">100</span></span><br><span class="line"><span class="number">0</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">409</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="comment">// 2. erase删除任意位置代码后，linux下迭代器并没有失效</span></span><br><span class="line"><span class="comment">// 因为空间还是原来的空间，后序元素往前搬移了，it的位置还是有效的</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span> &#125;;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::iterator it = <span class="built_in">find</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">3</span>);</span><br><span class="line">	v.<span class="built_in">erase</span>(it)</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">程序可以正常运行，并打印：</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">4</span> <span class="number">5</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 3: erase删除的迭代器如果是最后一个元素，删除之后it已经超过end</span></span><br><span class="line"><span class="comment">// 此时迭代器是无效的，++it导致程序崩溃</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span> &#125;;</span><br><span class="line">	<span class="comment">// vector&lt;int&gt; v&#123;1,2,3,4,5,6&#125;;</span></span><br><span class="line">	<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">			v.<span class="built_in">erase</span>(it);</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v)</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">========================================================</span><br><span class="line"><span class="comment">// 使用第一组数据时，程序可以运行</span></span><br><span class="line">[sly@VM - <span class="number">0</span> - <span class="number">3</span> - centos <span class="number">20220114</span>]$ g++ testVector.cpp - std = c++<span class="number">11</span></span><br><span class="line">[sly@VM - <span class="number">0</span> - <span class="number">3</span> - centos <span class="number">20220114</span>]$ . / a.out</span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">5</span></span><br><span class="line">======================================================== =</span><br><span class="line"><span class="comment">// 使用第二组数据时，程序最终会崩溃</span></span><br><span class="line">[sly@VM - <span class="number">0</span> - <span class="number">3</span> - centos <span class="number">20220114</span>]$ vim testVector.cpp</span><br><span class="line">[sly@VM - <span class="number">0</span> - <span class="number">3</span> - centos <span class="number">20220114</span>]$ g++ testVector.cpp - std = c++<span class="number">11</span></span><br><span class="line">[sly@VM - <span class="number">0</span> - <span class="number">3</span> - centos <span class="number">20220114</span>]$ . / a.out</span><br><span class="line">Segmentation fault</span><br></pre></td></tr></table></figure><p>从上述三个例子中可以看到： SGI STL 中，迭代器失效后，代码并不一定会崩溃，但是运行结果肯定不 对，如果it 不在 begin 和 end 范围内，肯定会崩溃的。</p><p>4. 与 vector 类似， string 在插入 + 扩容操作 +erase 之后，迭代器也会失效</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestString</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">s</span><span class="params">(<span class="string">&quot;hello&quot;</span>)</span></span>;</span><br><span class="line">	<span class="keyword">auto</span> it = s.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="comment">// 放开之后代码会崩溃，因为resize到20会string会进行扩容</span></span><br><span class="line">	<span class="comment">// 扩容之后，it指向之前旧空间已经被释放了，该迭代器就失效了</span></span><br><span class="line">	<span class="comment">// 后序打印时，再访问it指向的空间程序就会崩溃</span></span><br><span class="line">	<span class="comment">//s.resize(20, &#x27;!&#x27;);</span></span><br><span class="line">	<span class="keyword">while</span> (it != s.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *it;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	it = s.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">while</span> (it != s.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		it = s.<span class="built_in">erase</span>(it);</span><br><span class="line">		<span class="comment">// 按照下面方式写，运行时程序会崩溃，因为erase(it)之后</span></span><br><span class="line">		<span class="comment">// it位置的迭代器就失效了</span></span><br><span class="line">		<span class="comment">// s.erase(it); </span></span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>迭代器失效解决办法：在使用前，对迭代器重新赋值即可.</strong></p><h3 id="2vector深度剖析及模拟实现"><a class="markdownIt-Anchor" href="#2vector深度剖析及模拟实现"></a> <strong>2.vector深度剖析及模拟实现</strong></h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2f0031157f99468a85d8510ac29a9fb1.png" alt=""></p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="b8fd489cf5594828bd33428935b0e4bb.png" alt=""></p><h4 id="21-stdvector的核心框架接口的模拟实现xylvector"><a class="markdownIt-Anchor" href="#21-stdvector的核心框架接口的模拟实现xylvector"></a> <strong>2.1 std::vector的核心框架接口的模拟实现xyl::vector</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> xyl</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">class</span> <span class="title class_">vector</span>                                                                                                                                                                                                                     </span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		<span class="keyword">typedef</span> T* iterator;</span><br><span class="line">			<span class="keyword">typedef</span> <span class="type">const</span> T* const_iterator;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">		<span class="built_in">vector</span>()</span><br><span class="line">			:_start(<span class="literal">nullptr</span>)</span><br><span class="line">			, _finish ( <span class="literal">nullptr</span>)</span><br><span class="line">			, _endOfStorage (<span class="literal">nullptr</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="built_in">vector</span>(<span class="type">int</span> n, <span class="type">const</span> T&amp; value = <span class="built_in">T</span>())</span><br><span class="line">             :_start(<span class="literal">nullptr</span>)</span><br><span class="line">             , _finish ( <span class="literal">nullptr</span>)</span><br><span class="line">             , _endOfStorage (<span class="literal">nullptr</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">resize</span>(n, value);</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> InputIterator&gt;</span></span><br><span class="line"><span class="function">		<span class="title">vector</span><span class="params">(InputIterator first, InputIterator last)</span></span></span><br><span class="line"><span class="function">            :_start(nullptr)</span></span><br><span class="line"><span class="function">            , _finish ( nullptr)</span></span><br><span class="line"><span class="function">            , _endOfStorage (nullptr)</span></span><br><span class="line"><span class="function">		&#123;</span></span><br><span class="line">			</span><br><span class="line">			<span class="type">size_t</span>  sz = last-first;</span><br><span class="line">			T* tmp = <span class="keyword">new</span> T[sz];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>;i &lt; sz;i++)</span><br><span class="line">			&#123;</span><br><span class="line">				tmp[i] = first[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//memcpy(tmp, first, sizeof(T) * (sz));</span></span><br><span class="line">			_start = tmp;</span><br><span class="line">			_finish = _start + sz;</span><br><span class="line">			_endOfStorage = _finish;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">vector</span>( vector&lt;T&gt;&amp; v)</span><br><span class="line">			:_start(<span class="literal">nullptr</span>)</span><br><span class="line">			, _finish(<span class="literal">nullptr</span>)</span><br><span class="line">			, _endOfStorage(<span class="literal">nullptr</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">size_t</span> sz= v.<span class="built_in">size</span>();</span><br><span class="line">			<span class="type">size_t</span> cp = v.<span class="built_in">capacity</span>();</span><br><span class="line">			_start = <span class="keyword">new</span> T[cp];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>;i &lt; sz;i++)</span><br><span class="line">			&#123;</span><br><span class="line">				_start[i] = v._start[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//memcpy(tmp, v._start, sizeof(T) * (sz));</span></span><br><span class="line">			</span><br><span class="line">			_finish = _start + sz;</span><br><span class="line">			_endOfStorage = _start+ cp;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		vector&lt;T&gt;&amp; <span class="keyword">operator</span>= (vector&lt;T&gt; v)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">/*size_t sz = v.size();</span></span><br><span class="line"><span class="comment">			size_t cp = v.capacity();</span></span><br><span class="line"><span class="comment">			T* tmp = new T[cp];</span></span><br><span class="line"><span class="comment">			memcpy(tmp, v._start, sizeof(T) * (sz));</span></span><br><span class="line"><span class="comment">			_start = tmp;</span></span><br><span class="line"><span class="comment">			_finish = _start + sz;</span></span><br><span class="line"><span class="comment">			_endOfStorage = _start + cp;*/</span></span><br><span class="line">			<span class="built_in">swap</span>(v);</span><br><span class="line"> </span><br><span class="line">			<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">reserve</span><span class="params">(<span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">if</span> (n &gt;= <span class="built_in">capacity</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="type">size_t</span> sz = <span class="built_in">size</span>();</span><br><span class="line">				T* tmp = <span class="keyword">new</span> T[n];</span><br><span class="line">				<span class="keyword">if</span> (_start)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="type">size_t</span> i=<span class="number">0</span>;i &lt; sz;i++)</span><br><span class="line">					&#123;</span><br><span class="line">						tmp[i] = _start[i];</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="comment">//memcpy(tmp, _start, sizeof(T)*sz);</span></span><br><span class="line">					<span class="keyword">delete</span>[]_start;</span><br><span class="line">				&#125;</span><br><span class="line">				_start = tmp;</span><br><span class="line">				_finish = _start + sz;</span><br><span class="line">				_endOfStorage = _start + n;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">resize</span><span class="params">(<span class="type">size_t</span> n, <span class="type">const</span> T&amp; value = T())</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/*	for (size_t i = 0;i &lt; n;i++)</span></span><br><span class="line"><span class="comment">			&#123;</span></span><br><span class="line"><span class="comment">				push_back(value);</span></span><br><span class="line"><span class="comment">			&#125;*/</span></span><br><span class="line">			<span class="keyword">if</span> (n &lt; <span class="built_in">size</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				_finish = _start + n;			</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">reserve</span>(n);</span><br><span class="line">				<span class="keyword">while</span> (_finish != _start + n)</span><br><span class="line">				&#123;</span><br><span class="line">					*_finish = value;</span><br><span class="line">					_finish++;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">push_back</span><span class="params">(<span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">if</span> (_finish == _endOfStorage)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="type">size_t</span> newcapacity =<span class="built_in">capacity</span>()== <span class="number">0</span> ? <span class="number">4</span> : <span class="built_in">capacity</span>() * <span class="number">2</span>;</span><br><span class="line">				<span class="built_in">reserve</span>(newcapacity);</span><br><span class="line">			&#125;</span><br><span class="line">			*_finish = x;</span><br><span class="line">			_finish++;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">pop_back</span><span class="params">()</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="built_in">assert</span>(<span class="built_in">size</span>());</span><br><span class="line">			<span class="comment">//_finish -= 1;</span></span><br><span class="line">			<span class="built_in">erase</span>(<span class="built_in">end</span>()<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(vector&lt;T&gt;&amp; v)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			</span><br><span class="line">			std::<span class="built_in">swap</span>(_start, v._start);</span><br><span class="line">			std::<span class="built_in">swap</span>(_finish, v._finish);</span><br><span class="line">			std::<span class="built_in">swap</span>(_endOfStorage, v._endOfStorage);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">iterator <span class="title">insert</span><span class="params">(iterator pos, <span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="built_in">assert</span>(pos &gt;= _start &amp;&amp; pos &lt;= _finish);</span><br><span class="line">			<span class="keyword">if</span> (_finish==_endOfStorage)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="type">size_t</span> len = pos-_start;</span><br><span class="line">				<span class="type">size_t</span> newcapacity = <span class="built_in">capacity</span>() == <span class="number">0</span> ? <span class="number">4</span> : <span class="built_in">capacity</span>() * <span class="number">2</span>;</span><br><span class="line">				<span class="built_in">reserve</span>(newcapacity);</span><br><span class="line">				pos = _start + len;</span><br><span class="line">			&#125;</span><br><span class="line">			iterator end = _finish - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">while</span> (end &gt;= pos)</span><br><span class="line">			&#123;</span><br><span class="line">				*(end + <span class="number">1</span>) = *end;</span><br><span class="line">				end--;</span><br><span class="line">			&#125;</span><br><span class="line">			*pos = x;</span><br><span class="line">			++_finish;</span><br><span class="line">			<span class="keyword">return</span> pos;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function">iterator <span class="title">erase</span><span class="params">(iterator pos)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="built_in">assert</span>(pos &gt;= _start &amp;&amp; pos &lt;= _finish);</span><br><span class="line">			iterator p1 = pos;</span><br><span class="line">			iterator end = _finish - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">while</span> (p1&lt;end )</span><br><span class="line">			&#123;</span><br><span class="line">				*p1 = *(p1+<span class="number">1</span>);</span><br><span class="line">			     p1++;</span><br><span class="line">			&#125;</span><br><span class="line">			_finish--;</span><br><span class="line">			<span class="keyword">return</span> pos;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function"><span class="type">size_t</span> <span class="title">capacity</span><span class="params">()</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _endOfStorage - _start;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function"><span class="type">size_t</span> <span class="title">size</span><span class="params">()</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _finish - _start;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function">iterator <span class="title">begin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _start;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function">iterator <span class="title">end</span><span class="params">()</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _finish;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _start;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _finish;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">const_iterator <span class="title">cbegin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _start;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="function">const_iterator <span class="title">cend</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _finish;</span><br><span class="line">		&#125;</span><br><span class="line">		T&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> _start[pos];</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="type">const</span> T&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos)<span class="type">const</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> _start[pos];</span><br><span class="line">		&#125;</span><br><span class="line">		~<span class="built_in">vector</span>()</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (_start)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">delete</span>[]_start;</span><br><span class="line">				_start = _finish = _endOfStorage = <span class="literal">nullptr</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">private</span>:</span><br><span class="line">		iterator _start; <span class="comment">// 指向数据块的开始</span></span><br><span class="line"> </span><br><span class="line">		iterator _finish; <span class="comment">// 指向有效数据的尾</span></span><br><span class="line"> </span><br><span class="line">		iterator _endOfStorage;<span class="comment">// 指向存储容量的尾</span></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line">```                                                                                                                                                                                                               &#123;<span class="keyword">public</span>:<span class="keyword">typedef</span> T* iterator;<span class="keyword">typedef</span> <span class="type">const</span> T* const_iterator;<span class="built_in">vector</span>():_start(<span class="literal">nullptr</span>), _finish ( <span class="literal">nullptr</span>), _endOfStorage (<span class="literal">nullptr</span>)&#123;&#125;<span class="built_in">vector</span>(<span class="type">int</span> n, <span class="type">const</span> T&amp; value = <span class="built_in">T</span>())             :_start(<span class="literal">nullptr</span>)             , _finish ( <span class="literal">nullptr</span>)             , _endOfStorage (<span class="literal">nullptr</span>)&#123;<span class="built_in">resize</span>(n, value);&#125;<span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;<span class="built_in">vector</span>(InputIterator first, InputIterator last)            :_start(<span class="literal">nullptr</span>)            , _finish ( <span class="literal">nullptr</span>)            , _endOfStorage (<span class="literal">nullptr</span>)&#123;<span class="type">size_t</span>  sz = last-first;T* tmp = <span class="keyword">new</span> T[sz];<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>;i &lt; sz;i++)&#123;tmp[i] = first[i];&#125;_start = tmp;_finish = _start + sz;_endOfStorage = _finish;&#125;<span class="built_in">vector</span>( vector&lt;T&gt;&amp; v):_start(<span class="literal">nullptr</span>), _finish(<span class="literal">nullptr</span>), _endOfStorage(<span class="literal">nullptr</span>)&#123;<span class="type">size_t</span> sz= v.<span class="built_in">size</span>();<span class="type">size_t</span> cp = v.<span class="built_in">capacity</span>();_start = <span class="keyword">new</span> T[cp];<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>;i &lt; sz;i++)&#123;_start[i] = v._start[i];&#125;_finish = _start + sz;_endOfStorage = _start+ cp;&#125;vector&lt;T&gt;&amp; <span class="keyword">operator</span>= (vector&lt;T&gt; v)&#123;<span class="built_in">swap</span>(v);<span class="keyword">return</span> *<span class="keyword">this</span>;&#125;<span class="function"><span class="type">void</span> <span class="title">reserve</span><span class="params">(<span class="type">size_t</span> n)</span></span>&#123;<span class="keyword">if</span> (n &gt;= <span class="built_in">capacity</span>())&#123;<span class="type">size_t</span> sz = <span class="built_in">size</span>();T* tmp = <span class="keyword">new</span> T[n];<span class="keyword">if</span> (_start)&#123;<span class="keyword">for</span> (<span class="type">size_t</span> i=<span class="number">0</span>;i &lt; sz;i++)&#123;tmp[i] = _start[i];&#125;<span class="keyword">delete</span>[]_start;&#125;_start = tmp;_finish = _start + sz;_endOfStorage = _start + n;&#125;&#125;<span class="function"><span class="type">void</span> <span class="title">resize</span><span class="params">(<span class="type">size_t</span> n, <span class="type">const</span> T&amp; value = T())</span></span>&#123;<span class="keyword">if</span> (n &lt; <span class="built_in">size</span>())&#123;_finish = _start + n;&#125;<span class="keyword">else</span>&#123;<span class="built_in">reserve</span>(n);<span class="keyword">while</span> (_finish != _start + n)&#123;*_finish = value;_finish++;&#125;&#125;&#125;<span class="function"><span class="type">void</span> <span class="title">push_back</span><span class="params">(<span class="type">const</span> T&amp; x)</span></span>&#123;<span class="keyword">if</span> (_finish == _endOfStorage)&#123;<span class="type">size_t</span> newcapacity =<span class="built_in">capacity</span>()== <span class="number">0</span> ? <span class="number">4</span> : <span class="built_in">capacity</span>() * <span class="number">2</span>;<span class="built_in">reserve</span>(newcapacity);&#125;*_finish = x;_finish++;&#125;<span class="function"><span class="type">void</span> <span class="title">pop_back</span><span class="params">()</span></span>&#123;<span class="built_in">assert</span>(<span class="built_in">size</span>());<span class="built_in">erase</span>(<span class="built_in">end</span>()<span class="number">-1</span>);&#125;<span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(vector&lt;T&gt;&amp; v)</span></span>&#123;std::<span class="built_in">swap</span>(_start, v._start);std::<span class="built_in">swap</span>(_finish, v._finish);std::<span class="built_in">swap</span>(_endOfStorage, v._endOfStorage);&#125;<span class="function">iterator <span class="title">insert</span><span class="params">(iterator pos, <span class="type">const</span> T&amp; x)</span></span>&#123;<span class="built_in">assert</span>(pos &gt;= _start &amp;&amp; pos &lt;= _finish);<span class="keyword">if</span> (_finish==_endOfStorage)&#123;<span class="type">size_t</span> len = pos-_start;<span class="type">size_t</span> newcapacity = <span class="built_in">capacity</span>() == <span class="number">0</span> ? <span class="number">4</span> : <span class="built_in">capacity</span>() * <span class="number">2</span>;<span class="built_in">reserve</span>(newcapacity);pos = _start + len;&#125;iterator end = _finish - <span class="number">1</span>;<span class="keyword">while</span> (end &gt;= pos)&#123;*(end + <span class="number">1</span>) = *end;end--;&#125;*pos = x;++_finish;<span class="keyword">return</span> pos;&#125;<span class="function">iterator <span class="title">erase</span><span class="params">(iterator pos)</span></span>&#123;<span class="built_in">assert</span>(pos &gt;= _start &amp;&amp; pos &lt;= _finish);iterator p1 = pos;iterator end = _finish - <span class="number">1</span>;<span class="keyword">while</span> (p1&lt;end )&#123;*p1 = *(p1+<span class="number">1</span>);     p1++;&#125;_finish--;<span class="keyword">return</span> pos;&#125;<span class="function"><span class="type">size_t</span> <span class="title">capacity</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> _endOfStorage - _start;&#125;<span class="function"><span class="type">size_t</span> <span class="title">size</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> _finish - _start;&#125;<span class="function">iterator <span class="title">begin</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> _start;&#125;<span class="function">iterator <span class="title">end</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> _finish;&#125;<span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span>&#123;<span class="keyword">return</span> _start;&#125;<span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span>&#123;<span class="keyword">return</span> _finish;&#125;<span class="function">const_iterator <span class="title">cbegin</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> _start;&#125;<span class="function">const_iterator <span class="title">cend</span><span class="params">()</span> <span class="type">const</span></span>&#123;<span class="keyword">return</span> _finish;&#125;T&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos)&#123;<span class="keyword">return</span> _start[pos];&#125;<span class="type">const</span> T&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos)<span class="type">const</span>&#123;<span class="keyword">return</span> _start[pos];&#125;~<span class="built_in">vector</span>()&#123;<span class="keyword">if</span> (_start)&#123;<span class="keyword">delete</span>[]_start;_start = _finish = _endOfStorage = <span class="literal">nullptr</span>;&#125;&#125;<span class="keyword">private</span>:iterator _start; iterator _finish; iterator _endOfStorage;&#125;;&#125;</span><br><span class="line"></span><br><span class="line">测试部分</span><br><span class="line"></span><br><span class="line">```c++</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="comment">//#include&lt;vector&gt;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;vector.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_vector1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">6</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">7</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="function">xyl::vector&lt;<span class="type">int</span>&gt; <span class="title">v2</span><span class="params">(<span class="number">5</span>,<span class="number">100</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v2)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="function">xyl::vector&lt;<span class="type">int</span>&gt; <span class="title">v3</span><span class="params">(v1.begin(), v1.end())</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v3)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">xyl::vector&lt;<span class="type">int</span>&gt; <span class="title">v4</span><span class="params">(v3)</span></span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v4)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v5;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	v5 = v4;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v5)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; v5.<span class="built_in">size</span>();i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; v5[i]&lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_vector2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">100</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	v1.<span class="built_in">pop_back</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v2;</span><br><span class="line">	v1.<span class="built_in">swap</span>(v2);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v2)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v3;</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">500</span>);</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v3.<span class="built_in">push_back</span>(<span class="number">100</span>);</span><br><span class="line">	v3.<span class="built_in">insert</span>(v3.<span class="built_in">begin</span>()+<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v3)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	v3.<span class="built_in">erase</span>(v3.<span class="built_in">begin</span>() + <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v3)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_vector3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="number">100</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	v1.<span class="built_in">erase</span>(v1.<span class="built_in">end</span>());</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_vector4</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	xyl::vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">	v1.<span class="built_in">resize</span>(<span class="number">10</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_vector5</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	xyl::vector&lt;string&gt; v1;</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="string">&quot;1111111111&quot;</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="string">&quot;2222222222&quot;</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="string">&quot;3333333333&quot;</span>);</span><br><span class="line">	v1.<span class="built_in">push_back</span>(<span class="string">&quot;4444444444&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="function">xyl::vector&lt;string&gt; <span class="title">v2</span><span class="params">(v1)</span></span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v2)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"> </span><br><span class="line">	<span class="function">xyl::vector&lt;string&gt; <span class="title">v3</span><span class="params">(v1.begin(),v1.end())</span></span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> e : v3)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; e &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">test_vector5</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="22-使用memcpy拷贝问题"><a class="markdownIt-Anchor" href="#22-使用memcpy拷贝问题"></a> <strong>2.2 使用memcpy拷贝问题</strong></h4><p>假设模拟实现的 vector 中的 reserve 接口中，使用 memcpy 进行的拷贝，以下代码会发生什么问题？</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	xyl::vector&lt;bite::string&gt; v;</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="string">&quot;1111&quot;</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="string">&quot;2222&quot;</span>);</span><br><span class="line">	v.<span class="built_in">push_back</span>(<span class="string">&quot;3333&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>问题分析：</p><p>1. memcpy 是内存的二进制格式拷贝，将一段内存空间中内容原封不动的拷贝到另外一段内存空间中</p><p>2. 如果拷贝的是内置类型的元素， memcpy 既高效又不会出错，但如果拷贝的是自定义类型元素，并且自 定义类型元素中涉及到资源管理时，就会出错，因为memcpy 的拷贝实际是浅拷贝。</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="091a8942ed5c4ee3a69cfb4b4b0981d5.png" alt=""></p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="175c274e50c84df2b22592c9b7eae7b4.png" alt=""></p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="a99f92f72724463380dba1c662b0ee19.png" alt=""></p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="c1be6cf7e940478e95e15d381969e655.png" alt=""></p><p><strong>结论：如果对象中涉及到资源管理时，千万不能使用</strong> <strong>memcpy</strong> <strong>进行对象之间的拷贝，因为</strong> <strong>memcpy</strong> <strong>是</strong> <strong>浅拷贝，否则可能会引起内存泄漏甚至程序崩溃。</strong></p><h4 id="23动态二维数组理解"><a class="markdownIt-Anchor" href="#23动态二维数组理解"></a> <strong>2.3****动态二维数组理解</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以杨辉三角的前n行为例：假设n为5</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test2vector</span><span class="params">(<span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 使用vector定义二维数组vv，vv中的每个元素都是vector&lt;int&gt;</span></span><br><span class="line">	bit::vector&lt;bit::vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">vv</span>(n);</span><br><span class="line"> </span><br><span class="line">	<span class="comment">// 将二维数组每一行中的vecotr&lt;int&gt;中的元素全部设置为1</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">		vv[i].<span class="built_in">resize</span>(i + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="comment">// 给杨辉三角出第一列和对角线的所有元素赋值</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; n; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; i; ++j)</span><br><span class="line">		&#123;</span><br><span class="line">			vv[i][j] = vv[i - <span class="number">1</span>][j] + vv[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>bit::vector&lt;bit::vector<int>&gt; vv(n) ; 构造一个 vv 动态二维数组， vv 中总共有 n 个元素，每个元素都是 vector 类 型的，每行没有包含任何元素，如果n 为 5 时如下所示：</int></p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="a0962ce3b9ec42bbb8af339c2a2975f1.png" alt=""></p><p>vv 中元素填充完成之后，如下图所示：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="f0a42ccf85c44c6d9e764aabde640d2d.png" alt=""></p><p>使用标准库中 vector 构建动态二维数组时与上图实际是一致的</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc">formeasy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc/2025/07/11/C/vector%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%A7%A3/">http://www.formeasy.cc/2025/07/11/C/vector的详细讲解/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://www.formeasy.cc" target="_blank">易锦风的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C</a></div><div class="post-share"><div class="social-share" data-image="/2025/07/11/C/vector%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%A7%A3/53d1d2e536204e609dc694bcb054ce9c.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/11/Ubuntu/%E3%80%90ubuntu%E3%80%91%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8%E6%83%85%E5%86%B5%EF%BC%8C%E4%BB%A5%E5%8F%8A%E7%B3%BB%E7%BB%9F%E8%AF%A6%E6%83%85/" title="【ubuntu】查看端口占用情况，以及系统详情"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">【ubuntu】查看端口占用情况，以及系统详情</div></div><div class="info-2"><div class="info-item-1">一、ubuntu 查看端口占用情况 在Ubuntu 系统中，你可以使用以下几种方法来查看端口占用情况以及检查指定端口是否被占用： 方法 1：使用 netstat 命令（传统方式） 12345# 查看所有端口占用情况sudo netstat -tulnp# 查看指定端口是否被占用（例如检查 80, 443, 3306 端口）sudo netstat -tulnp | grep -E &#x27;:(80|443|3306)\s&#x27; 选项说明： -t：显示 TCP 端口 -u：显示 UDP 端口 -l：仅显示监听中的端口 -n：以数字形式显示地址和端口 -p：显示进程信息 方法 2：使用 ss 命令（更现代的替代方案） 12345# 查看所有端口占用情况sudo ss -tulnp# 检查指定端口是否被占用（例如 80, 443, 3306）sudo ss -tulnp | grep -E &#x27;:(80|443|3306)\s&#x27; ss 命令比 netstat 更快，是推荐的现代替代方案。 方法 3：使用 lsof 命令 12345#...</div></div></div></a><a class="pagination-related" href="/2025/07/10/algo/%E3%80%90%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E3%80%91%E5%86%B3%E7%AD%96%E6%A0%91%EF%BC%88Decision%20Tree%EF%BC%89/" title="【机器学习】决策树（Decision Tree）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/10/algo/%E3%80%90%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E3%80%91%E5%86%B3%E7%AD%96%E6%A0%91%EF%BC%88Decision%20Tree%EF%BC%89/797984871ce756bea69a8e3cbcde1c5d.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">【机器学习】决策树（Decision Tree）</div></div><div class="info-2"><div class="info-item-1">引入 决策树是一类预测模型，它代表的是对象属性与对象值之间的一种映射关系。树中每个节点表示某个对象，而每个分叉路径则代表某个可能的属性值，而每个叶节点则对应从根节点到该叶节点所经历的路径所表示的对象的值。 关于分类问题 这里主要考虑决策树基于分类问题的处理算法，分类问题和回归问题有个简单的判别方式：分类的目标属性是离散的，而回归的目标属性是连续的。 分类问题的步骤 1、模型构建：通过对训练集合的归纳，利用归纳算法生成可读的规则，建立分类模型。 2、预测推论：根据规则和建立的分类模型，对测试集合进行测试，并处理新的数据。 ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/10/C/C++%E4%B9%8B%E7%BA%A2%E9%BB%91%E6%A0%91%E8%AE%A4%E8%AF%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="C++之红黑树认识与实现"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/10/C/C++%E4%B9%8B%E7%BA%A2%E9%BB%91%E6%A0%91%E8%AE%A4%E8%AF%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/d6e48fbd9ca54c63aa684f0bcbe9ccf5.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-10</div><div class="info-item-2">C++之红黑树认识与实现</div></div><div class="info-2"><div class="info-item-1">一.红黑树的概念 红⿊树是⼀棵⼆叉搜索树，他的每个结点增加⼀个存储位来表⽰结点的颜⾊，可以是红⾊或者⿊⾊。通过对任何⼀条从根到叶⼦的路径上各个结点的颜⾊进⾏约束，红⿊树确保没有⼀条路径会⽐其他路径⻓出2倍，因⽽是接近平衡的。 红黑树的结构 123456789101112131415161718192021222324252627282930313233343536// 枚举值表⽰颜⾊ enum Colour&#123; RED, BLACK&#125;;template&lt;class K, class V&gt;struct RBTreeNode&#123; // 这⾥更新控制平衡也要加⼊parent指针 pair&lt;K, V&gt; _kv; RBTreeNode&lt;K, V&gt;* _left; RBTreeNode&lt;K, V&gt;* _right; RBTreeNode&lt;K, V&gt;* _parent; Colour _col; RBTreeNode(const pair&lt;K, V&gt;&amp; kv) :_kv(kv) ,...</div></div></div></a><a class="pagination-related" href="/2025/01/23/C/c++%E4%B9%8B%E7%BB%84%E5%90%88%E3%80%81%E7%BB%A7%E6%89%BF%E3%80%81%E8%81%9A%E5%90%88%E5%8F%8A%E4%BE%9D%E8%B5%96/" title="c++之组合、继承、聚合及依赖"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-23</div><div class="info-item-2">c++之组合、继承、聚合及依赖</div></div><div class="info-2"><div class="info-item-1">在学习c++的过程中相信大家对这几个概念都不陌生。 c++中一些常用的设计模式都是由这几种特性组合而成。本文再从整体对这个概念或者特性进行简要的介绍。 组合 c++中类之间的一种关系叫做&quot;has-a&quot;的关系。这种关系表示的是一个类中包含另一类的对象，体现了“有一个”的关系。这个被包含的类一般以实例对象的形式存在，而非指针对象的形式存在。请看下面的示例: 12345678910111213141516171819class Engine&#123;	public: void start() &#123; cout&lt;&lt;&quot;引擎启动&quot;&lt;&lt;endl; &#125;&#125;class car&#123;private:	Engine engine; //这里以实例的形式存在，而非指针，在类关系中是组合的关系public:	void startCar()	&#123; engine.start(); //启动引擎	&#125;&#125; ...</div></div></div></a><a class="pagination-related" href="/2025/07/10/C/C++%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%81/" title="C++动态分配内存知识点！"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-10</div><div class="info-item-2">C++动态分配内存知识点！</div></div><div class="info-2"><div class="info-item-1">1.动态分配内存的思想 动态分配内存是指在程序运行时根据需要动态地分配内存空间。这相对于静态分配内存来说，静态分配内存是在编译时固定地分配内存空间，而动态分配内存可以在程序运行期间根据实际需求进行内存的申请和释放，以提高内存的利用率和灵活性。 2.动态分配内存的概念 动态分配内存的概念包括以下几个方面： 2.1内存分配函数 动态分配内存需要使用内存分配函数，如C语言中的malloc()、calloc()、realloc()等，这些函数可以根据需要在运行时动态地分配一块连续的内存空间。 2.2动态内存的申请和释放 使用内存分配函数可以申请一块指定大小的内存空间，申请的内存空间可以在程序运行期间使用。使用完毕后，可以使用释放函数将内存空间释放，以便其他程序继续使用。 2.3内存碎片问题 动态分配内存可能会导致内存碎片问题。当频繁地进行内存分配和释放操作时，可能会在内存中留下一些未被使用的小块内存，这些小块内存无法被再次利用，导致内存的浪费。为了解决内存碎片问题，可以使用内存管理算法来进行内存的分配和释放操作。 ...</div></div></div></a><a class="pagination-related" href="/2025/07/11/C/C++11%20%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3%EF%BC%9Astdcopy_if%20%E4%B8%8E%20stdcopy_n/" title="C++11 算法详解：std::copy_if 与 std::copy_n"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-11</div><div class="info-item-2">C++11 算法详解：std::copy_if 与 std::copy_n</div></div><div class="info-2"><div class="info-item-1">引言 C++11 标准为算法库带来了诸多增强，其中 std::copy_if 和 std::copy_n 作为 std::copy 的补充，为元素复制操作提供了更精细的控制。这两个算法不仅简化了代码逻辑，还提升了可读性和性能。本文将深入探讨这两个算法的实现细节、使用场景及最佳实践，帮助开发者在实际项目中正确高效地应用它们。 std::copy_if：条件筛选复制 函数原型 12template&lt; class InputIt, class OutputIt, class UnaryPred &gt;OutputIt copy_if( InputIt first, InputIt last, OutputIt d_first, UnaryPred pred ); 核心功能 std::copy_if 从输入范围 [first, last) 中复制满足谓词 pred 的元素到目标范围（始于 d_first），并保持元素的相对顺序。该算法在 C++11 中引入，是对传统 std::copy 的条件化扩展。 ...</div></div></div></a><a class="pagination-related" href="/2025/07/21/C/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F/" title="内存管理基础：数据结构的存储方式"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/21/C/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F/6dbd55eda53d6550a09ffc9da8295446.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-21</div><div class="info-item-2">内存管理基础：数据结构的存储方式</div></div><div class="info-2"><div class="info-item-1">内存管理基础：数据结构的存储方式 想象一下你正在整理你的衣柜。有些衣服你会折叠整齐地放在抽屉里（连续存储），有些则挂在衣架上分散在衣柜各处（链式存储。计算机内存管理数据的方式其实和这个场景非常相似。今天，我们就来探讨一下数据结构在内存中的不同存储方式，以及它们各自的优缺点。 1. 连续存储结构 理解了衣柜的比喻后，我们来看看计算机中最基础的存储方式——连续存储。这种存储方式就像把衣服一件件紧密地叠放在抽屉里，每件衣服占据固定大小的空间，并且按照顺序排列。 1.1 数组的存储方式 数组是最典型的连续存储结构。让我们通过一个简单的例子来看看数组在内存中是如何存储的： 1int arr[5] = &#123;10, 20, 30, 40, 50&#125;; 上述代码定义了一个包含5个整数的数组。在内存中，这些元素会被连续地存储在一起。 以上流程图说明了数组在内存中的连续存储方式，每个元素占据4字节空间 1.2...</div></div></div></a><a class="pagination-related" href="/2025/04/30/RPC/GRPC%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" title="GRPC 快速入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-30</div><div class="info-item-2">GRPC 快速入门</div></div><div class="info-2"><div class="info-item-1">1. 背景介绍 gRPC全称Google Remote Procedure Call. 它是一种基于Protobuf buffer 格式的高效的通讯协议。与许多 RPC 系统一样，gRPC 基于定义服务的理念，指定可以远程调用的方法及其参数和返回类型。在服务器端，服务器实现此接口并运行 gRPC 服务器以处理客户端调用。在客户端，客户端具有一个存根（在某些语言中称为客户端），它提供与服务器相同的 方法。 2. 快速入门 安装 cmake 您需要 cmake 的 3.13 版或更高版本。请按照以下说明进行安装 Linux 1sudo apt install -y cmake macOS 1brew install cmake 安装其他必需工具 Linux 1sudo apt install -y build-essential autoconf libtool pkg-config macOS 1brew install autoconf automake libtool pkg-config 克隆 grpc 仓库 设置安装路径 123export...</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">formeasy</div><div class="author-info-description">专注互联网和软件技术</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">247</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/formeasy"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/formeasy" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:formeasy@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">用学习，面对遭遇的变化；用斗志，面对每天的挫折；用坚持，面对失去的动力!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1vector%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%BD%BF%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">1.vector的介绍及使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-vector%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 vector的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-vector%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 vector的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#121-vector%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 vector的定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#122-vector-iterator%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 vector iterator的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#123-vector-%E7%A9%BA%E9%97%B4%E5%A2%9E%E9%95%BF%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.2.3 vector 空间增长问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#124-vector-%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9"><span class="toc-number">1.2.4.</span> <span class="toc-text">1.2.4 vector 增删查改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#125-vector-%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98-%E9%87%8D%E7%82%B9"><span class="toc-number">1.2.5.</span> <span class="toc-text">1.2.5 vector 迭代器失效问题。（重点）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2vector%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90%E5%8F%8A%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.</span> <span class="toc-text">2.vector深度剖析及模拟实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#21-stdvector%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A1%86%E6%9E%B6%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0xylvector"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 std::vector的核心框架接口的模拟实现xyl::vector</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22-%E4%BD%BF%E7%94%A8memcpy%E6%8B%B7%E8%B4%9D%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 使用memcpy拷贝问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#23%E5%8A%A8%E6%80%81%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E7%90%86%E8%A7%A3"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3****动态二维数组理解</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/10/UE/UE5-VR%E9%A1%B9%E7%9B%AEHDRIBackdrop%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" title="UE5-VR项目HDRIBackdrop无法正常显示问题解决"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2026/01/10/UE/UE5-VR%E9%A1%B9%E7%9B%AEHDRIBackdrop%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/c279d21ae76201f770cff811d5bc5b9b48676898.png@1192w.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5-VR项目HDRIBackdrop无法正常显示问题解决"></a><div class="content"><a class="title" href="/2026/01/10/UE/UE5-VR%E9%A1%B9%E7%9B%AEHDRIBackdrop%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" title="UE5-VR项目HDRIBackdrop无法正常显示问题解决">UE5-VR项目HDRIBackdrop无法正常显示问题解决</a><time datetime="2026-01-10T07:41:29.000Z" title="发表于 2026-01-10 15:41:29">2026-01-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/10/UE/UE5%E8%BF%90%E8%A1%8C%E5%B8%A7%E7%8E%87FPS%E7%9A%84%E9%97%AE%E9%A2%98/" title="UE5运行帧率FPS的问题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5运行帧率FPS的问题"></a><div class="content"><a class="title" href="/2026/01/10/UE/UE5%E8%BF%90%E8%A1%8C%E5%B8%A7%E7%8E%87FPS%E7%9A%84%E9%97%AE%E9%A2%98/" title="UE5运行帧率FPS的问题">UE5运行帧率FPS的问题</a><time datetime="2026-01-10T05:20:11.000Z" title="发表于 2026-01-10 13:20:11">2026-01-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/07/UE/UE5%E4%B8%AD%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E7%BC%BA%E5%B0%91Generate%20Visual%20Studio%20project%20files%E7%AD%89%E9%80%89%E9%A1%B9/" title="UE5中如何解决右键菜单缺少Generate Visual Studio project files等选项"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5中如何解决右键菜单缺少Generate Visual Studio project files等选项"></a><div class="content"><a class="title" href="/2026/01/07/UE/UE5%E4%B8%AD%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E7%BC%BA%E5%B0%91Generate%20Visual%20Studio%20project%20files%E7%AD%89%E9%80%89%E9%A1%B9/" title="UE5中如何解决右键菜单缺少Generate Visual Studio project files等选项">UE5中如何解决右键菜单缺少Generate Visual Studio project files等选项</a><time datetime="2026-01-07T07:43:11.000Z" title="发表于 2026-01-07 15:43:11">2026-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/04/UE/UE5%E8%B5%84%E6%BA%90%E3%80%81%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%92%8C%E6%8E%A7%E5%88%B6%E5%8F%B0/" title="UE5资源、快捷键和控制台"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5资源、快捷键和控制台"></a><div class="content"><a class="title" href="/2026/01/04/UE/UE5%E8%B5%84%E6%BA%90%E3%80%81%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%92%8C%E6%8E%A7%E5%88%B6%E5%8F%B0/" title="UE5资源、快捷键和控制台">UE5资源、快捷键和控制台</a><time datetime="2026-01-04T07:43:11.000Z" title="发表于 2026-01-04 15:43:11">2026-01-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/03/UE/UE5%20-%20%E5%AE%9E%E7%8E%B0%E7%94%BB%E4%B8%AD%E7%94%BB/" title="UE5 - 实现画中画"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2026/01/03/UE/UE5%20-%20%E5%AE%9E%E7%8E%B0%E7%94%BB%E4%B8%AD%E7%94%BB/2026-01-03_115346_135.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5 - 实现画中画"></a><div class="content"><a class="title" href="/2026/01/03/UE/UE5%20-%20%E5%AE%9E%E7%8E%B0%E7%94%BB%E4%B8%AD%E7%94%BB/" title="UE5 - 实现画中画">UE5 - 实现画中画</a><time datetime="2026-01-03T03:52:42.000Z" title="发表于 2026-01-03 11:52:42">2026-01-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2026 By formeasy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(async()=>{window.katex_js_css||(window.katex_js_css=!0,await btf.getCSS("https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"),await btf.getScript("https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js")),document.querySelectorAll("#article-container .katex").forEach(t=>t.classList.add("katex-show"))})()</script><script>(()=>{var e=()=>{var e;0!==(e=document.querySelectorAll("pre > code.mermaid")).length&&e.forEach(e=>{var t=document.createElement("pre"),n=(t.className="mermaid-src",t.hidden=!0,t.textContent=e.textContent,document.createElement("div"));n.className="mermaid-wrap",n.appendChild(t),e.parentNode.replaceWith(n)});const t=document.querySelectorAll("#article-container .mermaid-wrap");0!==t.length&&(e=()=>{{var e=t;window.loadMermaid=!0;const a="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";e.forEach((e,t)=>{const n=e.firstElementChild;e=`%%{init:{ 'theme':'${a}'}}%%
`+n.textContent,t=mermaid.render("mermaid-"+t,e);const d=e=>{n.insertAdjacentHTML("afterend",e)};"string"==typeof t?d(t):t.then(({svg:e})=>d(e))})}},btf.addGlobalFn("themeChange",e,"mermaid"),window.loadMermaid?e():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(e))};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{const a=GLOBAL_CONFIG_SITE.isShuoshuo,s=null,n=t=>"dark"===t?"dark":"light";var t=(t=document,e)=>{e=a?{"data-mapping":"specific","data-term":e}:{"data-mapping":(s,"pathname")},e=(t=>{const a=document.createElement("script");return Object.entries(t).forEach(([t,e])=>{a.setAttribute(t,e)}),a})({src:"https://giscus.app/client.js","data-repo":"formeasy/blog","data-repo-id":"R_kgDOJ2sA5A","data-category-id":"DIC_kwDOJ2sA5M4CktKh","data-theme":n(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0,...s,...e});t.querySelector("#giscus-wrap").appendChild(e),a&&(window.shuoshuoComment.destroyGiscus=()=>{t.children.length&&(t.innerHTML="",t.classList.add("no-comment"))})};btf.addGlobalFn("themeChange",t=>{var e=document.querySelector("#giscus-wrap iframe");e&&(t={giscus:{setConfig:{theme:n(t)}}},e.contentWindow.postMessage(t,"https://giscus.app"))},"giscus"),a?window.shuoshuoComment={loadComment:t}:t()})()</script></div><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="请输入搜索关键字" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>