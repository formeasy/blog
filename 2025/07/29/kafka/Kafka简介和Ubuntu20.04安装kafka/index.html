<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Kafka简介和Ubuntu20.04安装kafka | 易锦风的博客</title><meta name="author" content="formeasy"><meta name="copyright" content="formeasy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Kafka简介和Ubuntu20.04安装kafka"><meta property="og:type" content="article"><meta property="og:title" content="Kafka简介和Ubuntu20.04安装kafka"><meta property="og:url" content="http://www.formeasy.cc/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/index.html"><meta property="og:site_name" content="易锦风的博客"><meta property="og:description" content="Kafka简介和Ubuntu20.04安装kafka"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.formeasy.cc/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/57bd315695d55136ee958cc6bd3a3ece.png"><meta property="article:published_time" content="2025-07-29T02:19:26.000Z"><meta property="article:modified_time" content="2025-07-29T02:33:28.393Z"><meta property="article:author" content="formeasy"><meta property="article:tag" content="kafka"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://www.formeasy.cc/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/57bd315695d55136ee958cc6bd3a3ece.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.formeasy.cc/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{var e={set:(e,t,a)=>{a&&(a=Date.now()+864e5*a,localStorage.setItem(e,JSON.stringify({value:t,expiry:a})))},get:e=>{var t=localStorage.getItem(e);if(t){var{value:t,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return t;localStorage.removeItem(e)}}},t=(window.btf={saveToLocal:e,getScript:(o,n={})=>new Promise((e,t)=>{const a=document.createElement("script");a.src=o,a.async=!0,Object.entries(n).forEach(([e,t])=>a.setAttribute(e,t)),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),getCSS:(o,n)=>new Promise((e,t)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),addGlobalFn:(e,t,a=!1,o=window)=>{var n;e.startsWith("pjax")||((n=o.globalFn||{})[e]=n[e]||{},n[e][a||Object.keys(n[e]).length]=t,o.globalFn=n)}},()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")}),a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")},o=(btf.activateDarkMode=t,btf.activateLightMode=a,e.get("theme")),t=("dark"===o?t():"light"===o&&a(),e.get("aside-status"));void 0!==t&&document.documentElement.classList.toggle("hide-aside","hide"===t);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"未找到符合您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1,highlightFullpage:!1,highlightMacStyle:!0},copy:{success:"复制成功",error:"复制失败",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Kafka简介和Ubuntu20.04安装kafka",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="易锦风的博客" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">241</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/2025/07/29/kafka/Kafka简介和Ubuntu20.04安装kafka/57bd315695d55136ee958cc6bd3a3ece.png)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon.png" alt="Logo"><span class="site-name">易锦风的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">Kafka简介和Ubuntu20.04安装kafka</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Kafka简介和Ubuntu20.04安装kafka</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-29T02:19:26.000Z" title="发表于 2025-07-29 10:19:26">2025-07-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-29T02:33:28.393Z" title="更新于 2025-07-29 10:33:28">2025-07-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h2><p>Kafka是一个实时数据处理系统，可以横向扩展、高可靠，而且还变态快，已经被很多公司使用。<br>那么什么是实时数据处理系统呢？顾名思义，实时数据处理系统就是数据一旦产生，就要能快速进行处理的系统。</p><p>对于实时数据处理，我们最常见的，就是消息中间件了，也叫MQ（Message Queue，消息队列），也有叫Message Broker的。</p><h3 id="为什么需要消息中间件"><a class="markdownIt-Anchor" href="#为什么需要消息中间件"></a> 为什么需要消息中间件</h3><p>消息中间件的作用主要有两点：<br><strong>1. 解耦消息的生产和消费。</strong><br><strong>2. 缓冲。</strong><br>想象一个场景，你的一个创建订单的操作，在订单创建完成之后，需要触发一系列其他的操作，比如进行用户订单数据的统计、给用户发送短信、给用户发送邮件等等，就像这样：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">createOrder</span>(...)&#123;</span><br><span class="line"> ...</span><br><span class="line"> <span class="built_in">statOrderData</span>(...);</span><br><span class="line"> <span class="built_in">sendSMS</span>();</span><br><span class="line"> <span class="built_in">sendEmail</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码这样写似乎没什么问题，可是过了一段时间，你给系统引进了一个用户行为分析服务，它也需要在订单创建完成之后，进行一个分析用户行为的操作，而且随着系统的逐渐壮大，创建订单之后要触发的操作也就越来越多，代码也渐渐膨胀成这样：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">createOrder</span>(...)&#123;</span><br><span class="line"> ...</span><br><span class="line"> <span class="built_in">statOrderData</span>(...);</span><br><span class="line"> <span class="built_in">sendSMS</span>();</span><br><span class="line"> <span class="built_in">sendEmail</span>();</span><br><span class="line"> <span class="comment">// new operation</span></span><br><span class="line"> <span class="built_in">statUserBehavior</span>(...);</span><br><span class="line"> <span class="built_in">doXXX</span>(...);</span><br><span class="line"> <span class="built_in">doYYY</span>(...);</span><br><span class="line"> <span class="comment">// more and more operations</span></span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>导致代码越来越膨胀的症结在于，消息的生产和消费耦合在一起了。createOrder方法不仅仅要负责生产“订单已创建”这条消息，还要负责处理这条消息。</p><p>这就好比BBC的记者，在知道皇马拿到欧冠冠军之后，拿起手机，翻开皇马球迷通讯录，给球迷一个一个打电话，告诉他们，皇马夺冠了。</p><p>事实上，BBC的记者只需要在他们官网发布这条消息，然后球迷自行访问BBC，去上面获取这条新闻；又或者球迷订阅了BBC，那么订阅系统会主动把发布在官网的消息推送给球迷。</p><p>同样，createOrder也需要一个像BBC官网那样的载体，也就是消息中间件，在订单创建完成之后，把一条主题为“orderCreated”的消息，放到消息中间件去就ok了，不必关心需要把这条消息发给谁。这就完成了消息的生产。</p><p>至于需要在订单创建完成之后触发操作的服务，则只需要订阅主题为“orderCreated”的消息，在消息中间件出现新的“orderCreated”消息时，就会收到这条消息，然后进行相应的处理。</p><p>因此，通过使用消息中间件，上面的代码也就简化成了：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">createOrder</span>(...)&#123;</span><br><span class="line"> ...</span><br><span class="line"> <span class="built_in">sendOrderCreatedMessage</span>(...);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以后如果在订单创建之后有新的操作需要执行，这串代码也不需要修改，只需要给对消息进行订阅即可。</p><p>另外，通过这样的解耦，消费者在消费数据时更加的灵活，不必每次消息一产生就要马上去处理（虽然通常消费者侧也会有线程池等缓冲机制），可以等自己有空了的时候，再过来消息中间件这里取数据进行处理。这就是消息中间件带来的缓冲作用。</p><h3 id="kafka一代-消息队列"><a class="markdownIt-Anchor" href="#kafka一代-消息队列"></a> Kafka一代 - 消息队列</h3><p>从上面的描述，我们可以看出，消息中间件之所以可以解耦消息的生产和消费，主要是它提供了一个存放消息的地方——生产者把消息放进来，消费者在从中取出消息进行处理。</p><p>那么这个存放消息的地方，应该采用什么<strong>数据结构</strong>呢？</p><p>在绝大多数情况下，我们都希望先发送进来的消息，可以先被处理（FIFO），这符合大多数的业务逻辑，少数情况下我们会给消息设置优先级。不管怎样，对于消息中间件来说，一个先进先出的队列，是非常合适的数据结构：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="57bd315695d55136ee958cc6bd3a3ece.png" alt="在这里插入图片描述"></p><p>那么要怎样保证消息可以被<strong>顺序消费</strong>呢？</p><p>消费者过来获取消息时，每次都把index=0的数据返回过去，然后再删除index=0的那条数据？</p><p>很明显不行，因为订阅了这条消息的消费者数量，可能是0，也可能是1，还可能大于1。如果每次消费完就删除了，那么其他订阅了这条消息的消费者就获取不到这条消息了。</p><p>事实上，Kafka会对数据进行<strong>持久化存储</strong>（至于存放多长时间，这是可以配置的），消费者端会记录一个<strong>offset</strong>，表明该消费者当前消费到哪条数据，所以下次消费者想继续消费，只需从offset+1的位置继续消费就好了。</p><p>消费者甚至可以通过调整offset的值，重新消费以前的数据。</p><p>那么这就是Kafka了吗？不，这只是一条非常普通的消息队列，我们姑且叫它为Kafka一代吧。</p><p>这个Kafka一代用一条消息队列实现了消息中间件，这样的简单实现存在不少问题：</p><p>· <strong>Topic鱼龙混杂</strong>。想象一下，一个只订阅了topic为“A”的消费者，却要在一条有ABCDEFG…等各种各样topic的队列里头去寻找topic为A的消息，这样性能岂不是很慢？<br>· <strong>吞吐量低</strong>。我们把全部消息都放在一条队列了，请求一多，它肯定应付不过来。</p><p>由此就引申出了Kafka二代。</p><h3 id="kafka二代-partition"><a class="markdownIt-Anchor" href="#kafka二代-partition"></a> Kafka二代 - Partition</h3><p>要解决Kafka一代的那两个问题，很简单——分布存储。</p><p>二代Kafka引入了Partition的概念，也就是采用多条队列， 每条队列里面的消息都是相同的topic：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="8ba4a70108f79b03f407c96e9ee91616.png" alt="在这里插入图片描述"><br>Partition的设计解决了上面提到的两个问题：</p><p><strong>纯Topic队列</strong>。一个队列只有一种topic，消费者再也不用担心会碰到不是自己想要的topic的消息了。<br><strong>提高吞吐量</strong>。不同topic的消息交给不同队列去存储，再也不用以一敌十了。</p><p>一个队列只有一种topic，但是一种topic的消息却可以根据自定义的key值，分散到多条队列中。也就是说，上图的p1和p2，可以都是同一种topic的队列。不过这是属于比较高级的应用了，以后有机会再和大家讨论。</p><p>Kafka二代足够完美了吗？当然不是，我们虽然通过Partition提升了性能，但是我们忽略了一个很重要的问题——<strong>高可用</strong>。</p><p>万一机器挂掉了怎么办？单点系统总是不可靠的。<strong>我们必须考虑备用节点和数据备份的问题</strong>。</p><h3 id="kafka三代-broker集群"><a class="markdownIt-Anchor" href="#kafka三代-broker集群"></a> Kafka三代 - Broker集群</h3><p>很明显，为了解决高可用问题，我们需要<strong>集群</strong>。</p><p>Kafka对集群的支持也是非常友好的。在Kafka中，集群里的每个实例叫做<strong>Broker</strong>，就像这样：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="54146f5b9888717f3466afeca58c73e5.png" alt="在这里插入图片描述"><br>每个partition不再只有一个，而是有一个leader(红色)和多个replica(蓝色)，生产者根据消息的topic和key值，确定了消息要发往哪个partition之后（假设是p1），会找到partition对应的leader(也就是broker2里的p1)，然后将消息发给leader，leader负责消息的写入，并与其余的replica进行同步。</p><p>一旦某一个partition的leader挂掉了，那么只需提拔一个replica出来，让它成为leader就ok了，系统依旧可以正常运行。</p><p>通过Broker集群的设计，我们不仅解决了系统高可用的问题，还进一步提升了系统的吞吐量，因为replica同样可以为消费者提供数据查找的功能。</p><h3 id="kafka没那么简单"><a class="markdownIt-Anchor" href="#kafka没那么简单"></a> Kafka没那么简单</h3><p><strong>1. kafka的消息结构</strong><br>我们只知道Kafka内部是一个消息队列，但是队列里的元素长什么样，包含了哪些消息呢？</p><p>参考：<a target="_blank" rel="noopener" href="http://kafka.apache.org/documentation/#messageformat">Kafka - messageformat</a></p><p><strong>2. zookeeper和kafka的关系</strong><br>如果玩过Kafka的Quick Start教程，就会发现，我们在使用Kafka时，需要先启动一个ZK，那么这个ZK的作用到底是什么呢？</p><p>参考：<a href="https://link.zhihu.com/?target=https://www.quora.com/What-is-the-actual-role-of-Zookeeper-in-Kafka-What-benefits-will-I-miss-out-on-if-I-don%25E2%2580%2599t-use-Zookeeper-and-Kafka-together">What-is-the-actual-role-of-Zookeeper-in-Kafka</a></p><p><strong>3. 数据可靠性和重复消费</strong><br>生产者把消息发给Kafka，发送过程中挂掉、或者Kafka保存消息时发送异常怎么办？</p><p>同理，消费者获取消费时发生异常怎么办？</p><p>甚至，如果消费者已经消费了数据，但是修改offset时失败了，导致重复消费怎么办？</p><p>等等这些异常场景，都是Kafka需要考虑的。</p><p>参考：<a href="https://link.zhihu.com/?target=http://kafka.apache.org/documentation/#semantics">Kafka - Message Delivery Semantics</a></p><p><strong>4. pull or push</strong><br>消费者侧在获取消息时，是通过主动去pull消息呢？还是由Kafka给消费者push消息？</p><p>这两种方式各自有什么优劣？</p><p>参考：<a href="https://link.zhihu.com/?target=http://kafka.apache.org/documentation/#design_pull">Kafka - push vs pull</a></p><p><strong>5. 如何提高消费者处理性能</strong><br>还是之前的订单创建的例子，订单创建后，你要给用户发送短信，现在你发现由于你只有一个消费者在发送短信，忙不过来，怎么办？这就有了Kafka里头的消费者组（Consumer Group）的设计。</p><p>参考：<a href="https://link.zhihu.com/?target=https://dzone.com/articles/understanding-kafka-consumer-groups-and-consumer-l">Understanding-kafka-consumer-groups-and-consumer</a></p><p><strong>6.终极问题：一条消息从生产，到被消费，完整流程是怎样的？</strong><br>如果能详尽透彻地回答这个问题，那你对Kafka的理解也就非常深入了。</p><p><strong>7. 参考文献&amp;学习资源</strong><br>官网：</p><p><a href="https://link.zhihu.com/?target=http://kafka.apache.org/">Apache Kafka</a><br><a href="https://link.zhihu.com/?target=http://kafka.apache.org/intro">Kafka简介</a><br><a href="https://link.zhihu.com/?target=http://kafka.apache.org/documentation">Kafka官网文档</a><br>一些不错的博客：</p><p><a href="https://link.zhihu.com/?target=https://sookocheff.com/post/kafka/kafka-in-a-nutshell/">Kafka-in-a-nutshell（入门绝佳读物）</a></p><p><a href="https://link.zhihu.com/?target=https://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying">What every software engineer should know about real-time data’s unifying abstraction（从这篇文章可以知道LinkedIn为何要开发Kafka）</a></p><p><a href="https://link.zhihu.com/?target=https://www.confluent.io/blog/how-to-choose-the-number-of-topicspartitions-in-a-kafka-cluster/">How to choose the number of topics/partitions in a Kafka cluster?（对Kafka Partition的深入讲解和性能优化指导）</a><br>书籍（没看过，但是感觉不错的书）：</p><p><a href="https://link.zhihu.com/?target=https://book.douban.com/subject/27665114/">Kafka权威指南</a><br><a href="https://link.zhihu.com/?target=https://book.douban.com/subject/27038473/">Apache Kafka源码剖析（可以自己先看看源码，再看看这本书）</a></p><h2 id="安装javajdk"><a class="markdownIt-Anchor" href="#安装javajdk"></a> 安装JAVA（jdk）</h2><h3 id="下载安装包"><a class="markdownIt-Anchor" href="#下载安装包"></a> 下载安装包</h3><p>（<a target="_blank" rel="noopener" href="https://archive.apache.org/dist/zookeeper/">官网</a>）链接：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="3637292307ee1e8df884b9cf2db5b175.png" alt="在这里插入图片描述"><br>还可以直接通过wget命令直接把JDK安装包下载下来，具体执行命令请度娘。</p><h3 id="解压安装包"><a class="markdownIt-Anchor" href="#解压安装包"></a> 解压安装包</h3><p>可自定义一个目录存（/home/temp）放并进行解压,执行命令行如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir /home/temp</span></span><br><span class="line"><span class="comment"># cd  /home/temp</span></span><br><span class="line"><span class="comment"># tar  -zxvf  jdk-8u181-linux-x64.tar.gz</span></span><br></pre></td></tr></table></figure><p>将解压后的【jdk1.8.0_181】里面的所有数据移动到指定的文件夹下（如/usr/local/java）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir /usr/local/java</span></span><br></pre></td></tr></table></figure><p>将【jdk1.8.0_181】里的数据拷贝至java目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mv /home/temp/jdk1.8.0_181 /usr/local/java</span></span><br></pre></td></tr></table></figure><h3 id="修改环境变量"><a class="markdownIt-Anchor" href="#修改环境变量"></a> 修改环境变量</h3><p>修改环境变量，通过命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile</span></span><br></pre></td></tr></table></figure><p>在文件末尾添加一下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/java</span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib:$CLASSPATH</span><br><span class="line">export JAVA_PATH=$&#123;JAVA_HOME&#125;/bin:$&#123;JRE_HOME&#125;/bin</span><br><span class="line">export PATH=$PATH:$&#123;JAVA_PATH&#125;</span><br></pre></td></tr></table></figure><p>然后，保存并退出(按：wq!)</p><p>保存完之后，通过命令source /etc/profile让profile文件立即生效</p><p>第四步、测试是否安装成功</p><p>①、使用javac命令，不会出现command not found错误</p><p>②、使用java -version，出现版本为java version “1.8.0_181”</p><p>③、echo $PATH，看看自己刚刚设置的的环境变量配置是否都正确</p><p>测试没问题即安装成功</p><h2 id="安装zookeeper"><a class="markdownIt-Anchor" href="#安装zookeeper"></a> 安装Zookeeper</h2><h3 id="下载"><a class="markdownIt-Anchor" href="#下载"></a> 下载</h3><p>到官网去下载你想要的版本 <a target="_blank" rel="noopener" href="http://mirror.bit.edu.cn/apache/zookeeper/">官网下载地址</a><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="b3780e7ea863cc7cb701354b4363f8d7.png" alt="在这里插入图片描述"></p><h3 id="解压"><a class="markdownIt-Anchor" href="#解压"></a> 解压</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#tar -zxvf zookeeper-3.4.10.tar.gz</span></span><br></pre></td></tr></table></figure><p>将解压后的文件复制到/usr/local目录下，并重命名为zookeeper：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost tmp]<span class="comment"># cp zookeeper-3.4.10 /usr/local/zookeeper -r  //复制所有文件到zookeeper 文件夹下</span></span><br><span class="line">[root@localhost tmp]<span class="comment"># cd /usr/local/zookeeper   //切换到/usr/local/zookeeper目录下</span></span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2edd9044f97029040e88cc08b3ab2ddc.png" alt="在这里插入图片描述"></p><h3 id="配置"><a class="markdownIt-Anchor" href="#配置"></a> 配置</h3><p>but 这里需要更改一下 .cfg 文件名 zookeeper 启动脚本默认是寻找 zoo.cfg 文件。。。。之所以 得修改文件名<br>切换到zookeeper目录下的conf目录下，重新复制一份zoo_sample.cfg文件并命名为zoo.cfg：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper]<span class="comment"># cd conf  //切换到目录下</span></span><br><span class="line">[root@localhost conf]<span class="comment"># ll//显示目录下的信息</span></span><br><span class="line">总用量 12</span><br><span class="line">-rw-r--r--. 1 root root  535 5月   8 18:17 configuration.xsl</span><br><span class="line">-rw-r--r--. 1 root root 2161 5月   8 18:17 log4j.properties</span><br><span class="line">-rw-r--r--. 1 root root  922 5月   8 18:17 zoo_sample.cfg</span><br><span class="line">[root@localhost conf]<span class="comment"># cp zoo_sample.cfg zoo.cfg//copy一份到当前目录下，并命名为zoo.cfg</span></span><br><span class="line">[root@localhost conf]<span class="comment"># ll</span></span><br><span class="line">总用量 16</span><br><span class="line">-rw-r--r--. 1 root root  535 5月   8 18:17 configuration.xsl</span><br><span class="line">-rw-r--r--. 1 root root 2161 5月   8 18:17 log4j.properties</span><br><span class="line">-rw-r--r--. 1 root root  922 5月   8 18:29 zoo.cfg</span><br><span class="line">-rw-r--r--. 1 root root  922 5月   8 18:17 zoo_sample.cfg</span><br><span class="line">[root@localhost conf]<span class="comment"># </span></span><br></pre></td></tr></table></figure><p>修改zoo.cfg文件如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost conf]<span class="comment"># vi zoo.cfg</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line">tickTime=2000</span><br><span class="line"><span class="comment"># The number of ticks that the initial </span></span><br><span class="line"><span class="comment"># synchronization phase can take</span></span><br><span class="line">initLimit=10</span><br><span class="line"><span class="comment"># The number of ticks that can pass between </span></span><br><span class="line"><span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line">syncLimit=5</span><br><span class="line"><span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line"><span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line"><span class="comment"># example sakes.</span></span><br><span class="line">dataDir=D:\\zookeeper-3.5.4-beta\\data</span><br><span class="line">dataLogDir=D:\\zookeeper-3.5.4-beta\\<span class="built_in">log</span></span><br><span class="line"><span class="comment"># the port at which the clients will connect</span></span><br><span class="line">admin.serverPort=8082</span><br><span class="line">clientPort=2181</span><br><span class="line"><span class="comment"># the maximum number of client connections.</span></span><br><span class="line"><span class="comment"># increase this if you need to handle more clients</span></span><br><span class="line"><span class="comment">#maxClientCnxns=60</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Be sure to read the maintenance section of the </span></span><br><span class="line"><span class="comment"># administrator guide before turning on autopurge.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The number of snapshots to retain in dataDir</span></span><br><span class="line"><span class="comment">#autopurge.snapRetainCount=3</span></span><br><span class="line"><span class="comment"># Purge task interval in hours</span></span><br><span class="line"><span class="comment"># Set to &quot;0&quot; to disable auto purge feature</span></span><br><span class="line"><span class="comment">#autopurge.purgeInterval=1</span></span><br><span class="line">server.0=192.168.2.3:9092:113</span><br></pre></td></tr></table></figure><p>修改内容：</p><p>增加了：admin.serverPort=8082 #不然会出现端口被占用的情况，因为默认是和Apache.Tomcat使用的8080端口<br>修改了：dataDir=D:\zookeeper-3.5.4-beta\data #保存数据的目录<br>dataLogDir=D:\zookeeper-3.5.4-beta\log #保存日志的目录</p><blockquote><p>tickTime：这个时间是作为 Zookeeper 服务器之间或客户端与服务器之间维持心跳的时间间隔，也就是每个 tickTime 时间就会发送一个心跳。<br>dataDir：顾名思义就是 Zookeeper 保存数据的目录，默认情况下，Zookeeper 将写数据的日志文件也保存在这个目录里。<br>dataLogDir：顾名思义就是 Zookeeper 保存日志文件的目录<br>clientPort：这个端口就是客户端连接 Zookeeper 服务器的端口，Zookeeper 会监听这个端口，接受客户端的访问请求。<br>server.A = B:C:D<br>A表示这个是第几号服务器<br>B 是这个服务器的 ip 地址<br>C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口<br>D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader</p></blockquote><h3 id="最后一步配置环境变量"><a class="markdownIt-Anchor" href="#最后一步配置环境变量"></a> 最后一步配置环境变量：</h3><p>打开/etc/profile</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper]<span class="comment"># vi /etc/profile//编辑文件</span></span><br></pre></td></tr></table></figure><p>添加如下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export ZOOKEEPER=/usr/local/zookeeper</span><br><span class="line">export PATH=$PATH:$ZOOKEEPER/bin</span><br></pre></td></tr></table></figure><p>重启配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper]<span class="comment"># source /etc/profile    //使生效</span></span><br></pre></td></tr></table></figure><h3 id="启动zookeeper"><a class="markdownIt-Anchor" href="#启动zookeeper"></a> 启动Zookeeper</h3><p>因为配置了环境变量，所以在任意目录下都可以运行以下启动命令启动Zookeeper。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># zkServer.sh start //启动</span></span><br><span class="line">[root@localhost ~]<span class="comment"># zkServer.sh status  //查看运行状态</span></span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2a424f785b5c118c207f90c37f0e7f63.png" alt="在这里插入图片描述"></p><h3 id="启动客户端"><a class="markdownIt-Anchor" href="#启动客户端"></a> 启动客户端：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># zkCli.sh   //启动客户端</span></span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="fc44e7fbb198ae0240ded31e1c964f7e.png" alt="在这里插入图片描述"></p><h3 id="配置开机启动zookeeper"><a class="markdownIt-Anchor" href="#配置开机启动zookeeper"></a> 配置开机启动zookeeper</h3><ol><li><p>在/etc/init.d目录下新建zookeeper文件</p><p>vi /etc/init.d/zookeeper//vi 编辑zookeeper文件，不存在时就创建该文件</p></li></ol><p>输入以下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">ZK_PATH=/usr/local/zookeeper</span><br><span class="line">export JAVA_HOME=/usr/local/java/jdk1.8.0_171</span><br><span class="line">case $1 in</span><br><span class="line">         start) sh  $ZK_PATH/bin/zkServer.sh start;;</span><br><span class="line">         stop)  sh  $ZK_PATH/bin/zkServer.sh stop;;</span><br><span class="line">         status) sh  $ZK_PATH/bin/zkServer.sh status;;</span><br><span class="line">         restart) sh $ZK_PATH/bin/zkServer.sh restart;;</span><br><span class="line">         *)  echo &quot;require start|stop|status|restart&quot;  ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><ol start="2"><li>保存并退出后，执行以下chkconfig --add 指令把脚本注册为Service：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add zookeeper</span><br></pre></td></tr></table></figure><p>你可以使用chkconfig --list查看你的注册操作时否成功<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="18375127587776207abdd9b7a439a3a9.png" alt="在这里插入图片描述"><br><strong>注意：</strong><br><strong>1. Ubuntu 16.04 下安装 Nginx 服务器，在添加 nginx 服务时出现如下信息</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chkconfig --add nginx</span></span><br><span class="line">chkconfig: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure><p><strong>问题原因</strong><br>Ubuntu 中 chkconfig 已经被 sysv-rc-conf 所替代，chkconfig 命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chkconfig --add nginx  </span></span><br><span class="line"><span class="comment"># chkconfig nginx on</span></span><br></pre></td></tr></table></figure><p><strong>问题解决</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apt-get update</span></span><br><span class="line"><span class="comment"># apt-get install sysv-rc-conf</span></span><br><span class="line"><span class="comment"># sysv-rc-conf nginx on</span></span><br></pre></td></tr></table></figure><p><strong>2.Ubuntu下安装sysv-rc-conf报错：ubuntuE: Unable to locate package sysv-rc-conf</strong></p><p>当我安装sysv-rc-conf时，报了如下的错：<br>E: Unable to locate package sysv-rc-conf（无法定位sysv-rc-conf包）<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="998a7a17233c1302a65abdaa822e9c83.png" alt="在这里插入图片描述"><br>提供一个解决办法，如下：<br>在软件源列表sources.list（该文本的位置在/etc/apt/sources.list）文件中的末尾添加如下内容：<br>deb <a target="_blank" rel="noopener" href="http://archive.ubuntu.com/ubuntu/">http://archive.ubuntu.com/ubuntu/</a> trusty main universe restricted multiverse</p><p><strong>第一步</strong>：终端输入：sudo gedit /etc/apt/sources.list（这里我使用的是gedit，你可以使用自己喜欢的工具，如vi、vim等），打开该文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p><strong>第二步</strong>：在软件源sources.list文件中添加如下一列文本：<br>deb <a target="_blank" rel="noopener" href="http://archive.ubuntu.com/ubuntu/">http://archive.ubuntu.com/ubuntu/</a> trusty main universe restricted multiverse<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="e39089d3da23801e468a619d6da35044.png" alt="在这里插入图片描述"><br><strong>第三步</strong>：更新apt-get，在终端输入sudo apt-get update</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><p>注意，此处更新可能会出错，重复执行更新就好了</p><p><strong>第四步</strong>：完成更新后，重新安装sysv-rc-conf，在终端输入sudo apt-get install sysv-rc-conf，即可成功安装。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="edd6a8629dee4c0f934eb23ac8dd75f9.png" alt="在这里插入图片描述"></p><h2 id="安装-kafka"><a class="markdownIt-Anchor" href="#安装-kafka"></a> 安装 kafka</h2><h3 id="下载代码"><a class="markdownIt-Anchor" href="#下载代码"></a> 下载代码</h3><p>下载地址：<a target="_blank" rel="noopener" href="https://kafka.apache.org/downloads%EF%BC%8Cubuntu%E4%B8%8B%E5%8F%AF%E4%BB%A5%E7%94%A8wget%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%EF%BC%8C%E6%88%91%E6%98%AF%E4%B8%8B%E8%BD%BD%E5%88%B0%E4%BA%86/home/kafka%E7%9B%AE%E5%BD%95">https://kafka.apache.org/downloads，ubuntu下可以用wget直接下载，我是下载到了/home/kafka目录</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.shuosc.org/apache/kafka/1.0.0/kafka_2.11-1.0.0.tgz</span><br></pre></td></tr></table></figure><p>解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf kafka_2.11-1.0.0.tgz</span><br></pre></td></tr></table></figure><p>在kafka解压目录下创建日志存储目录<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="0a1f1bc1545008ba1294406d52bc8b67.png" alt="在这里插入图片描述"><br>修改kafka-server 的配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config/server.properties</span><br></pre></td></tr></table></figure><p>修改配置文件中21、31、36和60行</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">**broker.id=1** //--使用单机模式可以不修改</span><br><span class="line">**listeners=PLAINTEXT://:9092**  //--使用单机模式可以不修改</span><br><span class="line">**advertised.listeners=PLAINTEXT://host_ip:9092** //--使用单机模式可以不修改</span><br><span class="line">**log.dirs=/home/yzy/kafka/kafka_2.12-2.6.0/kafka_logs**</span><br></pre></td></tr></table></figure><h3 id="启动服务器"><a class="markdownIt-Anchor" href="#启动服务器"></a> 启动服务器</h3><p>Kafka 使用 ZooKeeper 如果你还没有ZooKeeper服务器，你需要先启动一个ZooKeeper服务器。 您可以通过与kafka打包在一起的便捷脚本来快速简单地创建一个单节点ZooKeeper实例。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zookeeper-server-start.sh config/zookeeper.properties //--该启动脚本在kafka文件夹bin下面，不是在zookeeper里面</span><br></pre></td></tr></table></figure><p>现在启动Kafka服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-server-start.sh config/server.properties</span><br></pre></td></tr></table></figure><h3 id="创建一个topic"><a class="markdownIt-Anchor" href="#创建一个topic"></a> 创建一个topic</h3><p>让我们创建一个名为“test”的topic，它有一个分区和一个副本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>现在我们可以运行list（列表）命令来查看这个topic：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-topics.sh --list --zookeeper localhost:2181</span><br><span class="line"><span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>或者，您也可将代理配置为：在发布的topic不存在时，自动创建topic，而不是手动创建。</p><h3 id="发送消息"><a class="markdownIt-Anchor" href="#发送消息"></a> 发送消息</h3><p>Kafka自带一个命令行客户端，它从文件或标准输入中获取输入，并将其作为message（消息）发送到Kafka集群。默认情况下，每行将作为单独的message发送。</p><p>运行 producer，然后在控制台输入一些消息以发送到服务器。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-console-producer.sh --broker-list localhost:9092 --topic <span class="built_in">test</span></span><br><span class="line">&gt;This is a message</span><br><span class="line">&gt;This is another message</span><br></pre></td></tr></table></figure><h3 id="启动一个consumer"><a class="markdownIt-Anchor" href="#启动一个consumer"></a> 启动一个consumer</h3><p>Kafka 还有一个命令行consumer（消费者），将消息转储到标准输出。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic <span class="built_in">test</span> --from-beginning</span><br><span class="line">This is a message</span><br><span class="line">This is another message</span><br></pre></td></tr></table></figure><p>如果您将上述命令在不同的终端中运行，那么现在就可以将消息输入到生产者终端中，并将它们在消费终端中显示出来。</p><p>所有的命令行工具都有其他选项；运行不带任何参数的命令将显示更加详细的使用信息。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc">formeasy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/">http://www.formeasy.cc/2025/07/29/kafka/Kafka简介和Ubuntu20.04安装kafka/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://www.formeasy.cc" target="_blank">易锦风的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/kafka/">kafka</a></div><div class="post-share"><div class="social-share" data-image="/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/57bd315695d55136ee958cc6bd3a3ece.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/29/kafka/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%8E%A9%E8%BD%AC%20kafka-python%EF%BC%9A%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E6%B6%88%E8%B4%B9%E8%80%85%E5%AE%9E%E6%88%98%E5%85%A8%E6%94%BB%E7%95%A5/" title="手把手教你玩转 kafka-python：从安装到消费者实战全攻略"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">手把手教你玩转 kafka-python：从安装到消费者实战全攻略</div></div><div class="info-2"><div class="info-item-1">在分布式系统开发中，我们经常会遇到消息队列的需求，而 Kafka 作为高性能的消息中间件，自然成为首选。但如何在 Python 中高效使用 Kafka 呢？今天我们就来深入探讨 kafka-python 的安装与消费者实战，带你从零开始掌握这个强大的工具。 一、kafka-python 安装指南 1. 最新稳定版安装 我们可以使用最常用的 Pip 包管理器来安装 kafka-python 的最新稳定版本，只需一行命令即可完成基础安装： 1pip install kafka-python 2. 开发版安装（获取最新特性） 如果我们想体验最新的功能特性，可以通过 Git 克隆仓库并手动安装： 123git clone https://github.com/dpkp/kafka-pythoncd kafka-pythonpip install . 3. 性能优化相关的可选安装 （1）crc32c 安装（Kafka 11 + 强烈推荐） 当我们使用 Kafka 11 + 版本的 broker 时，新的消息协议需要计算 crc32c，而默认的纯 Python 实现性能较差。安装...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/kafka%E5%85%A5%E9%97%A8%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B_ubuntu%E5%AE%89%E8%A3%85kafka/" title="kafka入门安装教程_ubuntu安装kafka"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">kafka入门安装教程_ubuntu安装kafka</div></div><div class="info-2"><div class="info-item-1">一、安装前准备 安装Java环境 Kafka依赖Java运行，推荐安装OpenJDK 8或11： 12sudo apt updatesudo apt install openjdk-11-jdk # 或 openjdk-8-jdk 验证安装： 1java -version 配置环境变量（如未自动配置）： 12echo &#x27;export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64&#x27; &gt;&gt; ~/.bashrc # 根据实际路径调整source ~/.bashrc 创建专用用户（可选） 为安全起见，建议创建独立用户运行Kafka： 1234sudo useradd -m kafkasudo passwd kafkasudo adduser kafka sudosu - kafka # 切换到kafka用户 二、下载与安装Kafka 下载Kafka二进制包 访问Apache Kafka官网选择版本（推荐3.5.1或稳定版），下载并解压： 123wget...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/29/kafka/Windows%E4%B8%8BKafka%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="Windows 下 Kafka 安装教程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/Windows%E4%B8%8BKafka%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/a4fc229519524deba1995b24f6c6eb53.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">Windows 下 Kafka 安装教程</div></div><div class="info-2"><div class="info-item-1">一、准备工作 ✅ 1. 安装 Java JDK（Kafka 依赖 Java 运行环境） Kafka 是基于 Java 的，必须先安装 JDK。一般学到kafka的同学肯定已经安装好了JDK了，这一步我就不写了，具体可以参考其他文章。 ⚠️ 注意：Kafka 3.9.0 要求本地必须安装 JDK 17 或以上版本。JDK 8 和 11 已不再被官方支持。 步骤： 访问官网下载 OpenJDK 或 Oracle JDK。 推荐版本：JDK 8 ~ JDK 17（Kafka 3.x 支持到 JDK 17） Kafka需要的JDK版本！ 安装完成后设置环境变量： JAVA_HOME：指向 JDK 安装目录，例如 C:\Program Files\Java\jdk-17.0.1 Path 中添加 %JAVA_HOME%\bin 验证是否安装成功： 12java -versionjavac -version 二、下载 Kafka 访问 Apache Kafka 官网下载页面： 🔗...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/kafka%E5%85%A5%E9%97%A8%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B_ubuntu%E5%AE%89%E8%A3%85kafka/" title="kafka入门安装教程_ubuntu安装kafka"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">kafka入门安装教程_ubuntu安装kafka</div></div><div class="info-2"><div class="info-item-1">一、安装前准备 安装Java环境 Kafka依赖Java运行，推荐安装OpenJDK 8或11： 12sudo apt updatesudo apt install openjdk-11-jdk # 或 openjdk-8-jdk 验证安装： 1java -version 配置环境变量（如未自动配置）： 12echo &#x27;export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64&#x27; &gt;&gt; ~/.bashrc # 根据实际路径调整source ~/.bashrc 创建专用用户（可选） 为安全起见，建议创建独立用户运行Kafka： 1234sudo useradd -m kafkasudo passwd kafkasudo adduser kafka sudosu - kafka # 切换到kafka用户 二、下载与安装Kafka 下载Kafka二进制包 访问Apache Kafka官网选择版本（推荐3.5.1或稳定版），下载并解压： 123wget...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/kafka%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/" title="kafka单机和集群部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/kafka%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/bc0251f81f814d2fb6fb334411538d4f.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">kafka单机和集群部署</div></div><div class="info-2"><div class="info-item-1">一、kafka简介 1.1、概述 kafka 是由 linkedin 公司开发，是一个分布式、分区、多副本、多生产者、多消费者，基于 zookeeper 的分布式 日志系统（也可以作为MQ 系统），常见可以用于 web/nginx 日志、访问日志、消息服务等， Linkedin2010 年将项目贡献给了Apache 基金会并成为顶级开源项目。 主要应用场景是：日志收集系统和消息详细。 设计目标如下： 1. 一时间复杂度为 O(1) 的方式提供消息持久能力，即使对 TB 级以上的数据也能保证常数时间的访问性能。 2. 高吞吐率：即使在非常廉价的商用机器上也能做到单机支持每秒 100k 条消息的传输。 3. 支持 Kafka Server 间的消息分布，以及分布式消费，同时保证每个 partition 内的消息顺序传输。 4. 同时支持离线数据和实时数据处理。 5. Scale out ：支持在线水平扩展。 1.2、消息系统介绍 一个消息系统负责将数据从一个应用传递到另外一个应用，应用只需要关注数据，无需要关系数据再两个或者...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%8E%A9%E8%BD%AC%20kafka-python%EF%BC%9A%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E6%B6%88%E8%B4%B9%E8%80%85%E5%AE%9E%E6%88%98%E5%85%A8%E6%94%BB%E7%95%A5/" title="手把手教你玩转 kafka-python：从安装到消费者实战全攻略"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">手把手教你玩转 kafka-python：从安装到消费者实战全攻略</div></div><div class="info-2"><div class="info-item-1">在分布式系统开发中，我们经常会遇到消息队列的需求，而 Kafka 作为高性能的消息中间件，自然成为首选。但如何在 Python 中高效使用 Kafka 呢？今天我们就来深入探讨 kafka-python 的安装与消费者实战，带你从零开始掌握这个强大的工具。 一、kafka-python 安装指南 1. 最新稳定版安装 我们可以使用最常用的 Pip 包管理器来安装 kafka-python 的最新稳定版本，只需一行命令即可完成基础安装： 1pip install kafka-python 2. 开发版安装（获取最新特性） 如果我们想体验最新的功能特性，可以通过 Git 克隆仓库并手动安装： 123git clone https://github.com/dpkp/kafka-pythoncd kafka-pythonpip install . 3. 性能优化相关的可选安装 （1）crc32c 安装（Kafka 11 + 强烈推荐） 当我们使用 Kafka 11 + 版本的 broker 时，新的消息协议需要计算 crc32c，而默认的纯 Python 实现性能较差。安装...</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">formeasy</div><div class="author-info-description">专注互联网和软件技术</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">241</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/formeasy"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/formeasy" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:formeasy@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">用学习，面对遭遇的变化；用斗志，面对每天的挫折；用坚持，面对失去的动力!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">为什么需要消息中间件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kafka%E4%B8%80%E4%BB%A3-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"><span class="toc-number">1.2.</span> <span class="toc-text">Kafka一代 - 消息队列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kafka%E4%BA%8C%E4%BB%A3-partition"><span class="toc-number">1.3.</span> <span class="toc-text">Kafka二代 - Partition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kafka%E4%B8%89%E4%BB%A3-broker%E9%9B%86%E7%BE%A4"><span class="toc-number">1.4.</span> <span class="toc-text">Kafka三代 - Broker集群</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kafka%E6%B2%A1%E9%82%A3%E4%B9%88%E7%AE%80%E5%8D%95"><span class="toc-number">1.5.</span> <span class="toc-text">Kafka没那么简单</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85javajdk"><span class="toc-number">2.</span> <span class="toc-text">安装JAVA（jdk）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">2.1.</span> <span class="toc-text">下载安装包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%8E%8B%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">2.2.</span> <span class="toc-text">解压安装包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">2.3.</span> <span class="toc-text">修改环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85zookeeper"><span class="toc-number">3.</span> <span class="toc-text">安装Zookeeper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-number">3.1.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%8E%8B"><span class="toc-number">3.2.</span> <span class="toc-text">解压</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">3.3.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E4%B8%80%E6%AD%A5%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">3.4.</span> <span class="toc-text">最后一步配置环境变量：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8zookeeper"><span class="toc-number">3.5.</span> <span class="toc-text">启动Zookeeper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">3.6.</span> <span class="toc-text">启动客户端：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8zookeeper"><span class="toc-number">3.7.</span> <span class="toc-text">配置开机启动zookeeper</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-kafka"><span class="toc-number">4.</span> <span class="toc-text">安装 kafka</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">下载代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">4.2.</span> <span class="toc-text">启动服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAtopic"><span class="toc-number">4.3.</span> <span class="toc-text">创建一个topic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"><span class="toc-number">4.4.</span> <span class="toc-text">发送消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AAconsumer"><span class="toc-number">4.5.</span> <span class="toc-text">启动一个consumer</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/12/UE/%E3%80%90UE5%E3%80%91%E7%BD%91%E7%BB%9C%E5%90%8C%E6%AD%A5%EF%BC%8C%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/" title="【UE5】网络同步，不同情况的简单实现"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/12/12/UE/%E3%80%90UE5%E3%80%91%E7%BD%91%E7%BB%9C%E5%90%8C%E6%AD%A5%EF%BC%8C%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/d9825c2ae6dfdfb33572628841ba985f26596343.png@968w_804h.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="【UE5】网络同步，不同情况的简单实现"></a><div class="content"><a class="title" href="/2025/12/12/UE/%E3%80%90UE5%E3%80%91%E7%BD%91%E7%BB%9C%E5%90%8C%E6%AD%A5%EF%BC%8C%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/" title="【UE5】网络同步，不同情况的简单实现">【UE5】网络同步，不同情况的简单实现</a><time datetime="2025-12-12T05:32:54.000Z" title="发表于 2025-12-12 13:32:54">2025-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/12/UE/UE5%E6%97%B6%E9%97%B4%E8%BD%B4%E8%8A%82%E7%82%B9%E5%8F%8A%E5%85%B6%E8%AE%BE%E7%BD%AE/" title="UE5时间轴节点及其设置"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5时间轴节点及其设置"></a><div class="content"><a class="title" href="/2025/12/12/UE/UE5%E6%97%B6%E9%97%B4%E8%BD%B4%E8%8A%82%E7%82%B9%E5%8F%8A%E5%85%B6%E8%AE%BE%E7%BD%AE/" title="UE5时间轴节点及其设置">UE5时间轴节点及其设置</a><time datetime="2025-12-12T05:31:05.000Z" title="发表于 2025-12-12 13:31:05">2025-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/20/UE/%E3%80%90UE5%E3%80%91%E6%91%84%E5%83%8F%E6%9C%BA%E6%99%83%E5%8A%A8/" title="【UE5】摄像机晃动"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/11/20/UE/%E3%80%90UE5%E3%80%91%E6%91%84%E5%83%8F%E6%9C%BA%E6%99%83%E5%8A%A8/82aaa08690314d64bf6b173d848ea095.gif" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="【UE5】摄像机晃动"></a><div class="content"><a class="title" href="/2025/11/20/UE/%E3%80%90UE5%E3%80%91%E6%91%84%E5%83%8F%E6%9C%BA%E6%99%83%E5%8A%A8/" title="【UE5】摄像机晃动">【UE5】摄像机晃动</a><time datetime="2025-11-20T01:41:51.000Z" title="发表于 2025-11-20 09:41:51">2025-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/20/UE/%E3%80%90Cesium%20for%20Unreal%E3%80%91%E6%B0%B4%E6%95%88%E6%9E%9C%E5%AE%9E%E7%8E%B0/" title="【Cesium for Unreal】水效果实现"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/11/20/UE/%E3%80%90Cesium%20for%20Unreal%E3%80%91%E6%B0%B4%E6%95%88%E6%9E%9C%E5%AE%9E%E7%8E%B0/64130adb59dd4d2c9188ffb8d5c2d3e2.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="【Cesium for Unreal】水效果实现"></a><div class="content"><a class="title" href="/2025/11/20/UE/%E3%80%90Cesium%20for%20Unreal%E3%80%91%E6%B0%B4%E6%95%88%E6%9E%9C%E5%AE%9E%E7%8E%B0/" title="【Cesium for Unreal】水效果实现">【Cesium for Unreal】水效果实现</a><time datetime="2025-11-20T01:25:49.000Z" title="发表于 2025-11-20 09:25:49">2025-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/12/UE/UE5%E5%86%85%E5%AE%B9%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%87%BA%E5%85%B3%E5%8D%A1%E5%8F%8A%E5%90%AF%E5%8A%A8%E7%BC%96%E8%AF%91%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/" title="UE5内容浏览器显示不出关卡及启动编译失败的问题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="UE5内容浏览器显示不出关卡及启动编译失败的问题"></a><div class="content"><a class="title" href="/2025/11/12/UE/UE5%E5%86%85%E5%AE%B9%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%87%BA%E5%85%B3%E5%8D%A1%E5%8F%8A%E5%90%AF%E5%8A%A8%E7%BC%96%E8%AF%91%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/" title="UE5内容浏览器显示不出关卡及启动编译失败的问题">UE5内容浏览器显示不出关卡及启动编译失败的问题</a><time datetime="2025-11-12T01:04:11.000Z" title="发表于 2025-11-12 09:04:11">2025-11-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By formeasy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(async()=>{window.katex_js_css||(window.katex_js_css=!0,await btf.getCSS("https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"),await btf.getScript("https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js")),document.querySelectorAll("#article-container .katex").forEach(t=>t.classList.add("katex-show"))})()</script><script>(()=>{var e=()=>{var e;0!==(e=document.querySelectorAll("pre > code.mermaid")).length&&e.forEach(e=>{var t=document.createElement("pre"),n=(t.className="mermaid-src",t.hidden=!0,t.textContent=e.textContent,document.createElement("div"));n.className="mermaid-wrap",n.appendChild(t),e.parentNode.replaceWith(n)});const t=document.querySelectorAll("#article-container .mermaid-wrap");0!==t.length&&(e=()=>{{var e=t;window.loadMermaid=!0;const a="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";e.forEach((e,t)=>{const n=e.firstElementChild;e=`%%{init:{ 'theme':'${a}'}}%%
`+n.textContent,t=mermaid.render("mermaid-"+t,e);const d=e=>{n.insertAdjacentHTML("afterend",e)};"string"==typeof t?d(t):t.then(({svg:e})=>d(e))})}},btf.addGlobalFn("themeChange",e,"mermaid"),window.loadMermaid?e():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(e))};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{const a=GLOBAL_CONFIG_SITE.isShuoshuo,s=null,n=t=>"dark"===t?"dark":"light";var t=(t=document,e)=>{e=a?{"data-mapping":"specific","data-term":e}:{"data-mapping":(s,"pathname")},e=(t=>{const a=document.createElement("script");return Object.entries(t).forEach(([t,e])=>{a.setAttribute(t,e)}),a})({src:"https://giscus.app/client.js","data-repo":"formeasy/blog","data-repo-id":"R_kgDOJ2sA5A","data-category-id":"DIC_kwDOJ2sA5M4CktKh","data-theme":n(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0,...s,...e});t.querySelector("#giscus-wrap").appendChild(e),a&&(window.shuoshuoComment.destroyGiscus=()=>{t.children.length&&(t.innerHTML="",t.classList.add("no-comment"))})};btf.addGlobalFn("themeChange",t=>{var e=document.querySelector("#giscus-wrap iframe");e&&(t={giscus:{setConfig:{theme:n(t)}}},e.contentWindow.postMessage(t,"https://giscus.app"))},"giscus"),a?window.shuoshuoComment={loadComment:t}:t()})()</script></div><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="请输入搜索关键字" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>