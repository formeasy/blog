<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>手把手教你玩转 kafka-python：从安装到消费者实战全攻略 | 易锦风的博客</title><meta name="author" content="formeasy"><meta name="copyright" content="formeasy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="手把手教你玩转 kafka-python：从安装到消费者实战全攻略"><meta property="og:type" content="article"><meta property="og:title" content="手把手教你玩转 kafka-python：从安装到消费者实战全攻略"><meta property="og:url" content="http://www.formeasy.cc/2025/07/29/kafka/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%8E%A9%E8%BD%AC%20kafka-python%EF%BC%9A%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E6%B6%88%E8%B4%B9%E8%80%85%E5%AE%9E%E6%88%98%E5%85%A8%E6%94%BB%E7%95%A5/index.html"><meta property="og:site_name" content="易锦风的博客"><meta property="og:description" content="手把手教你玩转 kafka-python：从安装到消费者实战全攻略"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.formeasy.cc/img/cover.png"><meta property="article:published_time" content="2025-07-29T02:33:59.000Z"><meta property="article:modified_time" content="2025-07-29T02:43:55.233Z"><meta property="article:author" content="formeasy"><meta property="article:tag" content="kafka"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://www.formeasy.cc/img/cover.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.formeasy.cc/2025/07/29/kafka/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%8E%A9%E8%BD%AC%20kafka-python%EF%BC%9A%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E6%B6%88%E8%B4%B9%E8%80%85%E5%AE%9E%E6%88%98%E5%85%A8%E6%94%BB%E7%95%A5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{var e={set:(e,t,a)=>{a&&(a=Date.now()+864e5*a,localStorage.setItem(e,JSON.stringify({value:t,expiry:a})))},get:e=>{var t=localStorage.getItem(e);if(t){var{value:t,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return t;localStorage.removeItem(e)}}},t=(window.btf={saveToLocal:e,getScript:(o,n={})=>new Promise((e,t)=>{const a=document.createElement("script");a.src=o,a.async=!0,Object.entries(n).forEach(([e,t])=>a.setAttribute(e,t)),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),getCSS:(o,n)=>new Promise((e,t)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onload=a.onreadystatechange=()=>{a.readyState&&!/loaded|complete/.test(a.readyState)||e()},a.onerror=t,document.head.appendChild(a)}),addGlobalFn:(e,t,a=!1,o=window)=>{var n;e.startsWith("pjax")||((n=o.globalFn||{})[e]=n[e]||{},n[e][a||Object.keys(n[e]).length]=t,o.globalFn=n)}},()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")}),a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")},o=(btf.activateDarkMode=t,btf.activateLightMode=a,e.get("theme")),t=("dark"===o?t():"light"===o&&a(),e.get("aside-status"));void 0!==t&&document.documentElement.classList.toggle("hide-aside","hide"===t);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"未找到符合您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1,highlightFullpage:!1,highlightMacStyle:!0},copy:{success:"复制成功",error:"复制失败",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"手把手教你玩转 kafka-python：从安装到消费者实战全攻略",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="易锦风的博客" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">223</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/img/cover.png)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon.png" alt="Logo"><span class="site-name">易锦风的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">手把手教你玩转 kafka-python：从安装到消费者实战全攻略</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我们</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">手把手教你玩转 kafka-python：从安装到消费者实战全攻略</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-29T02:33:59.000Z" title="发表于 2025-07-29 10:33:59">2025-07-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-29T02:43:55.233Z" title="更新于 2025-07-29 10:43:55">2025-07-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>8分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>在分布式系统开发中，我们经常会遇到消息队列的需求，而 Kafka 作为高性能的消息中间件，自然成为首选。但如何在 Python 中高效使用 Kafka 呢？今天我们就来深入探讨 kafka-python 的安装与消费者实战，带你从零开始掌握这个强大的工具。</p><h3 id="一-kafka-python-安装指南"><a class="markdownIt-Anchor" href="#一-kafka-python-安装指南"></a> 一、kafka-python 安装指南</h3><h4 id="1-最新稳定版安装"><a class="markdownIt-Anchor" href="#1-最新稳定版安装"></a> 1. 最新稳定版安装</h4><p>我们可以使用最常用的 Pip 包管理器来安装 kafka-python 的最新稳定版本，只需一行命令即可完成基础安装：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install kafka-python</span><br></pre></td></tr></table></figure><h4 id="2-开发版安装获取最新特性"><a class="markdownIt-Anchor" href="#2-开发版安装获取最新特性"></a> 2. 开发版安装（获取最新特性）</h4><p>如果我们想体验最新的功能特性，可以通过 Git 克隆仓库并手动安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/dpkp/kafka-python</span><br><span class="line"><span class="built_in">cd</span> kafka-python</span><br><span class="line">pip install .</span><br></pre></td></tr></table></figure><h4 id="3-性能优化相关的可选安装"><a class="markdownIt-Anchor" href="#3-性能优化相关的可选安装"></a> 3. 性能优化相关的可选安装</h4><h5 id="1crc32c-安装kafka-11-强烈推荐"><a class="markdownIt-Anchor" href="#1crc32c-安装kafka-11-强烈推荐"></a> （1）crc32c 安装（Kafka 11 + 强烈推荐）</h5><p>当我们使用 Kafka 11 + 版本的 broker 时，新的消息协议需要计算 crc32c，而默认的纯 Python 实现性能较差。安装 crc32c 包可以显著提升性能：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install <span class="string">&#x27;kafka-python[crc32c]&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="2zstd-压缩支持"><a class="markdownIt-Anchor" href="#2zstd-压缩支持"></a> （2）ZSTD 压缩支持</h5><p>如果我们需要使用 ZSTD 压缩格式，需要安装对应的依赖：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install <span class="string">&#x27;kafka-python[zstd]&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="3lz4-压缩支持"><a class="markdownIt-Anchor" href="#3lz4-压缩支持"></a> （3）LZ4 压缩支持</h5><p>同理，启用 LZ4 压缩功能需要安装：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install <span class="string">&#x27;kafka-python[lz4]&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="4snappy-压缩支持"><a class="markdownIt-Anchor" href="#4snappy-压缩支持"></a> （4）Snappy 压缩支持</h5><p>Snappy 的安装稍显复杂，需要先安装开发库：</p><ul><li><strong>Ubuntu 系统</strong>：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install libsnappy-dev</span><br></pre></td></tr></table></figure><ul><li><strong>OSX 系统</strong>：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install snappy</span><br></pre></td></tr></table></figure><ul><li><strong>从源代码安装</strong>：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/google/snappy/releases/download/1.1.3/snappy-1.1.3.tar.gz</span><br><span class="line">tar xzvf snappy-1.1.3.tar.gz</span><br><span class="line"><span class="built_in">cd</span> snappy-1.1.3</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><p>安装完开发库后，再安装 Python 模块：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install <span class="string">&#x27;kafka-python[snappy]&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="二-kafkaconsumer-核心功能解析"><a class="markdownIt-Anchor" href="#二-kafkaconsumer-核心功能解析"></a> 二、KafkaConsumer 核心功能解析</h3><h4 id="1-初始化-kafkaconsumer"><a class="markdownIt-Anchor" href="#1-初始化-kafkaconsumer"></a> 1. 初始化 KafkaConsumer</h4><p>KafkaConsumer 类是我们与 Kafka 集群交互的核心组件，它可以透明处理集群服务器故障，并适应主题分区的创建或迁移。下面是初始化 Consumer 的关键参数说明：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> kafka <span class="keyword">import</span> KafkaConsumer</span><br><span class="line"> </span><br><span class="line">consumer = KafkaConsumer(</span><br><span class="line">    <span class="comment"># 订阅的主题列表，可选，未设置时需调用subscribe或assign</span></span><br><span class="line">    *topics,</span><br><span class="line">    <span class="comment"># 引导服务器列表，至少一个可用broker</span></span><br><span class="line">    bootstrap_servers=<span class="string">&#x27;localhost:9092&#x27;</span>,</span><br><span class="line">    <span class="comment"># 客户端标识，用于服务器日志标识</span></span><br><span class="line">    client_id=<span class="string">&#x27;my-consumer&#x27;</span>,</span><br><span class="line">    <span class="comment"># 消费者组ID，None时禁用自动分区分配和偏移量提交</span></span><br><span class="line">    group_id=<span class="string">&#x27;my-group&#x27;</span>,</span><br><span class="line">    <span class="comment"># 键的反序列化函数</span></span><br><span class="line">    key_deserializer=<span class="keyword">lambda</span> m: m.decode(<span class="string">&#x27;utf-8&#x27;</span>),</span><br><span class="line">    <span class="comment"># 值的反序列化函数</span></span><br><span class="line">    value_deserializer=<span class="keyword">lambda</span> m: m.decode(<span class="string">&#x27;utf-8&#x27;</span>),</span><br><span class="line">    <span class="comment"># 启用增量fetch会话，提升性能</span></span><br><span class="line">    enable_incremental_fetch_sessions=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># 每次fetch最小数据量(字节)</span></span><br><span class="line">    fetch_min_bytes=<span class="number">1</span>,</span><br><span class="line">    <span class="comment"># fetch最大等待时间(毫秒)</span></span><br><span class="line">    fetch_max_wait_ms=<span class="number">500</span>,</span><br><span class="line">    <span class="comment"># 每次fetch最大数据量(字节)</span></span><br><span class="line">    fetch_max_bytes=<span class="number">52428800</span>,  <span class="comment"># 50MB</span></span><br><span class="line">    <span class="comment"># 每个分区最大fetch数据量(字节)</span></span><br><span class="line">    max_partition_fetch_bytes=<span class="number">1048576</span>,</span><br><span class="line">    <span class="comment"># 请求超时时间(毫秒)</span></span><br><span class="line">    request_timeout_ms=<span class="number">305000</span>,</span><br><span class="line">    <span class="comment"># 错误重试间隔(毫秒)</span></span><br><span class="line">    retry_backoff_ms=<span class="number">100</span>,</span><br><span class="line">    <span class="comment"># 重连间隔(毫秒)</span></span><br><span class="line">    reconnect_backoff_ms=<span class="number">50</span>,</span><br><span class="line">    <span class="comment"># 最大重连间隔(毫秒)，指数退避上限</span></span><br><span class="line">    reconnect_backoff_max_ms=<span class="number">30000</span>,</span><br><span class="line">    <span class="comment"># 每个连接最大未完成请求数</span></span><br><span class="line">    max_in_flight_requests_per_connection=<span class="number">5</span>,</span><br><span class="line">    <span class="comment"># 偏移量越界时的重置策略</span></span><br><span class="line">    auto_offset_reset=<span class="string">&#x27;latest&#x27;</span>,</span><br><span class="line">    <span class="comment"># 是否自动提交偏移量</span></span><br><span class="line">    enable_auto_commit=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># 自动提交间隔(毫秒)</span></span><br><span class="line">    auto_commit_interval_ms=<span class="number">5000</span>,</span><br><span class="line">    <span class="comment"># 偏移量提交回调函数</span></span><br><span class="line">    default_offset_commit_callback=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 是否自动检查CRC32</span></span><br><span class="line">    check_crcs=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># 隔离级别，处理事务性消息</span></span><br><span class="line">    isolation_level=<span class="string">&#x27;read_uncommitted&#x27;</span>,</span><br><span class="line">    <span class="comment"># 是否允许自动创建主题</span></span><br><span class="line">    allow_auto_create_topics=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># 元数据刷新间隔(毫秒)</span></span><br><span class="line">    metadata_max_age_ms=<span class="number">300000</span>,</span><br><span class="line">    <span class="comment"># 分区分配策略</span></span><br><span class="line">    partition_assignment_strategy=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 每次poll最大记录数</span></span><br><span class="line">    max_poll_records=<span class="number">500</span>,</span><br><span class="line">    <span class="comment"># 两次poll最大间隔(毫秒)，超时会触发重平衡</span></span><br><span class="line">    max_poll_interval_ms=<span class="number">300000</span>,</span><br><span class="line">    <span class="comment"># 会话超时时间(毫秒)，用于检测消费者故障</span></span><br><span class="line">    session_timeout_ms=<span class="number">10000</span>,</span><br><span class="line">    <span class="comment"># 心跳间隔(毫秒)，维持会话活性</span></span><br><span class="line">    heartbeat_interval_ms=<span class="number">3000</span>,</span><br><span class="line">    <span class="comment"># TCP接收缓冲区大小</span></span><br><span class="line">    receive_buffer_bytes=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># TCP发送缓冲区大小</span></span><br><span class="line">    send_buffer_bytes=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 套接字选项</span></span><br><span class="line">    socket_options=[(socket.IPPROTO_TCP, socket.TCP_NODELAY, <span class="number">1</span>)],</span><br><span class="line">    <span class="comment"># 消费者迭代超时时间(毫秒)</span></span><br><span class="line">    consumer_timeout_ms=<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>),</span><br><span class="line">    <span class="comment"># 安全协议</span></span><br><span class="line">    security_protocol=<span class="string">&#x27;PLAINTEXT&#x27;</span>,</span><br><span class="line">    <span class="comment"># SSL上下文</span></span><br><span class="line">    ssl_context=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 是否验证主机名</span></span><br><span class="line">    ssl_check_hostname=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># CA证书文件</span></span><br><span class="line">    ssl_cafile=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 客户端证书文件</span></span><br><span class="line">    ssl_certfile=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 客户端私钥文件</span></span><br><span class="line">    ssl_keyfile=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 证书密码</span></span><br><span class="line">    ssl_password=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># CRL文件</span></span><br><span class="line">    ssl_crlfile=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># SSL密码套件</span></span><br><span class="line">    ssl_ciphers=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 指定Kafka API版本</span></span><br><span class="line">    api_version=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># API版本自动检测超时时间(毫秒)</span></span><br><span class="line">    api_version_auto_timeout_ms=<span class="number">2000</span>,</span><br><span class="line">    <span class="comment"># 连接最大空闲时间(毫秒)</span></span><br><span class="line">    connections_max_idle_ms=<span class="number">540000</span>,</span><br><span class="line">    <span class="comment"># 指标报告器</span></span><br><span class="line">    metric_reporters=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 是否启用指标收集</span></span><br><span class="line">    metrics_enabled=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># 指标采样数</span></span><br><span class="line">    metrics_num_samples=<span class="number">2</span>,</span><br><span class="line">    <span class="comment"># 指标采样窗口(毫秒)</span></span><br><span class="line">    metrics_sample_window_ms=<span class="number">30000</span>,</span><br><span class="line">    <span class="comment"># I/O选择器</span></span><br><span class="line">    selector=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 是否排除内部主题</span></span><br><span class="line">    exclude_internal_topics=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># SASL认证机制</span></span><br><span class="line">    sasl_mechanism=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># SASL用户名</span></span><br><span class="line">    sasl_plain_username=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># SASL密码</span></span><br><span class="line">    sasl_plain_password=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># Kerberos名称</span></span><br><span class="line">    sasl_kerberos_name=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># Kerberos服务名称</span></span><br><span class="line">    sasl_kerberos_service_name=<span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">    <span class="comment"># Kerberos域名</span></span><br><span class="line">    sasl_kerberos_domain_name=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># OAuth令牌提供器</span></span><br><span class="line">    sasl_oauth_token_provider=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># Socks5代理</span></span><br><span class="line">    socks5_proxy=<span class="literal">None</span>,</span><br><span class="line">    <span class="comment"># 自定义KafkaClient创建函数</span></span><br><span class="line">    kafka_client=<span class="literal">None</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="2-核心方法详解"><a class="markdownIt-Anchor" href="#2-核心方法详解"></a> 2. 核心方法详解</h4><h5 id="1分区分配与订阅"><a class="markdownIt-Anchor" href="#1分区分配与订阅"></a> （1）分区分配与订阅</h5><ul><li><strong>手动分配分区（assign）</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> kafka <span class="keyword">import</span> TopicPartition</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 手动分配特定分区</span></span><br><span class="line">consumer.assign([TopicPartition(<span class="string">&#x27;my_topic&#x27;</span>, <span class="number">0</span>), TopicPartition(<span class="string">&#x27;my_topic&#x27;</span>, <span class="number">1</span>)])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取当前分配的分区</span></span><br><span class="line">assigned_partitions = consumer.assignment()</span><br></pre></td></tr></table></figure><ul><li><strong>自动订阅主题（subscribe）</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 订阅单个或多个主题</span></span><br><span class="line">consumer.subscribe([<span class="string">&#x27;topic1&#x27;</span>, <span class="string">&#x27;topic2&#x27;</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 通过正则表达式订阅匹配的主题</span></span><br><span class="line">consumer.subscribe(pattern=<span class="string">&#x27;^topic-&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取当前订阅的主题</span></span><br><span class="line">subscribed_topics = consumer.subscription()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 取消所有订阅</span></span><br><span class="line">consumer.unsubscribe()</span><br></pre></td></tr></table></figure><h5 id="2偏移量操作"><a class="markdownIt-Anchor" href="#2偏移量操作"></a> （2）偏移量操作</h5><ul><li><strong>提交偏移量</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同步提交偏移量</span></span><br><span class="line">consumer.commit()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 提交指定偏移量</span></span><br><span class="line">consumer.commit(&#123;</span><br><span class="line">    TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>): offset_and_metadata,</span><br><span class="line">    TopicPartition(<span class="string">&#x27;topic2&#x27;</span>, <span class="number">1</span>): offset_and_metadata</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 异步提交偏移量</span></span><br><span class="line">consumer.commit_async()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 异步提交带回调</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_commit</span>(<span class="params">errors, offsets</span>):</span><br><span class="line">    <span class="keyword">if</span> errors:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Commit failed: <span class="subst">&#123;errors&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Commit successful: <span class="subst">&#123;offsets&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line">consumer.commit_async(callback=on_commit)</span><br></pre></td></tr></table></figure><ul><li><strong>获取已提交偏移量</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取指定分区的已提交偏移量</span></span><br><span class="line">committed_offset = consumer.committed(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取多个分区的已提交偏移量</span></span><br><span class="line">partitions = [TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>), TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line">offsets = consumer.committed(partitions, metadata=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h5 id="3消息获取与定位"><a class="markdownIt-Anchor" href="#3消息获取与定位"></a> （3）消息获取与定位</h5><ul><li><strong>轮询获取消息</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 轮询获取消息，超时时间100毫秒</span></span><br><span class="line">messages = consumer.poll(timeout_ms=<span class="number">100</span>, max_records=<span class="number">100</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 处理获取的消息</span></span><br><span class="line"><span class="keyword">for</span> topic_partition, records <span class="keyword">in</span> messages.items():</span><br><span class="line">    <span class="keyword">for</span> record <span class="keyword">in</span> records:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Received message: <span class="subst">&#123;record.value&#125;</span> at offset <span class="subst">&#123;record.offset&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li><strong>手动定位偏移量</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定位到指定偏移量</span></span><br><span class="line">consumer.seek(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>), <span class="number">100</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 定位到分区起始位置</span></span><br><span class="line">consumer.seek_to_beginning(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 定位到分区末尾位置</span></span><br><span class="line">consumer.seek_to_end(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>))</span><br></pre></td></tr></table></figure><h5 id="4偏移量与元数据查询"><a class="markdownIt-Anchor" href="#4偏移量与元数据查询"></a> （4）偏移量与元数据查询</h5><ul><li><strong>查询分区偏移量范围</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取分区最早偏移量</span></span><br><span class="line">begin_offsets = consumer.beginning_offsets([TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>)])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取分区末尾偏移量（下一条消息的偏移量）</span></span><br><span class="line">end_offsets = consumer.end_offsets([TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>)])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 通过时间戳查询偏移量</span></span><br><span class="line">timestamps = &#123;TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>): <span class="number">1678901234000</span>&#125;</span><br><span class="line">offsets = consumer.offsets_for_times(timestamps)</span><br></pre></td></tr></table></figure><ul><li><strong>查询分区元数据</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取主题的所有分区</span></span><br><span class="line">partitions = consumer.partitions_for_topic(<span class="string">&#x27;my_topic&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取分区的高水位偏移量</span></span><br><span class="line">highwater = consumer.highwater(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>))</span><br></pre></td></tr></table></figure><h5 id="5分区控制"><a class="markdownIt-Anchor" href="#5分区控制"></a> （5）分区控制</h5><ul><li><strong>暂停与恢复分区</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 暂停分区 fetch</span></span><br><span class="line">consumer.pause(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获取暂停的分区</span></span><br><span class="line">paused_partitions = consumer.paused()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 恢复分区 fetch</span></span><br><span class="line">consumer.resume(TopicPartition(<span class="string">&#x27;topic1&#x27;</span>, <span class="number">0</span>))</span><br></pre></td></tr></table></figure><h3 id="三-实战案例构建一个可靠的-kafka-消费者"><a class="markdownIt-Anchor" href="#三-实战案例构建一个可靠的-kafka-消费者"></a> 三、实战案例：构建一个可靠的 Kafka 消费者</h3><p>下面我们通过一个完整的案例来展示如何使用 KafkaConsumer 构建一个可靠的消息消费者：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> kafka <span class="keyword">import</span> KafkaConsumer</span><br><span class="line"><span class="keyword">from</span> kafka.errors <span class="keyword">import</span> KafkaError</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 配置消费者</span></span><br><span class="line">consumer = KafkaConsumer(</span><br><span class="line">    <span class="string">&#x27;my-topic&#x27;</span>,</span><br><span class="line">    bootstrap_servers=[<span class="string">&#x27;localhost:9092&#x27;</span>],</span><br><span class="line">    group_id=<span class="string">&#x27;my-consumer-group&#x27;</span>,</span><br><span class="line">    auto_offset_reset=<span class="string">&#x27;latest&#x27;</span>,</span><br><span class="line">    enable_auto_commit=<span class="literal">False</span>,</span><br><span class="line">    key_deserializer=<span class="keyword">lambda</span> k: k.decode(<span class="string">&#x27;utf-8&#x27;</span>),</span><br><span class="line">    value_deserializer=<span class="keyword">lambda</span> v: json.loads(v.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Consumer started, waiting for messages...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 循环获取消息</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 轮询获取消息，超时时间100ms</span></span><br><span class="line">        messages = consumer.poll(timeout_ms=<span class="number">100</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> messages:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 处理消息</span></span><br><span class="line">        <span class="keyword">for</span> topic_partition, records <span class="keyword">in</span> messages.items():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Received <span class="subst">&#123;<span class="built_in">len</span>(records)&#125;</span> messages from <span class="subst">&#123;topic_partition&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 批量处理消息</span></span><br><span class="line">            <span class="keyword">for</span> record <span class="keyword">in</span> records:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># 处理消息内容</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Processing message: <span class="subst">&#123;record.value&#125;</span> at offset <span class="subst">&#123;record.offset&#125;</span>&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># 模拟业务处理</span></span><br><span class="line">                    time.sleep(<span class="number">0.1</span>)</span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Error processing message: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 手动提交偏移量</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                consumer.commit()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Offsets committed successfully for <span class="subst">&#123;topic_partition&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> KafkaError <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Offset commit failed: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Consumer stopped by user&quot;</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="comment"># 关闭消费者</span></span><br><span class="line">    consumer.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Consumer closed&quot;</span>)</span><br></pre></td></tr></table></figure><p>这个案例展示了一个基本的消费者流程，包括：</p><ol><li>配置消费者参数（手动提交偏移量、JSON 反序列化）</li><li>循环轮询获取消息</li><li>批量处理消息</li><li>手动提交偏移量确保消息不丢失</li><li>异常处理和资源清理</li></ol><h3><a class="markdownIt-Anchor" href="#"></a></h3><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3><p>通过本文，我们详细介绍了 kafka-python 的安装方法和 KafkaConsumer 的核心功能，从基础安装到高级特性，再到实战案例，希望能帮助你在项目中熟练运用 Kafka。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc">formeasy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://www.formeasy.cc/2025/07/29/kafka/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%8E%A9%E8%BD%AC%20kafka-python%EF%BC%9A%E4%BB%8E%E5%AE%89%E8%A3%85%E5%88%B0%E6%B6%88%E8%B4%B9%E8%80%85%E5%AE%9E%E6%88%98%E5%85%A8%E6%94%BB%E7%95%A5/">http://www.formeasy.cc/2025/07/29/kafka/手把手教你玩转 kafka-python：从安装到消费者实战全攻略/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://www.formeasy.cc" target="_blank">易锦风的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/kafka/">kafka</a></div><div class="post-share"><div class="social-share" data-image="/img/cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/29/kafka/kafka%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/" title="kafka单机和集群部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/kafka%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/bc0251f81f814d2fb6fb334411538d4f.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">kafka单机和集群部署</div></div><div class="info-2"><div class="info-item-1">一、kafka简介 1.1、概述 kafka 是由 linkedin 公司开发，是一个分布式、分区、多副本、多生产者、多消费者，基于 zookeeper 的分布式 日志系统（也可以作为MQ 系统），常见可以用于 web/nginx 日志、访问日志、消息服务等， Linkedin2010 年将项目贡献给了Apache 基金会并成为顶级开源项目。 主要应用场景是：日志收集系统和消息详细。 设计目标如下： 1. 一时间复杂度为 O(1) 的方式提供消息持久能力，即使对 TB 级以上的数据也能保证常数时间的访问性能。 2. 高吞吐率：即使在非常廉价的商用机器上也能做到单机支持每秒 100k 条消息的传输。 3. 支持 Kafka Server 间的消息分布，以及分布式消费，同时保证每个 partition 内的消息顺序传输。 4. 同时支持离线数据和实时数据处理。 5. Scale out ：支持在线水平扩展。 1.2、消息系统介绍 一个消息系统负责将数据从一个应用传递到另外一个应用，应用只需要关注数据，无需要关系数据再两个或者...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/" title="Kafka简介和Ubuntu20.04安装kafka"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/57bd315695d55136ee958cc6bd3a3ece.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Kafka简介和Ubuntu20.04安装kafka</div></div><div class="info-2"><div class="info-item-1">简介 Kafka是一个实时数据处理系统，可以横向扩展、高可靠，而且还变态快，已经被很多公司使用。 那么什么是实时数据处理系统呢？顾名思义，实时数据处理系统就是数据一旦产生，就要能快速进行处理的系统。 对于实时数据处理，我们最常见的，就是消息中间件了，也叫MQ（Message Queue，消息队列），也有叫Message Broker的。 为什么需要消息中间件 消息中间件的作用主要有两点： 1. 解耦消息的生产和消费。 2. 缓冲。 想象一个场景，你的一个创建订单的操作，在订单创建完成之后，需要触发一系列其他的操作，比如进行用户订单数据的统计、给用户发送短信、给用户发送邮件等等，就像这样： 123456createOrder(...)&#123; ... statOrderData(...); sendSMS();...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/" title="Kafka简介和Ubuntu20.04安装kafka"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/Kafka%E7%AE%80%E4%BB%8B%E5%92%8CUbuntu20.04%E5%AE%89%E8%A3%85kafka/57bd315695d55136ee958cc6bd3a3ece.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">Kafka简介和Ubuntu20.04安装kafka</div></div><div class="info-2"><div class="info-item-1">简介 Kafka是一个实时数据处理系统，可以横向扩展、高可靠，而且还变态快，已经被很多公司使用。 那么什么是实时数据处理系统呢？顾名思义，实时数据处理系统就是数据一旦产生，就要能快速进行处理的系统。 对于实时数据处理，我们最常见的，就是消息中间件了，也叫MQ（Message Queue，消息队列），也有叫Message Broker的。 为什么需要消息中间件 消息中间件的作用主要有两点： 1. 解耦消息的生产和消费。 2. 缓冲。 想象一个场景，你的一个创建订单的操作，在订单创建完成之后，需要触发一系列其他的操作，比如进行用户订单数据的统计、给用户发送短信、给用户发送邮件等等，就像这样： 123456createOrder(...)&#123; ... statOrderData(...); sendSMS();...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/Windows%E4%B8%8BKafka%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="Windows 下 Kafka 安装教程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/Windows%E4%B8%8BKafka%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/a4fc229519524deba1995b24f6c6eb53.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">Windows 下 Kafka 安装教程</div></div><div class="info-2"><div class="info-item-1">一、准备工作 ✅ 1. 安装 Java JDK（Kafka 依赖 Java 运行环境） Kafka 是基于 Java 的，必须先安装 JDK。一般学到kafka的同学肯定已经安装好了JDK了，这一步我就不写了，具体可以参考其他文章。 ⚠️ 注意：Kafka 3.9.0 要求本地必须安装 JDK 17 或以上版本。JDK 8 和 11 已不再被官方支持。 步骤： 访问官网下载 OpenJDK 或 Oracle JDK。 推荐版本：JDK 8 ~ JDK 17（Kafka 3.x 支持到 JDK 17） Kafka需要的JDK版本！ 安装完成后设置环境变量： JAVA_HOME：指向 JDK 安装目录，例如 C:\Program Files\Java\jdk-17.0.1 Path 中添加 %JAVA_HOME%\bin 验证是否安装成功： 12java -versionjavac -version 二、下载 Kafka 访问 Apache Kafka 官网下载页面： 🔗...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/kafka%E5%85%A5%E9%97%A8%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B_ubuntu%E5%AE%89%E8%A3%85kafka/" title="kafka入门安装教程_ubuntu安装kafka"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">kafka入门安装教程_ubuntu安装kafka</div></div><div class="info-2"><div class="info-item-1">一、安装前准备 安装Java环境 Kafka依赖Java运行，推荐安装OpenJDK 8或11： 12sudo apt updatesudo apt install openjdk-11-jdk # 或 openjdk-8-jdk 验证安装： 1java -version 配置环境变量（如未自动配置）： 12echo &#x27;export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64&#x27; &gt;&gt; ~/.bashrc # 根据实际路径调整source ~/.bashrc 创建专用用户（可选） 为安全起见，建议创建独立用户运行Kafka： 1234sudo useradd -m kafkasudo passwd kafkasudo adduser kafka sudosu - kafka # 切换到kafka用户 二、下载与安装Kafka 下载Kafka二进制包 访问Apache Kafka官网选择版本（推荐3.5.1或稳定版），下载并解压： 123wget...</div></div></div></a><a class="pagination-related" href="/2025/07/29/kafka/kafka%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/" title="kafka单机和集群部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/07/29/kafka/kafka%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/bc0251f81f814d2fb6fb334411538d4f.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">kafka单机和集群部署</div></div><div class="info-2"><div class="info-item-1">一、kafka简介 1.1、概述 kafka 是由 linkedin 公司开发，是一个分布式、分区、多副本、多生产者、多消费者，基于 zookeeper 的分布式 日志系统（也可以作为MQ 系统），常见可以用于 web/nginx 日志、访问日志、消息服务等， Linkedin2010 年将项目贡献给了Apache 基金会并成为顶级开源项目。 主要应用场景是：日志收集系统和消息详细。 设计目标如下： 1. 一时间复杂度为 O(1) 的方式提供消息持久能力，即使对 TB 级以上的数据也能保证常数时间的访问性能。 2. 高吞吐率：即使在非常廉价的商用机器上也能做到单机支持每秒 100k 条消息的传输。 3. 支持 Kafka Server 间的消息分布，以及分布式消费，同时保证每个 partition 内的消息顺序传输。 4. 同时支持离线数据和实时数据处理。 5. Scale out ：支持在线水平扩展。 1.2、消息系统介绍 一个消息系统负责将数据从一个应用传递到另外一个应用，应用只需要关注数据，无需要关系数据再两个或者...</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">formeasy</div><div class="author-info-description">专注互联网和软件技术</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">223</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/formeasy"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/formeasy" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:formeasy@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">用学习，面对遭遇的变化；用斗志，面对每天的挫折；用坚持，面对失去的动力!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80-kafka-python-%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">一、kafka-python 安装指南</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9C%80%E6%96%B0%E7%A8%B3%E5%AE%9A%E7%89%88%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.</span> <span class="toc-text">1. 最新稳定版安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E7%89%88%E5%AE%89%E8%A3%85%E8%8E%B7%E5%8F%96%E6%9C%80%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-number">1.2.</span> <span class="toc-text">2. 开发版安装（获取最新特性）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%9B%B8%E5%85%B3%E7%9A%84%E5%8F%AF%E9%80%89%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.</span> <span class="toc-text">3. 性能优化相关的可选安装</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1crc32c-%E5%AE%89%E8%A3%85kafka-11-%E5%BC%BA%E7%83%88%E6%8E%A8%E8%8D%90"><span class="toc-number">1.3.1.</span> <span class="toc-text">（1）crc32c 安装（Kafka 11 + 强烈推荐）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2zstd-%E5%8E%8B%E7%BC%A9%E6%94%AF%E6%8C%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">（2）ZSTD 压缩支持</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3lz4-%E5%8E%8B%E7%BC%A9%E6%94%AF%E6%8C%81"><span class="toc-number">1.3.3.</span> <span class="toc-text">（3）LZ4 压缩支持</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4snappy-%E5%8E%8B%E7%BC%A9%E6%94%AF%E6%8C%81"><span class="toc-number">1.3.4.</span> <span class="toc-text">（4）Snappy 压缩支持</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C-kafkaconsumer-%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E8%A7%A3%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">二、KafkaConsumer 核心功能解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96-kafkaconsumer"><span class="toc-number">2.1.</span> <span class="toc-text">1. 初始化 KafkaConsumer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="toc-number">2.2.</span> <span class="toc-text">2. 核心方法详解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E5%88%86%E5%8C%BA%E5%88%86%E9%85%8D%E4%B8%8E%E8%AE%A2%E9%98%85"><span class="toc-number">2.2.1.</span> <span class="toc-text">（1）分区分配与订阅</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E5%81%8F%E7%A7%BB%E9%87%8F%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.2.</span> <span class="toc-text">（2）偏移量操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E6%B6%88%E6%81%AF%E8%8E%B7%E5%8F%96%E4%B8%8E%E5%AE%9A%E4%BD%8D"><span class="toc-number">2.2.3.</span> <span class="toc-text">（3）消息获取与定位</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E5%81%8F%E7%A7%BB%E9%87%8F%E4%B8%8E%E5%85%83%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.4.</span> <span class="toc-text">（4）偏移量与元数据查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E5%88%86%E5%8C%BA%E6%8E%A7%E5%88%B6"><span class="toc-number">2.2.5.</span> <span class="toc-text">（5）分区控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%8F%AF%E9%9D%A0%E7%9A%84-kafka-%E6%B6%88%E8%B4%B9%E8%80%85"><span class="toc-number">3.</span> <span class="toc-text">三、实战案例：构建一个可靠的 Kafka 消费者</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/10/24/MySQL/MySQL5.6-5.7-8.0%E7%89%88%E6%9C%AC%E6%8E%88%E6%9D%83%E7%94%A8%E6%88%B7%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/" title="MySQL5.6-5.7-8.0版本授权用户远程连接"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="MySQL5.6-5.7-8.0版本授权用户远程连接"></a><div class="content"><a class="title" href="/2025/10/24/MySQL/MySQL5.6-5.7-8.0%E7%89%88%E6%9C%AC%E6%8E%88%E6%9D%83%E7%94%A8%E6%88%B7%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/" title="MySQL5.6-5.7-8.0版本授权用户远程连接">MySQL5.6-5.7-8.0版本授权用户远程连接</a><time datetime="2025-10-24T13:42:07.000Z" title="发表于 2025-10-24 21:42:07">2025-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/10/Redis/Window%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%AE%89%E8%A3%85Redis/" title="Window环境下安装Redis"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Window环境下安装Redis"></a><div class="content"><a class="title" href="/2025/10/10/Redis/Window%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%AE%89%E8%A3%85Redis/" title="Window环境下安装Redis">Window环境下安装Redis</a><time datetime="2025-10-10T06:27:15.000Z" title="发表于 2025-10-10 14:27:15">2025-10-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/07/Other/Java%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%A4%A7%E6%AF%94%E6%8B%BC%EF%BC%9AJeesite%20%E3%80%81jeecgBoot%E3%80%81smartAdmin%E3%80%81%E8%8B%A5%E4%BE%9D%E5%85%A8%E6%96%B9%E4%BD%8D%E8%A7%A3%E6%9E%90/" title="Java快速开发框架大比拼：Jeesite 、jeecgBoot、smartAdmin、若依全方位解析"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/10/07/Other/Java%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%A4%A7%E6%AF%94%E6%8B%BC%EF%BC%9AJeesite%20%E3%80%81jeecgBoot%E3%80%81smartAdmin%E3%80%81%E8%8B%A5%E4%BE%9D%E5%85%A8%E6%96%B9%E4%BD%8D%E8%A7%A3%E6%9E%90/911b7b057788d21493e66a10c6d05835.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Java快速开发框架大比拼：Jeesite 、jeecgBoot、smartAdmin、若依全方位解析"></a><div class="content"><a class="title" href="/2025/10/07/Other/Java%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%A4%A7%E6%AF%94%E6%8B%BC%EF%BC%9AJeesite%20%E3%80%81jeecgBoot%E3%80%81smartAdmin%E3%80%81%E8%8B%A5%E4%BE%9D%E5%85%A8%E6%96%B9%E4%BD%8D%E8%A7%A3%E6%9E%90/" title="Java快速开发框架大比拼：Jeesite 、jeecgBoot、smartAdmin、若依全方位解析">Java快速开发框架大比拼：Jeesite 、jeecgBoot、smartAdmin、若依全方位解析</a><time datetime="2025-10-07T14:16:42.000Z" title="发表于 2025-10-07 22:16:42">2025-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/05/Redis/Redis%20%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6%E8%A7%A3%E6%9E%90/" title="Redis 同步机制解析"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Redis 同步机制解析"></a><div class="content"><a class="title" href="/2025/10/05/Redis/Redis%20%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6%E8%A7%A3%E6%9E%90/" title="Redis 同步机制解析">Redis 同步机制解析</a><time datetime="2025-10-05T14:21:03.000Z" title="发表于 2025-10-05 22:21:03">2025-10-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/05/Redis/Redis%20%E8%A7%A3%E9%94%81%EF%BC%9AC++%20%E5%AE%9E%E6%88%98%E6%B7%B1%E5%BA%A6%E6%8E%A2%E7%B4%A2%20Set%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="Redis 解锁：C++ 实战深度探索 Set 数据类型"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/10/05/Redis/Redis%20%E8%A7%A3%E9%94%81%EF%BC%9AC++%20%E5%AE%9E%E6%88%98%E6%B7%B1%E5%BA%A6%E6%8E%A2%E7%B4%A2%20Set%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/ecfbf686c86c863f90654a62651e1aeb.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Redis 解锁：C++ 实战深度探索 Set 数据类型"></a><div class="content"><a class="title" href="/2025/10/05/Redis/Redis%20%E8%A7%A3%E9%94%81%EF%BC%9AC++%20%E5%AE%9E%E6%88%98%E6%B7%B1%E5%BA%A6%E6%8E%A2%E7%B4%A2%20Set%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="Redis 解锁：C++ 实战深度探索 Set 数据类型">Redis 解锁：C++ 实战深度探索 Set 数据类型</a><time datetime="2025-10-05T14:07:35.000Z" title="发表于 2025-10-05 22:07:35">2025-10-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By formeasy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(async()=>{window.katex_js_css||(window.katex_js_css=!0,await btf.getCSS("https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"),await btf.getScript("https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js")),document.querySelectorAll("#article-container .katex").forEach(t=>t.classList.add("katex-show"))})()</script><script>(()=>{var e=()=>{var e;0!==(e=document.querySelectorAll("pre > code.mermaid")).length&&e.forEach(e=>{var t=document.createElement("pre"),n=(t.className="mermaid-src",t.hidden=!0,t.textContent=e.textContent,document.createElement("div"));n.className="mermaid-wrap",n.appendChild(t),e.parentNode.replaceWith(n)});const t=document.querySelectorAll("#article-container .mermaid-wrap");0!==t.length&&(e=()=>{{var e=t;window.loadMermaid=!0;const a="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";e.forEach((e,t)=>{const n=e.firstElementChild;e=`%%{init:{ 'theme':'${a}'}}%%
`+n.textContent,t=mermaid.render("mermaid-"+t,e);const d=e=>{n.insertAdjacentHTML("afterend",e)};"string"==typeof t?d(t):t.then(({svg:e})=>d(e))})}},btf.addGlobalFn("themeChange",e,"mermaid"),window.loadMermaid?e():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(e))};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{const a=GLOBAL_CONFIG_SITE.isShuoshuo,s=null,n=t=>"dark"===t?"dark":"light";var t=(t=document,e)=>{e=a?{"data-mapping":"specific","data-term":e}:{"data-mapping":(s,"pathname")},e=(t=>{const a=document.createElement("script");return Object.entries(t).forEach(([t,e])=>{a.setAttribute(t,e)}),a})({src:"https://giscus.app/client.js","data-repo":"formeasy/blog","data-repo-id":"R_kgDOJ2sA5A","data-category-id":"DIC_kwDOJ2sA5M4CktKh","data-theme":n(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0,...s,...e});t.querySelector("#giscus-wrap").appendChild(e),a&&(window.shuoshuoComment.destroyGiscus=()=>{t.children.length&&(t.innerHTML="",t.classList.add("no-comment"))})};btf.addGlobalFn("themeChange",t=>{var e=document.querySelector("#giscus-wrap iframe");e&&(t={giscus:{setConfig:{theme:n(t)}}},e.contentWindow.postMessage(t,"https://giscus.app"))},"giscus"),a?window.shuoshuoComment={loadComment:t}:t()})()</script></div><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="请输入搜索关键字" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>